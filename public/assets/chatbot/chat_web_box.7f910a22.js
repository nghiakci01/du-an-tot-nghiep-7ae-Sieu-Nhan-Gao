var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,s,o)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,n=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&r(e,s,t[s]);if(o)for(var s of o(t))i.call(t,s)&&r(e,s,t[s]);return e},l=(e,o)=>t(e,s(o));"undefined"!=typeof require&&require;import{_ as c,f as h}from"./hmac-sha512.afd026d4.js";import{V as d,W as u,X as g,a0 as m,_ as p,$ as f,a5 as b,ab as C,a1 as v,a2 as y,a7 as x,F as _,a6 as k,a3 as B,f as w,a4 as M,ac as A,o as S,k as T,ag as R,x as F,E as I,v as D,ad as L,A as P,r as U,B as j,ae as E,h as q,Z as H,S as V,am as z,an as Q}from"./vendor_vue.37713104.js";import{M as N}from"./vendor_markdown.84127124.js";import{_ as $,l as Z}from"./carousel.34b143c0.js";import{C as G,S as O,P as Y,N as X}from"./vendor_vue_plugins.901dfd39.js";import{a as J}from"./vendor_http.27c72a61.js";import{G as W,I as K,J as ee}from"./vendor_ui_icons.8874a7df.js";import{F as te,f as se}from"./vendor_ui_core.d804937a.js";import"./vendor_utils.73405f6d.js";import{v as oe}from"./vendor_emoji.1a98d736.js";import"./vendor_charts.801e2ff3.js";var ae=c({components:{}},[["render",function(e,t,s,o,a,i){const r=d("router-view");return g(),u(r)}]]);const ie={name:"MessageText",components:{},props:{message:{type:Object},content:{type:String,default:"Hello from text form Client Hello from text form Client"}},data(){const e=new N({linkify:!0,html:!0,breaks:!0});return e.renderer.rules.link_open=function(e,t,s,o,a){const i=e[t];return i.attrPush(["target","_blank"]),i.attrPush(["rel","noopener noreferrer"]),a.renderToken(e,t,s)},e.use((e=>{const t=e.renderer.rules.text||function(e,t,s,o,a){return a.renderToken(e,t,s)};e.renderer.rules.text=function(e,s,o,a,i){const r=e[s].content,n=/\[\/\s*(.+?)\]/g;return n.test(r)?r.replace(n,((e,t)=>`<span class="suggestion-text" data-suggest-content="${t}">/​${t}</span>`)):t(e,s,o,a,i)}})),e.use((e=>{const t=e.renderer.rules.link_open||function(e,t,s,o,a){return a.renderToken(e,t,s)},s=new Set;e.renderer.rules.link_open=function(e,o,a,i,r){const n=e[o],l=n.attrIndex("href"),c=l>=0?n.attrs[l][1]:"",h=e[o-1];return h&&h.content&&(h.content.includes("Hình ảnh")||h.content.includes("hình ảnh"))?(s.add(o),`<img src="${c}" alt="Hình ảnh" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; display: block; margin: 8px 0;" />`):(n.attrPush(["target","_blank"]),n.attrPush(["rel","noopener noreferrer"]),t(e,o,a,i,r))},e.renderer.rules.link_close=function(e,t,o,a,i){return s.has(t)?(s.delete(t),""):i.renderToken(e,t,o)}})),{md:e,configCustom:{color_message_client:""},isMobile:!1,showImageModal:!1,selectedImageUrl:"",modalElement:null,scale:1,lastScale:1,minScale:1,maxScale:3,translateX:0,translateY:0,lastTranslateX:0,lastTranslateY:0,initialDistance:0,initialScale:1,isDragging:!1,lastTouchX:0,lastTouchY:0,lastTapTime:0,doubleTapDelay:300,baseImageWidth:0,baseImageHeight:0}},computed:l(n({},m("color",["listColorCustom"])),{renderedContent(){let e=this.md.render(this.message.content||"");return e=e.replace(/<a href="([^"]+)"[^>]*>Hình ảnh<\/a>/g,'<img src="$1" alt="Hình ảnh" class="clickable-image" data-image-url="$1" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; display: block; margin: 8px 0; cursor: pointer;" />'),e=e.replace(/<a href="([^"]+)"[^>]*>hình ảnh<\/a>/g,'<img src="$1" alt="Hình ảnh" class="clickable-image" data-image-url="$1" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; display: block; margin: 8px 0; cursor: pointer;" />'),e=e.replace(/<a href="([^"]+)"[^>]*>\s*Hình\s*ảnh\s*<\/a>/g,'<img src="$1" alt="Hình ảnh" class="clickable-image" data-image-url="$1" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; display: block; margin: 8px 0; cursor: pointer;" />'),e=e.replace(/<img([^>]*?)src="([^"]+)"([^>]*?)>/g,(e=>{if(e.includes("clickable-image"))return e;const t=e.match(/src="([^"]+)"/);if(!t)return e;const s=t[1],o=e.match(/class="([^"]*)"/);if(o){const t=o[1];return e.replace(/class="[^"]*"/,`class="${t} clickable-image" data-image-url="${s}"`)}return e.replace(/>$/,` class="clickable-image" data-image-url="${s}">`)})),e}}),methods:{setColorCustom(){let e=document.getElementsByClassName("custom-background-color1");if(e.length>0)for(var t=0;t<e.length;t++)e[t].style.background=this.listColorCustom.backgroundColor1;let s=document.getElementsByClassName("custom-text-color2");if(s.length>0)for(t=0;t<s.length;t++)s[t].style.color=this.listColorCustom.textColor2},checkIsFullSize(){return!!this.$route.query.full_size},checkPRSun(){return!(!["9ac8eb9d-67b4-4270-b0c2-98ad6ca2d897"].includes(this.$route.query.project)||71882!=this.$route.query.bot_id)},formatMessage(){let e=this.message.content.replace(/!\[Xem hình\]\((https?:\/\/[^\)]+)\)/g,'<a href="$1" target="_blank"><img src="$1" style="width:100%" ></a>');e=e.replace(/<|>/gi,(function(e){return"&#"+e.charCodeAt(0)+";"})),e=e.replace(/\[Hình ảnh\]\((https?:\/\/[^\)]+)\)/g,'<a href="$1" target="_blank"><img src="$1" style="width:100%" ></a>'),e=e.replace(/-\s?\[Xem chi tiết\]\((.*?)\)/g,((e,t)=>`<a href="${t}" target="_blank">Xem chi tiết</a>`)),e=e.replace(/\[Xem chi tiết\]\((.*?)\)/g,((e,t)=>`<a href="${t}" target="_blank">Xem chi tiết</a>`));e=e.replace(/(?<!<a href=")\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|](?![^<]*<\/a>)/gim,'<a href="$&" target="_blank">$&</a>');return e=e.replace(/(?<!<a href=")(^|[^\/])(www\.[\S]+(\b|$))(?![^<]*<\/a>)/gim,'$1<a href="http://$2" target="_blank">$2</a>'),e=e.replace(/- Hình ảnh: /g,""),e=e.replace(/- <a /g,"<a"),e},addSuggestionTextEventListeners(){document.querySelectorAll(".suggestion-text").forEach((e=>{e.getAttribute("data-event-added")||(e.addEventListener("click",this.handleSuggestionTextClick),e.setAttribute("data-event-added","true"))}))},handleSuggestionTextClick(e){const t=e.target.getAttribute("data-suggest-content");t&&this.$emit("suggestion-click",t)},isMobileDevice:()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,addImageEventListeners(){this.$el.querySelectorAll(".clickable-image").forEach((e=>{e.getAttribute("data-event-added")||(e.addEventListener("click",this.handleImageClick),e.setAttribute("data-event-added","true"))}))},handleImageClick(e){const t=e.target.getAttribute("data-image-url")||e.target.src;this.isMobile?(this.selectedImageUrl=t,this.showImageModal=!0):window.open(t,"_blank")},closeModal(){this.showImageModal=!1,this.selectedImageUrl="",this.resetZoom(),document.body.style.overflow=""},resetZoom(){this.scale=1,this.lastScale=1,this.translateX=0,this.translateY=0,this.lastTranslateX=0,this.lastTranslateY=0,this.initialDistance=0,this.initialScale=1,this.isDragging=!1,this.baseImageWidth=0,this.baseImageHeight=0,this.updateImageTransform()},updateImageTransform(){if(this.modalElement){const e=this.modalElement.querySelector(".image-modal-content img");e&&(e.style.transform=`translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`,e.style.transition=this.isDragging?"none":"transform 0.3s ease-out")}},getDistance(e,t){const s=t.clientX-e.clientX,o=t.clientY-e.clientY;return Math.sqrt(s*s+o*o)},handleTouchStart(e){if(!this.isMobile||!this.modalElement)return;const t=e.touches;if(1===t.length){this.isDragging=!0,this.lastTouchX=t[0].clientX,this.lastTouchY=t[0].clientY;const s=(new Date).getTime(),o=s-this.lastTapTime;if(o<this.doubleTapDelay&&o>0){if(e.preventDefault(),this.scale>1)this.resetZoom();else{const s=e.target.getBoundingClientRect(),o=t[0].clientX-s.left-s.width/2,a=t[0].clientY-s.top-s.height/2;this.scale=2,this.lastScale=2,this.translateX=-o*(this.scale-1),this.translateY=-a*(this.scale-1),this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY,this.updateImageTransform()}this.lastTapTime=0}else this.lastTapTime=s}else if(2===t.length){e.preventDefault(),this.isDragging=!1,this.initialDistance=this.getDistance(t[0],t[1]),this.initialScale=this.scale;const s=(t[0].clientX+t[1].clientX)/2,o=(t[0].clientY+t[1].clientY)/2,a=this.modalElement.querySelector(".image-modal-content img");if(a){const e=a.getBoundingClientRect(),t=e.left+e.width/2,i=e.top+e.height/2;this.pinchCenterX=s-t,this.pinchCenterY=o-i}}},handleTouchMove(e){if(!this.isMobile||!this.modalElement)return;const t=e.touches;if(1===t.length&&this.isDragging&&this.scale>1){e.preventDefault();const s=t[0].clientX-this.lastTouchX,o=t[0].clientY-this.lastTouchY;this.translateX=this.lastTranslateX+s,this.translateY=this.lastTranslateY+o,this.constrainTranslate(),this.updateImageTransform()}else if(2===t.length){e.preventDefault();const s=this.getDistance(t[0],t[1])/this.initialDistance;let o=this.initialScale*s;if(o=Math.max(this.minScale,Math.min(this.maxScale,o)),this.scale=o,void 0!==this.pinchCenterX&&void 0!==this.pinchCenterY){const e=o-this.initialScale;this.translateX=this.lastTranslateX-this.pinchCenterX*e/this.initialScale,this.translateY=this.lastTranslateY-this.pinchCenterY*e/this.initialScale}this.constrainTranslate(),this.updateImageTransform()}},handleTouchEnd(e){this.isMobile&&this.modalElement&&(this.isDragging=!1,this.constrainTranslate(),this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY,this.lastScale=this.scale,this.scale<1&&this.resetZoom(),this.pinchCenterX=void 0,this.pinchCenterY=void 0)},constrainTranslate(){var e;if(!this.baseImageWidth||!this.baseImageHeight){const t=null==(e=this.modalElement)?void 0:e.querySelector(".image-modal-content img");if(!t)return;{const e=t.getBoundingClientRect();this.baseImageWidth=e.width/(this.scale||1),this.baseImageHeight=e.height/(this.scale||1)}}const t=window.innerWidth,s=window.innerHeight,o=this.baseImageWidth*this.scale,a=this.baseImageHeight*this.scale;if(o<=t)this.translateX=0;else{const e=(o-t)/2;this.translateX=Math.max(-e,Math.min(e,this.translateX))}if(a<=s)this.translateY=0;else{const e=(a-s)/2;this.translateY=Math.max(-e,Math.min(e,this.translateY))}},createModal(){this.modalElement&&this.removeModal(),this.resetZoom();const e=document.createElement("div");e.className="image-modal",e.innerHTML=`\n                <div class="image-modal-content">\n                    <img src="${this.selectedImageUrl}" alt="Ảnh phóng to">\n                    <div class="image-modal-close">×</div>\n                </div>\n            `,e.addEventListener("click",(t=>{(t.target===e||t.target.classList.contains("image-modal-content"))&&this.closeModal()}));const t=e.querySelector(".image-modal-close");if(t&&t.addEventListener("click",(()=>{this.closeModal()})),this.isMobile){const t=e.querySelector(".image-modal-content img");if(t){const e=()=>{const e=t.getBoundingClientRect();this.baseImageWidth=e.width,this.baseImageHeight=e.height};t.complete?e():t.addEventListener("load",e,{once:!0}),t.addEventListener("touchstart",(e=>this.handleTouchStart(e)),{passive:!1}),t.addEventListener("touchmove",(e=>this.handleTouchMove(e)),{passive:!1}),t.addEventListener("touchend",(e=>this.handleTouchEnd(e)),{passive:!0}),t.addEventListener("touchcancel",(e=>this.handleTouchEnd(e)),{passive:!0})}}document.body.appendChild(e),this.modalElement=e,document.body.style.overflow="hidden"},removeModal(){this.modalElement&&this.modalElement.parentNode&&(this.modalElement.parentNode.removeChild(this.modalElement),this.modalElement=null)},checkProjectA80(){return"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&71823==this.$route.query.bot_id||"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==this.$route.query.project},checkProjectCustom(){return"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&72051==this.$route.query.bot_id&&(this.configCustom.color_message_client="#E0B100",!0)},checkIsFormPR(){return!!this.$route.query.is_formPR}},mounted(){this.isMobile=this.isMobileDevice(),this.$nextTick((()=>{this.addSuggestionTextEventListeners(),this.addImageEventListeners()}))},created(){this.$nextTick((()=>{this.setColorCustom(),this.formatMessage()}))},updated(){this.$nextTick((()=>{this.setColorCustom(),this.addSuggestionTextEventListeners(),this.addImageEventListeners()}))},watch:{showImageModal(e){e?this.createModal():this.removeModal()}},beforeDestroy(){this.removeModal(),document.body.style.overflow=""}},re={class:"text-box_area"},ne=["innerHTML"],le=["innerHTML"],ce=["innerHTML"];var he=c(ie,[["render",function(e,t,s,o,a,i){return g(),p("div",{class:"text-box",style:C(i.checkPRSun()?"max-width: 400px":i.checkProjectA80()?"max-width: 90%":i.checkIsFormPR()?"max-width: 80%":"")},[f("div",re,[i.checkIsFullSize()||i.checkProjectA80()||i.checkIsFormPR()?i.checkIsFormPR()?(g(),p("div",{key:1,class:b(["fade-in",s.message.fromUser?"custom-background-color1 custom-text-color2 support-pr-text-box__text":""])},[f("div",{class:"markdown-body",style:{background:"transparent !important",padding:"0 10px","font-size":"16px","line-height":"22px"},innerHTML:i.renderedContent},null,8,le)],2)):(g(),p("div",{key:2,class:b("fade-in "+(s.message.fromUser?i.checkProjectA80()?"message-full-size-client-a80":"message-full-size-client":"message-full-size-support"))},[f("div",{class:"markdown-body",innerHTML:i.renderedContent},null,8,ce)],2)):(g(),p("div",{key:0,class:b(["text-box__text text-box__text-form-text fade-in",s.message.fromUser?"custom-background-color1 custom-text-color2":""]),style:C(i.checkPRSun()?"border-radius: 16px; background-color: #F8F9FF !important;":"border-radius: 8px")},[f("div",{class:"markdown-body",style:C(i.checkPRSun()?s.message.fromUser?"color: #666666 !important;":"color: #333333 !important;":""),innerHTML:i.renderedContent},null,12,ne)],6))])],4)}]]);const de={name:"MessageQuickReplies",props:["message"],data:()=>({data:""}),computed:n({getButtons(){let e=[];return this.data.quick_replies.length>0&&(e=this.data.quick_replies,e=e.filter((e=>"text"==e.content_type||"quick_replies"==e.content_type))),e}},m("color",["listColorCustom"])),methods:{clickButtonQuickReply(e){this.$store.dispatch("message/clickSendPayload",e)},handleMouseover(e){e.target.style.background=this.listColorCustom.backgroundColor1,e.target.style.color="#fff"},handleMouseleave(e){e.target.style.background="#fff",e.target.style.color=this.listColorCustom.textColor3},setColorCustom(){let e=document.getElementsByClassName("custom-text-color3");if(e.length>0)for(var t=0;t<e.length;t++)e[t].style.color=this.listColorCustom.textColor3}},created(){try{this.message.content&&(this.data=JSON.parse(this.message.content))}catch(e){}this.$nextTick((()=>{this.setColorCustom()}))},updated(){this.$nextTick((()=>{this.setColorCustom()}))}};v("data-v-238899e4");const ue={class:"button-form"},ge={class:"button-form-text"},me={class:"button-form_box",id:"list-button-form-quick-replies"},pe=["onClick"];y();var fe=c(de,[["render",function(e,t,s,o,a,i){return g(),p("div",ue,[f("div",ge,x(a.data.content),1),f("div",me,[(g(!0),p(_,null,k(i.getButtons,((s,o)=>(g(),p("button",{onClick:e=>i.clickButtonQuickReply(s),onMouseover:t[0]||(t[0]=e=>i.handleMouseover(e)),onMouseleave:t[1]||(t[1]=e=>i.handleMouseleave(e)),key:o,type:"button",class:"button-form_box_text custom-text-color3",style:C("border: 1px solid"+e.listColorCustom.textColor3)},x(s.title),45,pe)))),128))])])}],["__scopeId","data-v-238899e4"]]);const be={components:{},props:{isShowAvatar:{type:Boolean}},data:()=>({avatarSupport:""}),computed:n({},m("chatBox",["dataChatManage"])),methods:{isMobile:()=>/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),checkIsFormPR(){return!!this.$route.query.is_formPR}},mounted(){},watch:{}};v("data-v-45bcc392");const Ce=["src"];y();var ve=c(be,[["render",function(e,t,s,o,a,i){return g(),p("div",{class:b(["avatar",{qr_code:e.$route.query.qr_code&&i.isMobile()}]),style:C(i.checkIsFormPR()?"width: 36px;height: 36px;":"")},[s.isShowAvatar?(g(),p("img",{key:0,class:"message_support-avatar",onerror:"this.onerror=null; this.src='/images/customer-avatar-default.jpg';",src:""!=e.dataChatManage.avatar&&null!=e.dataChatManage.avatar?e.dataChatManage.avatar:"https://chatbizfly.mediacdn.vn/2022/01/05/images/_iconspapirusteampapirusstatus32avatardefaulticonpng1641366791.png",alt:""},null,8,Ce)):B("",!0)],6)}],["__scopeId","data-v-45bcc392"]]);const ye={name:"MessageTemplate",components:{AvatarChat:ve},props:{message:{type:Object}},data:()=>({data:""}),computed:n(n(n({},m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject","isScrollBottom","listMenu"])),m("room",["dataRoom","roomTotalMessage","roomMessage"])),methods:{handleClickPayload(e){this.$store.dispatch("message/clickSendPayload",e)},setColorCustom(){let e=document.getElementsByClassName("custom-text-color3");if(e.length>0)for(var t=0;t<e.length;t++)this.$route.query.qr_code?(e[t].style.color="#000000",e[t].style["font-weight"]="500"):e[t].style.color="#000000"}},created(){try{this.message.content&&(this.data=JSON.parse(this.message.content))}catch(e){}this.$nextTick((()=>{this.setColorCustom()}))},updated(){this.$nextTick((()=>{this.setColorCustom()}))},mounted(){}};v("data-v-052ad6de");const xe={class:"menu-form"},_e={class:"menu-form_box"},ke=["innerHTML"],Be={key:0,class:"menu-form_item-text"},we=["href"],Me={key:1,class:"menu-form_item-text"},Ae=["href"],Se={key:2,class:"menu-form_item-text"},Te=["onClick"];y();var Re=c(ye,[["render",function(e,t,s,o,a,i){return g(),p("div",xe,[f("div",_e,[f("div",{class:"menu-form_title",innerHTML:e.$filters.formatTextUrl(a.data.text)},null,8,ke),(g(!0),p(_,null,k(a.data.attachments[0].payload.buttons,((e,t)=>(g(),p("div",{key:t,class:"menu-form_item"},["phone_number"==e.type?(g(),p("div",Be,[f("a",{class:"custom-text-color3",href:"tel:"+e.payload},x(e.title),9,we)])):"web_url"==e.type?(g(),p("div",Me,[f("a",{class:"custom-text-color3",href:e.url,target:"_blank"},x(e.title),9,Ae)])):(g(),p("div",Se,[f("a",{class:"custom-text-color3",href:"#",onClick:t=>i.handleClickPayload(e)},x(e.title),9,Te)]))])))),128))])])}],["__scopeId","data-v-052ad6de"]]);const Fe={name:"MessageImage",components:{},props:{},data:()=>({}),methods:{},mounted(){}};v("data-v-77a8ea31");const Ie={class:"image-form"},De=[f("img",{class:"image",src:"https://s.memehay.com/files/posts/20210515/toan-bo-loi-ran-day-cua-huan-hoa-hong-huan-rose.jpg",alt:""},null,-1)];y();var Le=c(Fe,[["render",function(e,t,s,o,a,i){return g(),p("div",Ie,De)}],["__scopeId","data-v-77a8ea31"]]);const Pe={name:"MessageGallery",components:{Carousel:G,Slide:O,Pagination:Y,Navigation:X,AvatarChat:ve},props:{message:{type:Object}},data:()=>({listImages:[{id:1,title:"Hello from bizfly 1",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://vietucbooking.vn/wp-content/uploads/2021/06/gioi-thieu-hang-hang-khong-viet-jet-air.jpg"},{id:2,title:"Hello from bizfly 2",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://www.airtickets.vn/wp-content/uploads/2020/11/Vietjet-cabin-crew.jpg"},{id:3,title:"Hello from bizfly 3",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://vietjet.net/includes/uploads/2021/03/Vietjet-Air.png"},{id:4,title:"Hello from bizfly 4",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:5,title:"Hello from bizfly 5",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:6,title:"Hello from bizfly 6",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:7,title:"Hello from bizfly 7",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:8,title:"Hello from bizfly 8",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:9,title:"Hello from bizfly 5",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:10,title:"Hello from bizfly 6",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:11,title:"Hello from bizfly 7",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"},{id:12,title:"Hello from bizfly 8",short_desc:"Nội dung mô tả của định dạng card với 2 dòng dài quá thì chấm chấm...",image:"https://file1.dangcongsan.vn/data/0/images/2020/04/28/thanhtoan/vietjet-3.jpg"}],data:""}),computed:n(n(n({getListGallery(){try{let e=[];return this.data.attachments.length>0&&(e=this.data.attachments[0].payload.elements),e}catch(e){console.log(e)}}},m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject","isScrollBottom","listMenu"])),m("room",["dataRoom","roomTotalMessage","roomMessage"])),methods:{handleClickPayload(e){this.$store.dispatch("message/clickSendPayload",e)},setColorCustom(){let e=document.getElementsByClassName("custom-text-color3");if(e.length>0)for(var t=0;t<e.length;t++)e[t].style.color=this.listColorCustom.textColor3}},mounted(){},created(){try{this.message.content&&(this.data=JSON.parse(this.message.content))}catch(e){}this.$nextTick((()=>{this.setColorCustom()}))},updated(){this.$nextTick((()=>{this.setColorCustom()}))}};v("data-v-48e13da2");const Ue={class:"gallery-form"},je={href:"#"},Ee=["src"],qe={class:"gallery-form_box-title"},He=["innerHTML"],Ve={key:0,class:"gallery-form_box_item-text"},ze=["href"],Qe={key:1,class:"gallery-form_box_item-text"},Ne=["href"],$e={key:2,class:"gallery-form_box_item-text"},Ze=["onClick"];y();var Ge=c(Pe,[["render",function(e,t,s,o,a,i){const r=d("slide"),n=d("navigation"),l=d("carousel");return g(),p("div",Ue,[w(l,{style:{},"items-to-show":1,itemsToScroll:1},{addons:M((({slidesCount:e,currentSlide:t})=>[e>1?(g(),u(n,{key:0,class:b({"is-first-slide":!t,"is-last-slide":t===e-1})},null,8,["class"])):B("",!0)])),default:M((()=>[(g(!0),p(_,null,k(i.getListGallery,((t,s)=>(g(),u(r,{key:t.image_url},{default:M((()=>[f("div",{class:b(["gallery-form_box",{"last-gallery":s>0}])},[f("a",je,[t.image_url?(g(),p("img",{key:0,class:"gallery-form_box-image",src:t.image_url,alt:""},null,8,Ee)):B("",!0)]),f("div",qe,x(t.title),1),f("div",{class:"gallery-form_box-description",innerHTML:e.$filters.formatTextUrl(t.subtitle)},null,8,He),(g(!0),p(_,null,k(t.buttons,((e,t)=>(g(),p("div",{class:"gallery-form_box_item",key:t},["phone_number"==e.type?(g(),p("div",Ve,[f("a",{href:"tel:"+e.payload},x(e.title),9,ze)])):"web_url"==e.type?(g(),p("div",Qe,[f("a",{href:e.url,target:"_blank"},x(e.title),9,Ne)])):(g(),p("div",$e,[f("a",{onClick:t=>i.handleClickPayload(e)},x(e.title),9,Ze)]))])))),128))],2)])),_:2},1024)))),128))])),_:1})])}],["__scopeId","data-v-48e13da2"]]);const Oe={name:"MessageFile",props:{message:{type:Object}},data:()=>({listFile:[]}),created(){try{if(this.message.content){let e=JSON.parse(this.message.content);this.listFile=e.attachments}}catch(e){}},watch:{"message.content":function(e){try{if(this.message.content){let e=JSON.parse(this.message.content);this.listFile=e.attachments}}catch(t){}}},methods:{getFileName:e=>e.split("/").pop().split("#")[0].split("?")[0],getFileExtension:e=>e.split(/[#?]/)[0].split(".").pop().trim()}};v("data-v-1cab6c6c");const Ye={class:"file"},Xe=["title"],Je=["href"],We={class:"file-name"},Ke=A('<div data-v-1cab6c6c><svg width="22" height="27" viewBox="0 0 22 27" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1cab6c6c><path d="M0.2 1.5C0.2 0.78203 0.78203 0.2 1.5 0.2H15.4798C15.824 0.2 16.1542 0.336514 16.3979 0.579603L21.4181 5.58717C21.6626 5.83106 21.8 6.16222 21.8 6.50757V25.5C21.8 26.218 21.218 26.8 20.5 26.8H1.5C0.78203 26.8 0.2 26.218 0.2 25.5V1.5Z" fill="white" stroke="#D1D1D6" stroke-width="0.4" data-v-1cab6c6c></path><mask id="path-2-inside-1" fill="white" data-v-1cab6c6c><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" data-v-1cab6c6c></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" fill="#EFEFEF" data-v-1cab6c6c></path><path d="M22 6.49986V6.89986H22.402L22.4 6.49785L22 6.49986ZM15.5 0L15.5054 -0.399964L15.1 -0.40542V0H15.5ZM16.5391 0.437867L16.2566 0.721066L16.5391 0.437867ZM21.5593 5.44544L21.2768 5.72864L21.5593 5.44544ZM22 6.09986H17V6.89986H22V6.09986ZM17 6.09986C16.3925 6.09986 15.9 5.60738 15.9 4.99986H15.1C15.1 6.0492 15.9507 6.89986 17 6.89986V6.09986ZM15.9 4.99986V0H15.1V4.99986H15.9ZM15.4946 0.399964C15.7805 0.403812 16.0539 0.518869 16.2566 0.721066L16.8216 0.154668C16.4715 -0.194585 15.9992 -0.393317 15.5054 -0.399964L15.4946 0.399964ZM16.2566 0.721066L21.2768 5.72864L21.8418 5.16224L16.8216 0.154668L16.2566 0.721066ZM21.2768 5.72864C21.4824 5.9337 21.5985 6.21167 21.6 6.50188L22.4 6.49785C22.3974 5.99657 22.1969 5.51644 21.8418 5.16224L21.2768 5.72864Z" fill="#D1D1D6" mask="url(#path-2-inside-1)" data-v-1cab6c6c></path><path d="M8.59961 9.1V9.9H15.8996V9.1H8.59961Z" fill="#007AFF" data-v-1cab6c6c></path><path d="M6.09961 18.1V18.9H13.3996V18.1H6.09961Z" fill="#007AFF" data-v-1cab6c6c></path><path d="M6.09961 12.1V12.9H15.8996V12.1H6.09961Z" fill="#007AFF" data-v-1cab6c6c></path><path d="M6.09961 15.1V15.9H15.8996V15.1H6.09961Z" fill="#007AFF" data-v-1cab6c6c></path></svg></div>',1),et={class:"name"},tt={class:"file-info"};y();var st=c(Oe,[["render",function(e,t,s,o,a,i){return g(),p("div",Ye,[(g(!0),p(_,null,k(a.listFile,(t=>(g(),p("span",{title:e.$filters.formatDateTime(s.message.created_at)},[f("a",{href:t.payload.url,target:"_blank"},[f("div",We,[Ke,f("div",et,x(i.getFileName(t.payload.url)),1)])],8,Je),f("div",tt,[f("div",null,x(i.getFileExtension(t.payload.url)),1)])],8,Xe)))),256))])}],["__scopeId","data-v-1cab6c6c"]]);const ot={name:"MessageMedia",props:["message"],data:()=>({listImage:[],error:!1,loading:!0,text:"",showModal:!1,modalImageUrl:"",modalElement:null}),computed:{isMobile:()=>/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},created(){try{if(this.message.content){let e=JSON.parse(this.message.content);e.caption&&(this.text=e.caption),this.listImage=e.attachments}}catch(e){}},watch:{"message.content":function(e){try{if(this.message.content){let e=JSON.parse(this.message.content);this.listImage=e.attachments}}catch(t){}},showModal(e){e?this.createModal():this.removeModal()}},methods:{handleImageClick(e){this.error||(this.isMobile?(this.modalImageUrl=e,this.showModal=!0):this.openImageNewTab(e))},showFullScreen(e){this.error||this.$emit("show-full-screen",e)},openImageNewTab(e){window.open(e)},handleImageLoad(){this.loading=!1},handleImageError(){this.error=!0},closeModal(){this.showModal=!1,this.modalImageUrl="",document.body.style.overflow=""},createModal(){this.modalElement&&this.removeModal();const e=document.createElement("div");e.className="image-modal",e.innerHTML=`\n                    <div class="image-modal-content">\n                        <img src="${this.modalImageUrl}" alt="Ảnh phóng to">\n                        <div class="image-modal-close">×</div>\n                    </div>\n                `,e.addEventListener("click",(t=>{t.target===e&&this.closeModal()}));const t=e.querySelector(".image-modal-close");t&&t.addEventListener("click",(()=>{this.closeModal()})),document.body.appendChild(e),this.modalElement=e,document.body.style.overflow="hidden"},removeModal(){this.modalElement&&this.modalElement.parentNode&&(this.modalElement.parentNode.removeChild(this.modalElement),this.modalElement=null)}},beforeDestroy(){this.removeModal(),document.body.style.overflow=""}};v("data-v-f5b53942");const at=["title"],it=["src","onClick"],rt={key:0,class:"caption"};y();var nt=c(ot,[["render",function(e,t,s,o,a,i){return g(),p("div",{class:b(["media",{error:a.error,loading:a.loading}])},[(g(!0),p(_,null,k(a.listImage,((o,r)=>(g(),p(_,{key:r},[f("span",{title:e.$filters.formatDateTime(s.message.created_at)},[f("img",{src:o.payload.url,onLoad:t[0]||(t[0]=(...e)=>i.handleImageLoad&&i.handleImageLoad(...e)),onClick:e=>i.handleImageClick(o.payload.url),onError:t[1]||(t[1]=(...e)=>i.handleImageError&&i.handleImageError(...e))},null,40,it)],8,at),a.text?(g(),p("div",rt,x(a.text),1)):B("",!0)],64)))),128))],2)}],["__scopeId","data-v-f5b53942"]]);const lt={name:"MessageOther",props:["message"],data:()=>({data:""}),created(){}};v("data-v-e05ad2f8");const ct=[f("p",{class:"message-other"},"Tin nhắn chưa có hiển thị",-1)];y();var ht=c(lt,[["render",function(e,t,s,o,a,i){return g(),p("div",null,ct)}],["__scopeId","data-v-e05ad2f8"]]);const dt={name:"MessageVideo",props:["message"],data:()=>({data:""}),created(){try{this.message.content&&(this.data=JSON.parse(this.message.content))}catch(e){}},watch:{"message.content":function(e){try{if(this.message.content){let e=JSON.parse(this.message.content);this.listImage=e.attachments}}catch(t){}}}};v("data-v-00cfea34");const ut={key:0,id:"video-test",class:"video"},gt=["title"],mt={controls:"controls",preload:"metadata"},pt=["src"];y();var ft=c(dt,[["render",function(e,t,s,o,a,i){return a.data?(g(),p("div",ut,[f("span",{title:e.$filters.formatDateTime(s.message.created_at)},[f("video",mt,[f("source",{src:a.data.attachments[0].payload.url},null,8,pt)])],8,gt)])):B("",!0)}],["__scopeId","data-v-00cfea34"]]);v("data-v-1414f186");const bt={class:"attachment"},Ct={key:0,style:{display:"flex","flex-direction":"row","align-items":"center",gap:"10px"}},vt=["onClick"],yt=[f("img",{src:"https://chatbizfly.mediacdn.vn/2022/01/05/nhahang/img/_icons8sharerounded30png1641379253.png",alt:""},null,-1)],xt=["title"],_t=["src","onClick"],kt={key:1,id:"video-test",class:"video"},Bt=["title"],wt={controls:"controls",preload:"metadata"},Mt=["src"],At={key:2},St=["title"],Tt=["href"],Rt={class:"file-name"},Ft=A('<svg width="22" height="27" viewBox="0 0 22 27" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1414f186><path d="M0.2 1.5C0.2 0.78203 0.78203 0.2 1.5 0.2H15.4798C15.824 0.2 16.1542 0.336514 16.3979 0.579603L21.4181 5.58717C21.6626 5.83106 21.8 6.16222 21.8 6.50757V25.5C21.8 26.218 21.218 26.8 20.5 26.8H1.5C0.78203 26.8 0.2 26.218 0.2 25.5V1.5Z" fill="white" stroke="#D1D1D6" stroke-width="0.4" data-v-1414f186></path><mask id="path-2-inside-1" fill="white" data-v-1414f186><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" data-v-1414f186></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" fill="#EFEFEF" data-v-1414f186></path><path d="M22 6.49986V6.89986H22.402L22.4 6.49785L22 6.49986ZM15.5 0L15.5054 -0.399964L15.1 -0.40542V0H15.5ZM16.5391 0.437867L16.2566 0.721066L16.5391 0.437867ZM21.5593 5.44544L21.2768 5.72864L21.5593 5.44544ZM22 6.09986H17V6.89986H22V6.09986ZM17 6.09986C16.3925 6.09986 15.9 5.60738 15.9 4.99986H15.1C15.1 6.0492 15.9507 6.89986 17 6.89986V6.09986ZM15.9 4.99986V0H15.1V4.99986H15.9ZM15.4946 0.399964C15.7805 0.403812 16.0539 0.518869 16.2566 0.721066L16.8216 0.154668C16.4715 -0.194585 15.9992 -0.393317 15.5054 -0.399964L15.4946 0.399964ZM16.2566 0.721066L21.2768 5.72864L21.8418 5.16224L16.8216 0.154668L16.2566 0.721066ZM21.2768 5.72864C21.4824 5.9337 21.5985 6.21167 21.6 6.50188L22.4 6.49785C22.3974 5.99657 22.1969 5.51644 21.8418 5.16224L21.2768 5.72864Z" fill="#D1D1D6" mask="url(#path-2-inside-1)" data-v-1414f186></path><path d="M8.59961 9.1V9.9H15.8996V9.1H8.59961Z" fill="#007AFF" data-v-1414f186></path><path d="M6.09961 18.1V18.9H13.3996V18.1H6.09961Z" fill="#007AFF" data-v-1414f186></path><path d="M6.09961 12.1V12.9H15.8996V12.1H6.09961Z" fill="#007AFF" data-v-1414f186></path><path d="M6.09961 15.1V15.9H15.8996V15.1H6.09961Z" fill="#007AFF" data-v-1414f186></path></svg>',1),It={class:"name"},Dt={key:0,class:"caption"};y();const Lt={name:"MessageAttachment"};const Pt={components:{MessageText:he,MessageQuickReplies:fe,MessageTemplate:Re,MessageImage:Le,MessageGallery:Ge,MessageFile:st,MessageMedia:nt,MessageOther:ht,MessageVideo:ft,AvatarChat:ve,MessageAttachment:c(Object.assign(Lt,{props:{message:{type:Object}},setup:function(e){const t=e;S((()=>{if(t.message.content){let e=JSON.parse(t.message.content);e.caption&&(o.value=e.caption),s.value=e.attachments,a.value=s.value[0].type}}));const s=T([]),o=T(""),a=T(null),i=T(!1),r=T(!0),n=()=>{r.value=!1},l=()=>{i.value=!0};return(t,c)=>(g(),p("div",bt,[f("div",{class:b(["media",{error:i.value,loading:r.value}]),style:C({maxWidth:"form_file"==a.value?"100%":"259px"})},[(g(!0),p(_,null,k(s.value,((s,o)=>{return g(),p(_,{key:o},["form_image"==a.value?(g(),p("div",Ct,[i.value||r.value?B("",!0):(g(),p("div",{key:0,class:b({"icon-open-tab-left":e.message.fromUser,"icon-open-tab-right":!e.message.fromUser}),onClick:e=>{return t=s.url,void window.open(t);var t}},yt,10,vt)),f("span",{title:t.$filters.formatDateTime(e.message.created_at)},[f("img",{src:s.url,onLoad:n,onClick:e=>{return t=s.url,void(i.value||emit("show-full-screen",t));var t},onError:l},null,40,_t)],8,xt)])):"form_video"==a.value?(g(),p("div",kt,[f("span",{title:t.$filters.formatDateTime(e.message.created_at)},[f("video",wt,[f("source",{src:s.url},null,8,Mt)])],8,Bt)])):"form_file"==a.value?(g(),p("div",At,[f("span",{title:t.$filters.formatDateTime(e.message.created_at)},[f("a",{href:s.url,target:"_blank"},[f("div",Rt,[Ft,f("div",It,x((c=s.url,c.split("/").pop().split("#")[0].split("?")[0])),1)])],8,Tt)],8,St)])):B("",!0)],64);var c})),128))],6),o.value?(g(),p("div",Dt,x(o.value),1)):B("",!0)]))}}),[["__scopeId","data-v-1414f186"]])},props:{message:{type:Object}},data:()=>({}),methods:{getMessageType(e){if(null!=e.extra_data&&"assign_support_for_room"==e.extra_data.type);else{if("text"===e.content_type)return"message-text";if("file"===e.content_type)return"message-file";if("image"===e.content_type)return"message-media";if("template"===e.content_type||"button"===e.content_type)return"message-template";if("quick_replies"===e.content_type)return"message-quick-replies";if("video"===e.content_type)return"message-video";if("generic"===e.content_type)return"message-gallery";if("attachments"===e.content_type)return"message-attachment"}},checkShowAvatar(){return!["9ac8eb9d-67b4-4270-b0c2-98ad6ca2d897","4a220697-e041-4c25-832e-fd3705003ac0"].includes(this.$route.query.project)},isMessageSupport:e=>!0,isMobile:()=>/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),checkIsFullSize(){return!!this.$route.query.full_size},checkPRSun(){return!(!["9ac8eb9d-67b4-4270-b0c2-98ad6ca2d897"].includes(this.$route.query.project)||71882!=this.$route.query.bot_id)},checkProjectA80(){return"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&71823==this.$route.query.bot_id||"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==this.$route.query.project},checkProjectCustom(){return"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&72051==this.$route.query.bot_id},checkIsFormPR(){return!!this.$route.query.is_formPR},handleSuggestionClick(e){this.$emit("suggestion-click",e)}},computed:l(n({},m("chatBox",["dataChatManage"])),{checkTimeDay(){return(new Date).toDateString()==new Date(this.message.created_at).toDateString()}}),mounted(){},watch:{}},Ut={key:1},jt=[f("div",{class:"message-error message-content__time"},[f("span",{style:{color:"red"}},"Đã lỗi xảy ra, vui lòng thử lại")],-1)],Et={key:1},qt={key:0,class:"message-info-full-size"},Ht={class:"message-info-full-size__name"},Vt={key:1,class:"message-content message_support-full-size"},zt={style:{width:"70%"}},Qt={key:2,class:"message-content message_client"},Nt={class:"message-content__detail"};const $t={components:{Message:c(Pt,[["render",function(e,t,s,o,a,i){const r=d("AvatarChat");return g(),p("div",null,[i.checkIsFullSize()?(g(),p("div",Et,[0==s.message.fromUser?(g(),p("div",qt,[0==s.message.fromUser&&i.checkShowAvatar()?(g(),u(r,{key:0,isShowAvatar:s.message.showAvatar},null,8,["isShowAvatar"])):B("",!0),f("span",Ht,x(e.dataChatManage.name),1)])):B("",!0),0==s.message.fromUser?(g(),p("div",Vt,[f("div",zt,[(g(),u(R(i.getMessageType(s.message)),{class:"message",message:s.message},null,8,["message"]))])])):(g(),p("div",Qt,[f("div",Nt,[(g(),u(R(i.getMessageType(s.message)),{class:"message",message:s.message,onSuggestionClick:i.handleSuggestionClick},null,8,["message","onSuggestionClick"]))])]))])):(g(),p("div",{key:0,class:b("message-content "+(0==s.message.fromUser?"message_support":"message_client")),style:C(i.checkProjectA80()?"padding: 0":i.checkProjectCustom()?"padding: 0 5px":i.checkIsFormPR()?"padding: 0; margin-right: 0px":"")},[f("div",{class:"message-content__detail",style:C(i.checkIsFormPR()?"align-items: flex-start;":"")},[0!=s.message.fromUser||!i.checkShowAvatar()||i.checkProjectA80()||i.checkProjectCustom()?B("",!0):(g(),u(r,{key:0,isShowAvatar:s.message.showAvatar},null,8,["isShowAvatar"])),(g(),u(R(i.getMessageType(s.message)),{class:"message",message:s.message,onSuggestionClick:i.handleSuggestionClick},null,8,["message","onSuggestionClick"]))],4),i.checkIsFormPR()?B("",!0):(g(),p("div",{key:0,class:b(["message-content__time",{qr_code:e.$route.query.qr_code&&i.isMobile(),"form-no-avatar":!i.checkShowAvatar()}]),style:C(i.checkPRSun()?"font-size: 10px;color: #888888; opacity: 0.5":i.checkProjectA80()||i.checkProjectCustom()?"margin-left: 10px;":"")},x(i.checkTimeDay?e.$filters.formatUnix(s.message.created_at,"HH:mm"):e.$filters.formatUnix(s.message.created_at,"DD/MM/YYYY HH:mm")),7)),s.message.error?(g(),p("div",Ut,jt)):B("",!0)],6))])}]])},props:{},data:()=>({loading:!0,textModal:{title:"",desc:"",btn1:"",btn2:"",btn3:"",btn4:""},listQuestion:["Bà Nà Hills có gì nổi bật khiến du khách nên ghé thăm?","Giá vé cáp treo Bà Nà Hills hiện tại là bao nhiêu?","Cửa hàng bánh Maison Kayser nằm ở khu vực nào?"],isMobile:!1}),computed:l(n(n(n({},m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject"])),m("room",["dataRoom","roomMessage","lastMessageId"])),{listMessage(){let e=[].concat(this.roomMessage);return e.forEach(((t,s)=>{t.from===this.dataRoom.room.open_for?e[s].fromUser=!0:(e[s].fromUser=!1,0===s?e[s].showAvatar=!0:e[s-1].from!==this.dataRoom.room.open_for&&e[s].from===e[s-1].from?e[s].showAvatar=!1:e[s].showAvatar=!0)})),e.reverse()}}),methods:{handleBookingClick(e){this.$emit("setInputText",e)},handleQuestionClick(e){this.$emit("setInputText",e)},handleSuggestionClick(e){this.$emit("suggestion-click",e)},checkIsFullSize(){return!!this.$route.query.full_size},checkQuestion(){return!this.$route.query.none_question},checkPRSun(){return!(!["9ac8eb9d-67b4-4270-b0c2-98ad6ca2d897"].includes(this.$route.query.project)||71882!=this.$route.query.bot_id)}},mounted(){"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&(71842==this.$route.query.bot_id?this.textModal={title:"Trợ lý ảo hỗ trợ tư vấn dịch vụ ngân hàng",desc:"Trợ lý ảo thông minh hỗ trợ khách hàng thực hiện giao dịch và đặt lịch hẹn tại các chi nhánh của ngân hàng thuộc tập đoàn tài chính hàng đầu Việt Nam.",btn1:"Tư vấn sản phẩm vay",btn2:"Tư vấn sản phẩm tiết kiệm",btn3:"Phí nộp rút tiền mặt",btn4:"Dịch vụ ủy nhiệm thu",first_mess:"Xin chào! Tôi là trợ lý ảo của ngân hàng, sẵn sàng hỗ trợ bạn trong các nhu cầu tài chính như mở tài khoản, tra cứu sản phẩm, hoặc tư vấn dịch vụ. Bạn chưa biết bắt đầu từ đâu?<br> Hãy bắt đầu với:"}:71818==this.$route.query.bot_id?this.textModal={title:"Trợ lý ảo hỗ trợ booking đặt bàn",desc:"Trợ lý ảo hỗ trợ booking đặt bàn cho chuỗi nhà hàng của tập đoàn ẩm thực hàng đầu Việt Nam",btn1:"Tôi muốn đặt bàn",btn2:"Địa chỉ nhà hàng",btn3:"Tôi muốn xem menu",btn4:"Chương trình khuyến mãi",first_mess:"Xin chào! Tôi là trợ lý ảo hỗ trợ booking đặt bàn cho chuỗi nhà hàng của tập đoàn ẩm thực hàng đầu Việt Nam. Bạn chưa biết bắt đầu từ đâu? \n Hãy bắt đầu với:"}:72025==this.$route.query.bot_id?this.textModal={title:"Trợ lý ảo hỗ trợ tư vấn tuyển sinh",desc:"Trợ lý ảo hỗ trợ tư vấn tuyển sinh cho trường đại học đa ngành hàng đầu Việt Nam",btn1:"Các phương thức xét tuyển",btn2:"Thời hạn xét tuyển",btn3:"Nộp hồ sơ online",btn4:"Điểm chuẩn ngành Marketing"}:72024==this.$route.query.bot_id?this.textModal={title:"Trợ lý ảo hỗ trợ tư vấn bán hàng",desc:"Trợ lý ảo hỗ trợ tư vấn bán hàng cho chuỗi cửa hàng thể thao hàng đầu Việt Nam",btn1:"Tôi muốn tìm giày chạy bộ",btn2:"Có ship tỉnh không",btn3:"Tôi muốn tìm áo hoodie",btn4:"Thời gian đổi trả trong bao lâu"}:72023==this.$route.query.bot_id&&(this.textModal={title:"Trợ lý ảo hỗ trợ tư vấn mở thẻ",desc:"Trợ lý ảo hỗ trợ tư vấn mở thẻ cho ngân hàng TMCP hàng đầu Việt Nam",btn1:"Tôi muốn mở thẻ tín dụng",btn2:"Tôi muốn mở thẻ ghi nợ",btn3:"Tôi muốn gửi tiết kiệm",btn4:"Ưu nhược điểm từng loại thẻ"})),"b2008f0d-b593-4c09-bbc6-9ade19c48da8"==this.$route.query.project&&72600==this.$route.query.bot_id&&(this.textModal={title:"Trợ lý ảo SHE",desc:"Trợ lý ảo hỗ trợ tư vấn du lịch hàng đầu Việt Nam",btn1:"Giá vé cáp treo khứ hồi",btn2:"Combo Cáp treo + Buffet Trưa",btn3:"Gợi ý các điểm đến thú vị",btn4:"Tôi bị mất đồ"}),window.innerWidth<768&&(this.isMobile=!0)},created(){setTimeout((()=>{this.loading=!1}),1e3)},watch:{dataRoom:function(){this.$store.dispatch("room/getMessageOfRoom")},lastMessageId:function(e){this.$refs[e]&&this.$refs[e].$el.scrollIntoView()}}};v("data-v-4ef0ca4d");const Zt={key:0,class:"history-chat"},Gt={key:0,class:"quick-question"},Ot=f("div",{class:"title"},"Hỏi nhanh",-1),Yt={class:"list-question"},Xt=["onClick"],Jt={key:1},Wt={key:0,class:"history-chat"},Kt={key:0,class:"empty-content-wrapper"},es={class:"empty-title"},ts={class:"empty-desc"},ss=f("div",{class:"empty-divider-row"},[f("div",{class:"empty-divider"}),f("div",{class:"empty-divider-label"},"Thử ngay"),f("div",{class:"empty-divider"})],-1),os={class:"empty-suggest-group"},as={class:"empty-suggest-group"},is={key:1,class:"empty-content-wrapper-mobile"},rs=f("div",{class:"empty-logo-mobile"},[f("img",{src:$,alt:""})],-1),ns=["innerHTML"],ls={class:"empty-suggest-group-mobile"};y();var cs=c($t,[["render",function(e,t,s,o,a,i){const r=d("Message");return g(),p("div",null,[i.checkIsFullSize()?(g(),p("div",Jt,[i.listMessage.length>0?(g(),p("div",Wt,[(g(!0),p(_,null,k(i.listMessage,((e,t)=>(g(),u(r,{ref:e.id?e.id:e._id,key:t,message:e,onSuggestionClick:i.handleSuggestionClick},null,8,["message","onSuggestionClick"])))),128))])):!a.loading&&i.checkQuestion()?(g(),p("div",{key:1,class:"history-chat-empty",style:C(a.isMobile?"background: #F7F7F7; height: calc(100vh - 80px); display: flex; flex-direction: column;":"")},[a.isMobile?(g(),p("div",is,[rs,f("div",{class:"empty-desc-mobile",innerHTML:a.textModal.first_mess},null,8,ns),f("div",ls,[f("div",{class:"empty-suggest-btn",onClick:t[4]||(t[4]=e=>i.handleBookingClick(a.textModal.btn1))},x(a.textModal.btn1),1),f("div",{class:"empty-suggest-btn",onClick:t[5]||(t[5]=e=>i.handleBookingClick(a.textModal.btn2))},x(a.textModal.btn2),1),f("div",{class:"empty-suggest-btn",onClick:t[6]||(t[6]=e=>i.handleBookingClick(a.textModal.btn3))},x(a.textModal.btn3),1),f("div",{class:"empty-suggest-btn",onClick:t[7]||(t[7]=e=>i.handleBookingClick(a.textModal.btn4))},x(a.textModal.btn4),1)])])):(g(),p("div",Kt,[f("div",es,x(a.textModal.title),1),f("div",ts,x(a.textModal.desc),1),ss,f("div",os,[f("div",{class:"empty-suggest-btn",onClick:t[0]||(t[0]=e=>i.handleBookingClick(a.textModal.btn1))},x(a.textModal.btn1),1),f("div",{class:"empty-suggest-btn",onClick:t[1]||(t[1]=e=>i.handleBookingClick(a.textModal.btn2))},x(a.textModal.btn2),1)]),f("div",as,[f("div",{class:"empty-suggest-btn",onClick:t[2]||(t[2]=e=>i.handleBookingClick(a.textModal.btn3))},x(a.textModal.btn3),1),f("div",{class:"empty-suggest-btn",onClick:t[3]||(t[3]=e=>i.handleBookingClick(a.textModal.btn4))},x(a.textModal.btn4),1)])]))],4)):B("",!0)])):(g(),p("div",Zt,[i.checkPRSun()?(g(),p("div",Gt,[Ot,f("div",Yt,[(g(!0),p(_,null,k(a.listQuestion,((e,t)=>(g(),p("div",{class:"question-item",key:t},[f("div",{class:"question-item-btn",onClick:t=>i.handleQuestionClick(e)},x(e),9,Xt)])))),128))])])):B("",!0),(g(!0),p(_,null,k(i.listMessage,((e,t)=>(g(),u(r,{ref:e.id?e.id:e._id,key:t,message:e,onSuggestionClick:i.handleSuggestionClick},null,8,["message","onSuggestionClick"])))),128))]))])}],["__scopeId","data-v-4ef0ca4d"]]);J.defaults.xsrfCookieName=null,J.defaults.xsrfHeaderName=null;var hs={headers:{"Content-Type":"application/json"}};setInterval((()=>{hs={headers:{"Content-Type":"application/json"}}}),1e3);var ds=e=>{let t="https://fiber.bizfly.vn/livechat_web/web_chat/get_config_chat_box";return"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/web_chat/get_config_chat_box"),new Promise(((s,o)=>{J.post(t,e,hs).then((e=>{e.status?s(e.data):o(e.data)})).catch((e=>{o(e)}))}))},us=e=>{let t="https://fiber.bizfly.vn/livechat_web/room/get_room_web_info";"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/room/get_room_web_info");let s=e.auth;return delete e.auth,new Promise(((o,a)=>{J.post(t,e,{headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"}}).then((e=>{e.status?o(e.data):a(e.data)})).catch((e=>{a(e)}))}))},gs=e=>new Promise(((t,s)=>{J.post("https://fiber.bizfly.vn/livechat_web/room/check_room_web_info",e,hs).then((e=>{e.status?t(e.data):s(e.data)})).catch((e=>{s(e)}))})),ms=e=>{let t="https://fiber.bizfly.vn/livechat_web/message/send_web_message";"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/message/send_web_message");let s=e.auth;return delete e.auth,new Promise(((o,a)=>{J.post(t,e,{headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"}}).then((e=>{e.status?o(e.data):a(e.data)})).catch((e=>{a(e)}))}))},ps=async(e,t)=>{let s="https://fiber.bizfly.vn/web_chat/v2.0/messages";"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"===e.project&&(s="https://a80-fiber.bizfly.vn/web_chat/v2.0/messages");let o,a=e.auth;delete e.auth;let i=!0;try{const l=new AbortController,c=l.signal,h=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a},body:JSON.stringify(e),credentials:"include",signal:c});if(!h.ok){let e=`Network error: ${h.status} ${h.statusText}`;try{if(502===h.status)return void t({event:"error",data:{error:"Server error - Bad Gateway",error_code:502}});const s=await h.text(),o=JSON.parse(s);if(e=o.error||e,10006===o.error_code)return void t({event:"error",data:{error:e,error_code:10006}})}catch(r){}return void t({event:"error",data:{error:e,error_code:h.status}})}if(!h.body)return void t({event:"error",data:{error:"No response body received",error_code:"NO_BODY"}});const d=h.body.getReader(),u=new TextDecoder("utf-8");let g="";const m=()=>{o&&clearTimeout(o),o=setTimeout((()=>{i&&(i=!1,l.abort(),t({event:"error",data:{error:"Stream timeout - no data received for 30 seconds"}}))}),3e4)};for(m();;){const{done:e,value:s}=await d.read();if(e){i=!1,t({event:"done"});break}m(),g+=u.decode(s,{stream:!0});const o=g.split("\n\n");g=o.pop()||"";let a=!1;for(const r of o){if(!r.trim())continue;const e=r.match(/^event: (.+)$/m),s=[...r.matchAll(/^data: (.+)$/gm)].map((e=>e[1])).join("\n");if(e&&s)try{const o=e[1],r=JSON.parse(s);if(r.error&&10006===r.error.error_code){i=!1,t({event:"error",data:{error:r.message||"Authentication failed",error_code:10006}}),a=!0;break}t({event:o,data:r})}catch(n){t({event:"error",data:{error:"Error parsing stream data: "+n.message}})}}if(a)break}}catch(l){i&&(i=!1,t({event:"error",data:{error:l.message||"Stream connection error"}}))}finally{o&&clearTimeout(o),i=!1}},fs=e=>new Promise(((t,s)=>{J.post("https://fiber.bizfly.vn/livechat_web/room/update_user_info_chat_web",e,hs).then((e=>{e.status?t(e.data):s(e.data)})).catch((e=>{s(e)}))})),bs=e=>{let t="https://fiber.bizfly.vn/livechat_web/room/get_online_supports_of_groups";return"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/room/get_online_supports_of_groups"),new Promise(((s,o)=>{J.post(t,e,hs).then((e=>{e.status?s(e.data):o(e.data)})).catch((e=>{o(e)}))}))},Cs=e=>{let t="https://fiber.bizfly.vn/livechat_web/message/get_web_message_of_room";return"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/message/get_web_message_of_room"),new Promise(((s,o)=>{J.post(t,e,{headers:{Authorization:"Bearer "+e.auth,"Content-Type":"application/json"}}).then((e=>{e.status?s(e.data):o(e.data)})).catch((e=>{o(e)}))}))},vs=e=>{let t="https://fiber.bizfly.vn/livechat_web/auth_v2";return"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber.bizfly.vn/livechat_web/auth"),new Promise(((s,o)=>{J.post(t,e,{headers:{"Content-Type":"application/json"},withCredentials:!0}).then((e=>{e.status?s(e.data):o(e.data)})).catch((e=>{o(e)}))}))},ys=e=>new Promise(((t,s)=>{J.post("https://fiber.bizfly.vn/v1.0/file/upload_web_chat",e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then((e=>{!0===e.data.status?t(e.data.data):s(e.data)})).catch((e=>{s(e)}))})),xs=e=>new Promise(((t,s)=>{J.post("https://bot-api.bizfly.vn/api/common/provinces",e).then((e=>{!0===e.data.status?t(e.data.data):s(e.data)})).catch((e=>{s(e)}))})),_s=e=>{let t="https://fiber-beta.bizfly.vn/livechat_web/message/get_faq";return"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==e.project&&(t="https://a80-fiber-beta.bizfly.vn/livechat_web/message/get_faq"),new Promise(((s,o)=>{J.post(t,e).then((e=>{!0===e.data.status?s(e.data.data):o(e.data)})).catch((e=>{o(e)}))}))};const ks={components:{},props:["configBoxRegisterText"],data:()=>({nameCompany:"",nameUser:"",emailUser:"",phoneUser:"",address:"",province:"",isShowError:!1,isShowErrorResponse:!1,isShowSuccess:!1,visibleSettingInformation:!1,firstMessage:"",isSubmit:!1,firstActionRoom:!1,checkIdentity:!1,messageError:"",checkValidate:!0,notesUser:"",listProvince:[],displayPopup:!1,textSearchProvince:"",title:""}),computed:l(n(n(n({},m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject","dataRoom","isShowFormRegister"])),m("room",["dataRoom"])),{isShowCloseBox(){return 1===this.dataChatBox.is_require_identification&&this.nameUser||0===this.dataChatBox.is_require_identification},checkFirstInRoom(){return 1!=this.dataChatBox.is_require_identification||this.checkIdentity?1===this.dataChatBox.is_require_identification&&this.dataRoom.user&&!this.dataRoom.user.hasOwnProperty("updated_from_boxchat_client"):(this.getListProvince(),!0)},checkCustom1(){return"b2d040fb-5c29-481f-8e79-b6cbf31cb72a"==this.dataBuildBox.project||"7137837f-4ba5-4adb-bff1-62d4d4fce213"==this.$route.query.project&&"18677"===this.$route.query.bot_id},checkCustom2(){return"10be3ff1-07a4-455d-bb43-add62fb26191"==this.dataBuildBox.project},checkCustom3(){return"992d754e-2098-4a88-b9c0-9590dc8821d5"==this.dataBuildBox.project&&(this.title="Vui lòng liên hệ hotline 1900 571 599 hoặc 0909 768 499 trong trường hợp quý khách cần hỗ trợ gấp",!0)},checkCustom4(){return"b470d04e-5f06-4a68-93fc-b252c28d3098"==this.dataBuildBox.project},checkCustom5(){return"7137837f-4ba5-4adb-bff1-62d4d4fce213"==this.$route.query.project&&"18677"===this.$route.query.bot_id},checkCustom6(){return!!("1c4e4ccd-753f-4ed6-94ba-220b5ce9e7ce"==this.$route.query.project&&"72611"===this.$route.query.bot_id||["6d41f88f-7fff-4cef-a3f1-b06e980fdd18"].includes(this.$route.query.project))},checkCustom7(){return!!("1c4e4ccd-753f-4ed6-94ba-220b5ce9e7ce"==this.$route.query.project&&"72720"===this.$route.query.bot_id||["1c4e4ccd-753f-4ed6-94ba-220b5ce9e7ce"].includes(this.$route.query.project))},checkCustom8(){return"7e9ef4d2-35c1-4d4f-b248-87c50893bccb"==this.dataBuildBox.project},checkCustom9(){return!!["7e9ef4d2-35c1-4d4f-b248-87c50893bccb"].includes(this.$route.query.project)},listProvinceSearch(){let e=[].concat(this.listProvince),t=this.textSearchProvince.toLowerCase().split(" ");return e=e.filter((e=>t.every((t=>this.vnToStr(e.name).toLowerCase().indexOf(this.vnToStr(t))>-1)))),e}}),methods:{handleCloseBoxRegister(){this.$store.commit("chatBox/updateIsShowFormRegister",!1)},checkLanguage(){return"en"===this.dataChatManage.locale},validateEmail:e=>/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(e),validate(e,t="phone"){if(!e)return!1;if("phone"==t){let t=/(84|0[3|5|7|8|9])+([0-9]{8})\b/g;return(e=e.trim().replace(/\W+/g,"")).match(t)}{let t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return String(e).toLowerCase().match(t)}},async handleOkRegister(){if("1f56cf79-35aa-4ca6-95f2-9fc83b72de86"==this.dataBuildBox.project||"da5461de-fe36-4cf8-8290-e5345b9081c5"==this.dataBuildBox.project||"b5f8c1e1-78da-49e5-9c2d-b8be195ad3e8"==this.dataBuildBox.project||"b3b54a5d-1dc1-4ee2-b3e4-9ed83f4e9557"==this.dataBuildBox.project||"1af21332-f608-452d-8800-117fa7d4856b"==this.dataBuildBox.project||"c057ddbb-abc6-429a-b050-adcf976fe7c8"==this.dataBuildBox.project?this.nameUser?this.phoneUser?this.validate(this.phoneUser,"phone")?this.emailUser?this.validateEmail(this.emailUser)?this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.email):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.email):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name):this.checkCustom1||this.checkCustom2?this.nameUser?this.phoneUser?this.validate(this.phoneUser,"phone")?this.checkCustom2&&!this.province?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.province):this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name):this.checkCustom3?this.nameUser?this.phoneUser?this.validate(this.phoneUser,"phone")?this.emailUser?this.emailUser&&!this.validateEmail(this.emailUser)?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.email):this.province?this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.province):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.email):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name):this.checkCustom6||this.checkCustom7?this.nameUser?this.phoneUser?this.validate(this.phoneUser,"phone")?this.checkCustom7&&!this.emailUser?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.email):this.emailUser&&!this.validateEmail(this.emailUser)?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.email):this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name):this.checkCustom9?this.nameUser?this.emailUser?this.validateEmail(this.emailUser)?this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.email):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.email):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name):this.nameUser?this.checkCustom4||!this.phoneUser||this.validate(this.phoneUser,"phone")?this.emailUser&&!this.validateEmail(this.emailUser)?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.email):this.checkFirstInRoom&&!this.firstMessage?(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.message):this.checkValidate=!0:(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.invalid.phone):(this.checkValidate=!1,this.messageError=this.configBoxRegisterText.message_error.empty.name),!this.checkValidate)return this.isShowError=!0,setTimeout((()=>{this.isShowError=!1}),2e3),!1;{if(this.checkFirstInRoom&&!this.firstMessage)return this.isShowError=!0,setTimeout((()=>{this.isShowError=!1}),2e3),!1;this.isSubmit=!0;let e={username:this.dataBuildBox.username,bot_id:this.dataBuildBox.bot_id,type:"web_message",name:this.nameUser,email:this.emailUser,phone:this.phoneUser,project:this.dataBuildBox.project,cookies:"",notes:this.notesUser};if((this.checkCustom3||this.checkCustom2)&&(e.attribute={locations:{value:{province:{value:this.province.name,viettel_post_id:this.province.p_viettel_id}},origin_message:this.address},nameCompany:{value:this.nameCompany}}),this.checkCustom8&&this.codeBooking&&this.codeBooking.trim()&&(e.attribute={PNR:{value:this.codeBooking}}),(await fs(e)).status){if(this.checkFirstInRoom){let t="storage_user_chat_identity_"+this.dataChatBox.unique_id+"_"+this.dataBuildBox.username;localStorage.setItem(t,1),this.checkIdentity=1,this.firstActionRoom=!0,await this.$store.dispatch("room/getRoomInfo",{name:this.nameUser}),await fs(e),parent.postMessage({type:"event_tracking_identification_user",data:{}},"*")}this.isShowSuccess=!0,this.visibleSettingInformation=!1,setTimeout((()=>{this.isShowSuccess=!1}),1e3),this.handleCloseBoxRegister()}else this.isShowErrorResponse=!0,setTimeout((()=>{this.isShowErrorResponse=!1}),1e3);this.isSubmit=!1}},getListProvince(){xs({project_token:this.dataBuildBox.project}).then((e=>{this.listProvince=e})).catch((e=>{console.log(e)}))},showPopupProvince(){this.displayPopup=!0,setTimeout((()=>{document.getElementById("inputProvince").focus()}),100)},closePopupProvince(){this.displayPopup=!1},chooseProvince(e){this.province=e,this.closePopupProvince(),this.textSearchProvince=""},vnToStr(e){if("string"==typeof e)return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\/g," ")).replace(/\s+/g," ")).trim()}},mounted(){},created(){},watch:{dataRoom:function(){try{null!=this.dataRoom.user.updated_from_boxchat_client&&1==this.dataRoom.user.updated_from_boxchat_client&&(this.nameUser=this.dataRoom.user.name,this.emailUser=this.dataRoom.user.email,this.phoneUser=this.dataRoom.user.phone,this.notesUser=this.dataRoom.user.notes),this.nameUser||1!==this.dataChatBox.is_require_identification||this.dataBuildBox.email||(this.visibleSettingInformation=!0),this.firstActionRoom&&(this.firstActionRoom=!1,setTimeout((()=>{if(this.$emit("sendMessage",{message:this.firstMessage,isFirstMessage:!0}),"52461be5-a8f5-4195-adc0-34c076cf2f76".includes(this.dataBuildBox.project)){let e="storage_first_chat_"+this.dataChatBox.unique_id+"_"+this.dataBuildBox.username;localStorage.setItem(e,"true")}}),600),this.$store.commit("room/updateUserInfo",!0))}catch(e){}},dataChatBox:function(){let e="storage_user_chat_identity_"+this.dataChatBox.unique_id+"_"+this.dataBuildBox.username;this.checkIdentity=localStorage.getItem(e),1!=this.dataChatBox.is_require_identification||this.checkIdentity||this.dataBuildBox.email||(this.visibleSettingInformation=!0)}}};v("data-v-7008008f");const Bs={class:""},ws={class:"cwbb__box-noti"},Ms={key:0,class:"cwbb__box-noti-success"},As=f("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[f("path",{d:"M8 0C3.58214 0 0 3.58214 0 8C0 12.4179 3.58214 16 8 16C12.4179 16 16 12.4179 16 8C16 3.58214 12.4179 0 8 0ZM11.4554 5.3875L7.69464 10.6018C7.64208 10.6751 7.57279 10.7349 7.49251 10.7762C7.41224 10.8174 7.32329 10.8389 7.23304 10.8389C7.14279 10.8389 7.05384 10.8174 6.97356 10.7762C6.89328 10.7349 6.82399 10.6751 6.77143 10.6018L4.54464 7.51607C4.47679 7.42143 4.54464 7.28929 4.66071 7.28929H5.49821C5.68036 7.28929 5.85357 7.37679 5.96071 7.52679L7.23214 9.29107L10.0393 5.39821C10.1464 5.25 10.3179 5.16071 10.5018 5.16071H11.3393C11.4554 5.16071 11.5232 5.29286 11.4554 5.3875Z",fill:"#52C41A"})],-1),Ss={key:1,class:"cwbb__box-noti-warring"},Ts=f("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[f("path",{d:"M8 0C3.58214 0 0 3.58214 0 8C0 12.4179 3.58214 16 8 16C12.4179 16 16 12.4179 16 8C16 3.58214 12.4179 0 8 0ZM7.42857 4.14286C7.42857 4.06429 7.49286 4 7.57143 4H8.42857C8.50714 4 8.57143 4.06429 8.57143 4.14286V9C8.57143 9.07857 8.50714 9.14286 8.42857 9.14286H7.57143C7.49286 9.14286 7.42857 9.07857 7.42857 9V4.14286ZM8 12C7.7757 11.9954 7.56213 11.9031 7.40513 11.7429C7.24812 11.5826 7.16018 11.3672 7.16018 11.1429C7.16018 10.9185 7.24812 10.7031 7.40513 10.5429C7.56213 10.3826 7.7757 10.2903 8 10.2857C8.2243 10.2903 8.43787 10.3826 8.59488 10.5429C8.75189 10.7031 8.83982 10.9185 8.83982 11.1429C8.83982 11.3672 8.75189 11.5826 8.59488 11.7429C8.43787 11.9031 8.2243 11.9954 8 12Z",fill:"#FAAD14"})],-1),Rs={key:2,class:"cwbb__box-noti-danger"},Fs={class:"cwbb__box-register-info-customer"},Is={class:"cwbb__box-register-form"},Ds=["placeholder"],Ls=f("div",{class:"cwbb__box-register-form-line"},null,-1),Ps=["placeholder"],Us=f("div",{class:"cwbb__box-register-form-line"},null,-1),js={key:0,class:"star-require-phone"},Es={key:1,class:"star-require-phone-daehan"},qs=["placeholder"],Hs=f("div",{class:"cwbb__box-register-form-line"},null,-1),Vs={key:3,class:"star-require-email"},zs={key:4,class:"star-require-email-default"},Qs=["placeholder"],Ns=["placeholder"],$s=f("div",{class:"cwbb__box-register-form-line"},null,-1),Zs=["placeholder"],Gs={key:0,class:"star-require-province",style:{opacity:"0.4"}},Os={key:1,class:"star-require-province-daehan",style:{opacity:"0.4"}},Ys={key:0,class:"cwbb__box-register-form-line"},Xs=["placeholder"],Js={key:3,class:"cwbb__box-register-form-line"},Ws={class:"choose-province"},Ks={key:0},eo=["onClick"],to={key:9,class:"cwbb__box-register-form-line"},so=["placeholder"],oo={key:11,class:"cwbb__box-register-form-line"},ao={class:"cwbb__box-register-form-submit-v2",style:{}},io={key:1,class:"container"},ro=[f("div",{class:"dots"},[f("div",{class:"dot dot-1"}),f("div",{class:"dot dot-2"}),f("div",{class:"dot dot-3"})],-1)],no=[f("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[f("g",{opacity:"0.45"},[f("path",{d:"M8.87024 7.99961L12.8515 4.02148C13.0921 3.78086 13.0921 3.3918 12.8515 3.15273C12.6109 2.91211 12.2218 2.91211 11.9827 3.15273L7.99993 7.1293L4.01711 3.15117C3.77649 2.91055 3.38743 2.91055 3.14836 3.15117C2.90774 3.3918 2.90774 3.78086 3.14836 4.01992L7.12961 7.99805L3.14836 11.9777C2.90774 12.2184 2.90774 12.6074 3.14836 12.8465C3.26868 12.9668 3.42649 13.0262 3.58274 13.0262C3.74055 13.0262 3.8968 12.9668 4.01711 12.8465L7.99993 8.86836L11.9827 12.848C12.1031 12.9684 12.2593 13.0277 12.4171 13.0277C12.5749 13.0277 12.7312 12.9684 12.8515 12.848C13.0921 12.6074 13.0921 12.2184 12.8515 11.9793L8.87024 7.99961Z",fill:"black"})])],-1)];y();var lo=c(ks,[["render",function(e,t,s,o,a,i){const r=F("click-outside");return g(),p("div",Bs,[f("div",ws,[a.isShowSuccess?(g(),p("div",Ms,[As,f("span",null,x(s.configBoxRegisterText.message_error.success_text),1)])):B("",!0),a.isShowError?(g(),p("div",Ss,[Ts,f("span",null,x(a.messageError)+". "+x(s.configBoxRegisterText.message_error.alert_text),1)])):B("",!0),a.isShowErrorResponse?(g(),p("div",Rs,[f("span",null,x(s.configBoxRegisterText.message_error.error_text),1)])):B("",!0)]),f("div",{class:b([{"cwbb__box-register-show-2":e.isShowFormRegister,"cwbb__box-register-show":a.visibleSettingInformation},"cwbb__box-register"]),style:C(i.checkFirstInRoom?"border: none":"")},[f("div",{class:"cwbb-container",style:C(e.isShowFormRegister?"border: none":"")},[f("div",Fs,[i.checkCustom3?(g(),p(_,{key:0},[I(x(a.title),1)],64)):(g(),p(_,{key:1},[I(x(s.configBoxRegisterText.title),1)],64))]),f("div",Is,[a.nameUser?B("",!0):(g(),p("span",{key:0,class:"star-require-name",style:C(i.checkLanguage()?"left: 60px;":"")},"*",4)),D(f("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.nameUser=e),class:"cwbb__box-register-form-input cwbb__box-register-form-name",type:"text",name:"name",placeholder:s.configBoxRegisterText.placeholder_name},null,8,Ds),[[L,a.nameUser]]),i.checkCustom3?(g(),p(_,{key:1},[Ls,D(f("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.nameCompany=e),class:"cwbb__box-register-form-input cwbb__box-register-form-name",type:"text",name:"company",placeholder:s.configBoxRegisterText.placeholder_company},null,8,Ps),[[L,a.nameCompany]])],64)):B("",!0),i.checkCustom4?B("",!0):(g(),p(_,{key:2},[Us,!a.phoneUser&&i.checkCustom3?(g(),p("span",js,"*")):B("",!0),!a.phoneUser&&(i.checkCustom2||i.checkCustom5||i.checkCustom6||i.checkCustom7)?(g(),p("span",Es,"*")):B("",!0),D(f("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.phoneUser=e),class:"cwbb__box-register-form-input cwbb__box-register-form-phone",type:"text",name:"phone",placeholder:s.configBoxRegisterText.placeholder_phone},null,8,qs),[[L,a.phoneUser]])],64)),Hs,!a.emailUser&&i.checkCustom3?(g(),p("span",Vs,"*")):B("",!0),a.emailUser||!i.checkCustom7&&!i.checkCustom9?B("",!0):(g(),p("span",zs,"*")),i.checkCustom1||i.checkCustom2?B("",!0):D((g(),p("input",{key:5,"onUpdate:modelValue":t[3]||(t[3]=e=>a.emailUser=e),class:"cwbb__box-register-form-input cwbb__box-register-form-email",type:"text",name:"email",placeholder:s.configBoxRegisterText.placeholder_email},null,8,Qs)),[[L,a.emailUser]]),!i.checkCustom1||i.checkCustom5||i.checkCustom6?B("",!0):D((g(),p("input",{key:6,"onUpdate:modelValue":t[4]||(t[4]=e=>a.notesUser=e),class:"cwbb__box-register-form-input cwbb__box-register-form-email",type:"text",placeholder:s.configBoxRegisterText.placeholder_notes},null,8,Ns)),[[L,a.notesUser]]),i.checkCustom8?(g(),p(_,{key:7},[$s,i.checkCustom8?D((g(),p("input",{key:0,"onUpdate:modelValue":t[5]||(t[5]=t=>e.codeBooking=t),class:"cwbb__box-register-form-input cwbb__box-register-form-email",type:"text",placeholder:s.configBoxRegisterText.placeholder_code_booking},null,8,Zs)),[[L,e.codeBooking]]):B("",!0)],64)):B("",!0),i.checkCustom3||i.checkCustom2?(g(),p(_,{key:8},[a.province?B("",!0):(g(),p("span",Gs,"*")),!a.province&&i.checkCustom2?(g(),p("span",Os,"*")):B("",!0),i.checkCustom3?(g(),p(_,{key:2},[i.checkFirstInRoom?(g(),p("div",Ys)):B("",!0),D(f("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>a.address=e),class:"cwbb__box-register-form-input cwbb__box-register-form-email",type:"text",placeholder:s.configBoxRegisterText.placeholder_address},null,8,Xs),[[L,a.address]])],64)):B("",!0),i.checkFirstInRoom?(g(),p("div",Js)):B("",!0),D(f("div",Ws,[D(f("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>a.textSearchProvince=e),class:"cwbb__box-register-form-input cwbb__box-register-form-email",placeholder:"Chọn thành phố",id:"inputProvince"},null,512),[[L,a.textSearchProvince],[P,a.displayPopup]]),D(f("div",{onClick:t[8]||(t[8]=(...e)=>i.showPopupProvince&&i.showPopupProvince(...e)),class:"cwbb__box-register-form-input cwbb__box-register-form-email",style:C([{"text-align":"left"},a.province?"opacity: 1":"opacity: 0.4"])},x(a.province?a.province.name:"Chọn thành phố"),5),[[P,!a.displayPopup]]),a.displayPopup?(g(),p("div",{key:0,class:"popup-list-province",style:C(i.checkCustom3?"":"bottom: -60px")},[i.listProvinceSearch.length?B("",!0):(g(),p("div",Ks," Không có dữ liệu phù hợp ")),(g(!0),p(_,null,k(i.listProvinceSearch,(e=>(g(),p("div",{key:e.id,onClick:t=>i.chooseProvince(e),class:b(["province",e.id===a.province.id?"item-choose":""])},x(e.name),11,eo)))),128))],4)):B("",!0)],512),[[r,i.closePopupProvince]])],64)):B("",!0),i.checkFirstInRoom?(g(),p("div",to)):B("",!0),i.checkFirstInRoom?D((g(),p("textarea",{key:10,rows:4,class:"cwbb__box-register-form-input","onUpdate:modelValue":t[9]||(t[9]=e=>a.firstMessage=e),placeholder:s.configBoxRegisterText.placeholder_enter,style:{resize:"none",margin:"10px 0"}},null,8,so)),[[L,a.firstMessage]]):B("",!0),i.checkFirstInRoom?(g(),p("div",oo)):B("",!0),f("div",ao,[a.isSubmit?(g(),p("div",io,ro)):(g(),p("button",{key:0,onClick:t[10]||(t[10]=e=>i.handleOkRegister()),style:{padding:"3px 10px",border:"1px solid #a0a0a0",background:"none","border-radius":"6px",cursor:"pointer"}},x(s.configBoxRegisterText.submit),1))])]),i.isShowCloseBox?(g(),p("div",{key:0,class:"cwbb__box-register-close",onClick:t[11]||(t[11]=e=>i.handleCloseBoxRegister())},no)):B("",!0)],4)],6)])}],["__scopeId","data-v-7008008f"]]);const co={components:{},props:{isShowMenu:{type:Boolean}},data:()=>({}),computed:l(n(n(n({},m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject","isScrollBottom","listMenu"])),m("room",["dataRoom","roomTotalMessage","roomMessage"])),{getListMenu(){let e=[];return null!=this.listMenu&&null!=this.listMenu.persistent_menu&&this.listMenu.persistent_menu.length>0&&null!=this.listMenu.persistent_menu[0].call_to_actions&&this.listMenu.persistent_menu[0].call_to_actions.length&&(e=this.listMenu.persistent_menu[0].call_to_actions),e}}),methods:{async handleClickPayload1(e){this.$emit("clickPayload",e)},setColorCustom(){let e=document.getElementsByClassName("custom-text-color3");if(e.length>0)for(var t=0;t<e.length;t++)e[t].style.color=this.listColorCustom.textColor3}},mounted(){},created(){this.$nextTick((()=>{this.setColorCustom()}))},updated(){this.$nextTick((()=>{this.setColorCustom()}))},watch:{}};v("data-v-fcfa0b0c");const ho={class:"cbbm__content"},uo=["href"],go=["onClick"];y();var mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAABAVJREFUeAHlmw2x1DAQgCMBCTgAB+AAHIADcAAOwAE4QAISkIAEJMB8mdubNK/XbNrdbFoy02n7mia7X/YnyeulNL68TCl9SCl9SSn9SCn9vh1/U0rlwd9/pZR+3uryzuvx4vr3+OwGBEX/VBBKINpr2qCtdyml5/7i+/RQQtEqvreewPLRxLhVwHw2spReYLgkfU9pVZFgapACynjs9zdH4ESoWtDoe2QKDepYzdcJwdQDQ7ZE1qEFP5/Ramo4co+sw2ITZmuRrkX4UWdkfuttRh9P4FIt4OjgUkihrc7P8hxdTMsVLKcePDNLwm/rxq9yf3gaQOQ/Y0DWDiC67c5uzB3OlMq1UOp66LhrnnSGSWCt7N57JpNdBd/c29lZ3+uKR/+Da9UDqXa1K813agit+08tP4tcY7G9yrYqR5QFk9U2A3aU9XxbGbnvQXFw04oiRm4NjvCKgPTQit4HjNgWnEhIuPmTwuZ3K4hZPtfAESFHWxIsFoXgbKl8q60eOCLoaEiLYD3SvfbAiYC0cLNR7nUEzmhICzcbsWK3gDMSEkxyGbHu2gNnEQNE2OI8IibxHUGeubaC6pHnLThMTl8VisslA9faGvWGlOMQS/0jALbe1cDh/UeAeBYJKW+DeAVoLZwWoEhIfJ6Tv8FBCMujtXVQr/m2LEjk2rIk4pVHokEPl5XzlvXUcACgAUS9LUj0KTCtzhmQVWNlO9k0oV+VNTi8pwVE3UeQ6LOUwerapVGEyymyAPQIDnV7AFG/huS5VHIDREzA7EmVrUTQCwhI0jaZxiP+0AeHGyDpQHPeA0jTrkUdlyDdK9isgNyy2FUAsU+ev1XuVci6/qwWlFf0nksNLchZAeWlBllGq4hXvVkB5cUq8xUvxbXtzgroPpfznEdoIM0ICCb30prIaZQ8UmdGQDlAC6HoODQjIH4scy9sFxyxgKPvzgjoyZdnkW42G6CFe4kZRbrZbIAW7iWAvHblNO73RoQozlFf1+b1VyHH4pJPPzQKWddZM2kEte5H096q9QilSCsCCG7OwSJRo4x1HWR4EpwFjpyjrMha2T3tbVqPAMKKosx7j1JW76Czuoz4d7SVYlbtvFDTuVWcYRvESvlWO5vfJT4C97+4Wpdr1bCI6NEr/dboH3muylo1lPr+yvHovt9TK917f8Uf1KlSeg+oK82PzOEIyCtYkhscgcQi8oyBG5nXdg1EL9Mz2e1Ms23Wds01limh269izjCZREbmdGGFacCM1oRMw1xKQ58sNwMoYg1bJlMW/DwKFGDoO9SdekaF33+M+EcAfbBlexowNUSsSmBZTA9oAyi40Wmh1JDKewInypFdUJQUvBa7+BsHH2dSlwme2dqpFGjr+h9qs4PxCvbmpwAAAABJRU5ErkJggg==";const po={components:{ChatBoxContent:cs,ChatBoxRegister:lo,ChatBoxMenu:c(co,[["render",function(e,t,s,o,a,i){return g(),p("div",{id:"chat-box-bizfly-menu",class:b(["chat-box-bizfly-menu",s.isShowMenu?"chat-box-bizfly-menu-show":""])},[f("div",ho,[(g(!0),p(_,null,k(i.getListMenu,((e,t)=>(g(),p("div",{class:"cbbm__content-item",key:t},["web_url"==e.type?(g(),p("a",{key:0,class:"custom-text-color3",href:e.url,target:"_blank"},x(e.title),9,uo)):(g(),p("a",{key:1,class:"custom-text-color3",href:"#",onClick:t=>i.handleClickPayload1(e)},x(e.title),9,go))])))),128))])],2)}],["__scopeId","data-v-fcfa0b0c"]]),MessageFile:st,CloseCircleOutlined:te,ArrowsAltOutlined:W,ShrinkOutlined:K,ExportOutlined:ee,CloseOutlined:se},props:{},data(){return{isDragging:!1,isMouseDown:!1,dragStartX:0,dragScrollLeft:0,clickStartTime:0,listSuggestDemo:U([]),showScrollButton:!1,showSuggestions:!1,isQuestionContainerVisible:!0,dynamicHeight:"150px",listQuestionSuggest:[],replying:!1,listSuggest:[],typing:!1,closeSuggest:!1,contentHeight:75,dataConfig:null,isRoomAble:!1,message:"",isScroll:!1,isShowMenu:!1,timerDebounce:"",isSentMessage:!1,isAdmicro:"",avatarAdmicro:"",isDemo:"",isMobileDevice:!1,isFirstMessage:!1,isUserScrolledUp:!1,languageBoxBizfly:this.$route.query.language_box_bizfly,configBoxRegister:{submit:"Gửi / Submit",title:"Vui lòng nhập thông tin / Please enter information",placeholder_company:"Tên công ty / Company name",placeholder_name:"Tên / Name",placeholder_phone:"Số điện thoại / Phone",placeholder_email:"Email",placeholder_code_booking:"Mã đặt chỗ",placeholder_address:"Địa chỉ / Address",placeholder_enter:"Vui lòng nhập nội dung / Write a message",placeholder_enter_chatgpt:"Write a message",placeholder_notes:"Nhập nội dung ghi chú... / Please type your notes here",message_error:{error_text:"Cập nhật thất bại / Update failed",success_text:"Bạn đã định danh thành công / You have successfully identified",alert_text:"Vui lòng nhập lại / Please enter again",empty:{name:"Chưa điền Tên / Please enter name",phone:"Chưa điền số điện thoại / Please enter phone",email:"Chưa điền email / Please enter email",message:"Chưa điền nội dung tin nhắn",province:"Chưa chọn thành phố / Please choose province"},invalid:{phone:"Sai định dạng số điện thoại / Invalid phone number format",email:"Sai định dạng email / Invalid email format"}}},colorCustomBizfly:this.$route.query.color_custom_bizfly,checkIdentityIcon:!1,fingerPrint:"",checkSending:!1,listFileUpload:[],loadingUploadFile:!1,typeFile:null,loadingApi:!0,questionPage:1,totalQuestions:0,isLoadingMoreQuestions:!1,locationFromApp:null,configCustom:{title_header:"",type_box:1,placeholder_input:"",image_send_button:""},statusFullScreen:!1,checkFirstChatButton:!1}},computed:l(n(n(n(n(n({},m("socket",["socket","action","actionData","statusSocket"])),m("color",["listColorCustom"])),m("chatBox",["dataBuildBox","dataChatBox","dataChatManage","dataProject","isScrollBottom","listMenu","isShowFormRegister"])),m("room",["dataRoom","roomTotalMessage","roomMessage","statusReady"])),m("message",["reply_status"])),{getHeightDefaultChatContent(){var e="70px";let t=!(this.checkAdmicro()||this.checkIsFullSize())&&this.dataBuildBox.is_header;return t?t&&(e="200px"):e="150px",this.checkPRSun()&&(e="120px"),this.checkIsFullSize()&&(e="180px"),this.checkIsFormPR()&&(e=this.listQuestionSuggest.length>0?this.replying?"167px":"132px":this.replying?"125px":"90px"),this.checkProjectA80()&&(e=this.listQuestionSuggest.length>0?this.replying?"245px":"210px":this.replying?"185px":"150px"),this.checkProjectCustom()&&(e=this.listQuestionSuggest.length>0?this.replying?"245px":"210px":this.replying?"185px":"150px"),e},checkIdentifyByDataBuildBox(){return!(!this.dataBuildBox.name||!this.dataBuildBox.username)},checkSpecialProject(){return!("1f56cf79-35aa-4ca6-95f2-9fc83b72de86"!=this.$route.query.project||"71697"!=this.$route.query.bot_id&&"69580"!=this.$route.query.bot_id||this.isRoomAble)},checkShowTyping(){return!(!this.replying||this.dataBuildBox.is_formGPT)||(!(!this.replying||!["7137837f-4ba5-4adb-bff1-62d4d4fce213","a39b5f0a-6a91-47de-946b-34e706422482"].includes(this.dataBuildBox.project))||(!(!this.replying||!this.checkIsFullSize())||!(!this.replying||!this.checkProjectCustom())))},checkDisableExpand(){return"52b92fb8-75ed-41fa-b612-18349e75cf64"===this.dataBuildBox.project},checkEnglishProject(){return"52b92fb8-75ed-41fa-b612-18349e75cf64"===this.dataBuildBox.project}}),methods:{toggleSuggestions(){this.showSuggestions=!this.showSuggestions},beforeQuestionLeave(e){e.classList.add("fade-out")},onQuestionLeave(e,t){setTimeout((()=>{t()}),300)},hideQuestionContainer(){this.isQuestionContainerVisible=!1},showQuestionContainer(){this.isQuestionContainerVisible=!0},measureQuestionContainerHeight(){this.$nextTick((()=>{const e=document.getElementById("pr-question-container");if(e){const t=e.offsetHeight;if(t>0){const e=t+44+64;this.dynamicHeight=e+"px"}}}))},forceScrollbarVisible(){this.$nextTick((()=>{const e=this.$refs.chatContent;if(e){const t=e.style.overflowY;e.style.overflowY="scroll",e.offsetHeight,setTimeout((()=>{e.style.overflowY=t||"auto",setTimeout((()=>{e.scrollHeight>e.clientHeight&&(e.style.overflowY="auto")}),50)}),10)}}))},ensureScrollbarConsistency(){this.$nextTick((()=>{const e=this.$refs.chatContent;e&&(e.scrollHeight,e.clientHeight,e.style.overflowY="auto")}))},closeSuggestionsOutside(){(this.checkProjectCustom()||this.checkIsFormPR())&&(this.showSuggestions=!1)},sendMessageFromApp(e){if(e&&e.username){if("9"+e.username.toLowerCase()!=this.dataBuildBox.username)return void console.log("Username không khớp");if(e.answer){this.message=e.answer;const t={location:e.location?JSON.stringify(e.location):JSON.stringify({latitude:"",longitude:""}),question:e.question?e.question:"",device_id:e.username?e.username:""};this.sendMessageWithMetadata(t)}else console.log("Không có nội dung answer trong data")}else console.log("Data không hợp lệ hoặc thiếu username")},sendMessageWithMetadata(e){if(!this.checkSending){if(""==this.message.trim())return!1;this.isSentMessage=!0;try{let t=this.generateLiveChatId(10),s={type:"form_text",content:this.message.trim(),is_private:!1,metadata:e,livechat_mid:t,is_first_message:this.isFirstMessage};this.isFirstMessage=!1;let o={type_msg:"web_message",content:this.message.trim(),content_type:"text",from:this.dataRoom.room.open_for,to:this.dataRoom.room.room_id,to_customer:this.dataRoom.room.open_for,extra_data:{send_type:"web_message",from:this.dataRoom.room.open_for,project:this.dataChatManage.project,group_id:this.dataChatBox.group_id,group_name:this.dataChatBox.group_name,bot_id:this.dataChatBox.bot_id,metadata:e},livechat_mid:t,group_id:this.dataChatBox.group_id,group_name:this.dataChatBox.group_name,bot_id:this.dataChatBox.bot_id,room_id:this.dataRoom.room.open_for,room_id_unique:this.dataRoom.room.open_for,created_at:new Date,unique_message:t};this.message="",this.$store.dispatch("room/pushMessageToRoom",o),this.$store.commit("room/updateRoomTotalMessage",this.roomTotalMessage+1),this.$nextTick((()=>{var e=this.$refs.chatContent;this.isUserScrolledUp||(e.scrollTop=e.scrollHeight)})),this.resetInputChat(),this.dataBuildBox.is_formGPT?(this.checkSending=!0,this.$store.commit("message/updateReplyStatus",!0),this.$store.dispatch("message/sendMessageStream",s).then((e=>{this.checkSending=!1})).catch((e=>{this.checkSending=!1}))):this.$store.dispatch("message/sendMessage",s).catch((e=>{console.error("Lỗi khi gửi tin nhắn:",e)})),this.isSentMessage=!1}catch(t){console.error("Lỗi:",t),this.isSentMessage=!1,this.checkSending=!1}}},handleSuggestionClick(e){this.message=e,this.$nextTick((()=>{this.$refs.textarea&&this.$refs.textarea.focus()}))},scrollToBottom(){const e=this.$refs.chatContent;e&&(e.scrollTop=e.scrollHeight,this.isUserScrolledUp=!1,this.$store.commit("chatBox/updateIsUserScrolledUp",!1),this.showScrollButton=!1)},handleClickCloseBoxChat(){var e={to:"",room_id:"",project:this.project,group_id:this.dataBuildBox.group_id,channel_id:"",type:"broadcast",content_type:"text",content:"",extra_data:{type:"user_close_box_chat"}};parent.postMessage({type:"close_box_chat",data:e},"*");try{this.isApp()&&Mobile.close()}catch(t){console.log("Close mobile: ",t)}},openFullSizeChat(){this.statusFullScreen=!this.statusFullScreen;let e={group_id:this.dataChatBox.group_id,status:this.statusFullScreen};parent.postMessage({type:"box_chat_open_full_size",data:e},"*")},handleExpand(){let e="https://bot.bizfly.vn/chat_web_box/?";e+=new URLSearchParams(this.$route.query).toString()+"&minimize=1",window.open(e,"","scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=500,height=500,left=-1000,top=-1000")},handleHeightBoxChat(){var e=this.$refs.chatContent;this.isUserScrolledUp||(e.scrollTop=e.scrollHeight);var t=this.$refs.textarea,s=110;this.checkAdmicro()&&this.checkIsFullSize()?t.oninput=function(){""==t.value&&(t.style.height="",t.style.height=Math.min(t.scrollHeight,s)-9+"px"),t.style.height="",t.style.height=Math.min(t.scrollHeight,s)-9+"px",Math.min(t.scrollHeight,s)>45&&Math.min(t.scrollHeight,s)<=59?e.style.height="calc(100vh - 85px)":Math.min(t.scrollHeight,s)>59&&Math.min(t.scrollHeight,s)<=80?e.style.height="calc(100vh - 103px)":Math.min(t.scrollHeight,s)>80&&Math.min(t.scrollHeight,s)<=101?e.style.height="calc(100vh - 123px)":Math.min(t.scrollHeight,s)>101&&Math.min(t.scrollHeight,s)<=110&&(e.style.height="calc(100vh - 135px)"),this.isUserScrolledUp||(e.scrollTop=e.scrollHeight)}:t.oninput=function(){""==t.value&&(t.style.height="",t.style.height=Math.min(t.scrollHeight,s)-9+"px"),t.style.height="",t.style.height=Math.min(t.scrollHeight,s)-9+"px",Math.min(t.scrollHeight,s)>45&&Math.min(t.scrollHeight,s)<=59?e.style.height="calc(100vh - 145px)":Math.min(t.scrollHeight,s)>59&&Math.min(t.scrollHeight,s)<=80?e.style.height="calc(100vh - 163px)":Math.min(t.scrollHeight,s)>80&&Math.min(t.scrollHeight,s)<=101?e.style.height="calc(100vh - 183px)":Math.min(t.scrollHeight,s)>101&&Math.min(t.scrollHeight,s)<=110&&(e.style.height="calc(100vh - 195px)"),this.isUserScrolledUp||(e.scrollTop=e.scrollHeight)}},onCloseSuggest(){this.closeSuggest=!this.closeSuggest},async getAuth(){this.$store.dispatch("room/getAuth").then((e=>{e.status&&this.getConfig()})).catch((e=>{console.log("Lỗi",e)}))},async getConfig(){let e={project:this.dataBuildBox.project,id:parseInt(this.dataBuildBox.id)},t=await ds(e);if(1==t.status){this.checkAdmicro()&&(t.data.dataChatBox.avatar=this.avatarAdmicro,t.data.dataChatManage.avatar=this.avatarAdmicro);let e=t.data.dataChatBox;if(this.dataConfig=t.data.dataChatBox,this.$store.commit("chatBox/updateDataChatBox",e),this.$store.commit("chatBox/updateDataChatManage",t.data.dataChatManage),this.$store.commit("chatBox/updateDataProject",t.data.dataProject),this.$store.commit("chatBox/updateListMenu",""!=t.data.listMenu?JSON.parse(t.data.listMenu):""),this.$route.query.qr_code&&!this.dataBuildBox.username){const t=await FingerprintJS.load(),s=await t.get();this.fingerPrint=s.visitorId;let o=this.fingerPrint+"_"+e.unique_id;this.$store.commit("chatBox/updateDataBuildBox",l(n({},this.dataBuildBox),{username:o.toLowerCase()}))}let s="storage_user_chat_identity_"+e.unique_id+"_"+this.dataBuildBox.username,o=localStorage.getItem(s);if("1f56cf79-35aa-4ca6-95f2-9fc83b72de86"!=this.$route.query.project||"71697"!=this.$route.query.bot_id&&"69580"!=this.$route.query.bot_id){if(1!=e.is_require_identification||o)if("52461be5-a8f5-4195-adc0-34c076cf2f76".includes(this.dataBuildBox.project)){let t="storage_first_chat_"+e.unique_id+"_"+this.dataBuildBox.username;localStorage.getItem(t)?this.$store.dispatch("room/getRoomInfo"):(this.checkFirstChatButton=!0,this.$nextTick((()=>{this.setColorCustom()})))}else this.$store.dispatch("room/getRoomInfo")}else this.$store.dispatch("room/checkRoomInfo").then((t=>{t.data.room?(this.isRoomAble=!0,(1!=e.is_require_identification||o||this.checkIdentifyByDataBuildBox)&&this.$store.dispatch("room/getRoomInfo")):this.loadingApi=!1})).catch((e=>{console.log(e)}))}},checkDisplayHeader(){return!!this.dataBuildBox.is_header},async handleStartFirstChat(){await this.$store.dispatch("room/getRoomInfo"),await this.$store.dispatch("room/getMessageOfRoom"),this.message="Bắt đầu",await this.sendMessageText();let e="storage_first_chat_"+this.dataChatBox.unique_id+"_"+this.dataBuildBox.username;localStorage.setItem(e,"true"),this.checkFirstChatButton=!1},async send(){if(this.listFileUpload.length){let e=this.listFileUpload[0],t={};1==this.listFileUpload.length?t={content:"",media_file:{file_name:e.file.name,hosted_url:e.url,file_ext:e.ext},type:e.form_type,livechat_mid:this.generateLiveChatId(10)}:(t={content:"",attachemts:[],type:"form_attachments",livechat_mid:this.generateLiveChatId(10)},this.listFileUpload.forEach((e=>{t.attachemts.push({file_name:e.file.name,type:e.form_type,url:e.url})}))),this.message&&(t.content=this.message),await this.$store.dispatch("message/sendMessage",t).then((e=>{this.message="",this.$store.dispatch("room/pushMessageToRoom",e),this.$store.commit("room/updateRoomTotalMessage",this.roomTotalMessage+1),this.scrollBottomBoxChat(),this.listFileUpload=[],this.$refs.uploadFile.value=null}))}else this.sendMessageText()},isApp(){const e=navigator.userAgent||navigator.vendor||window.opera,t=/iPhone|iPad|iPod/i.test(e),s=/Android/i.test(e),o=t&&!/Safari/.test(e),a=s&&(/wv/.test(e)||!/Chrome/.test(e));return!(!o&&!a)},async sendMessageText(){var e,t,s,o;if(!this.checkSending){if(""==this.message.trim())return!1;var a=this.$refs.chatContent;if(a&&(a.scrollTop=a.scrollHeight,this.isUserScrolledUp=!1,this.$store.commit("chatBox/updateIsUserScrolledUp",!1)),!this.isSentMessage){this.isSentMessage=!0,setTimeout((()=>{this.replying=!0}),500);try{let a=this.generateLiveChatId(10),r={type:"form_text",content:this.message.trim(),is_private:!1,livechat_mid:a,is_first_message:this.isFirstMessage},n=null;if(this.checkProjectA80()){let a={device_id:"",location:{latitude:"",longitude:""},question:""};if(this.isApp()){Mobile.getDeviceLocation(),console.log("app");try{const i=new Promise((e=>{const t=setInterval((()=>{this.locationFromApp&&(clearInterval(t),e(!0))}),100);setTimeout((()=>{clearInterval(t),e(!1)}),3e3)}));await i,console.log("location",JSON.stringify(this.locationFromApp)),(null==(e=this.locationFromApp)?void 0:e.location)?a.location={latitude:(null==(t=this.locationFromApp.location)?void 0:t.latitude)||"",longitude:(null==(s=this.locationFromApp.location)?void 0:s.longitude)||""}:console.log("Không nhận được vị trí từ app trong thời gian chờ"),(null==(o=this.locationFromApp)?void 0:o.username)?a.device_id=this.locationFromApp.username?this.locationFromApp.username:this.dataBuildBox.username:a.device_id=this.dataBuildBox.username}catch(i){console.log("Lỗi khi xử lý vị trí từ app:",i),a.device_id=this.dataBuildBox.username}}else{console.log("webview");try{navigator.geolocation&&(n=await new Promise(((e,t)=>{navigator.geolocation.getCurrentPosition((t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude})}),(t=>{console.log("Không thể lấy vị trí: ",t.message),e(null)}),{timeout:5e3})})))}catch(i){console.log("Lỗi lấy thông tin user ",i)}this.$route.query.username&&this.dataChatManage.unique_id&&(this.$route.query.device_id?a.device_id=this.$route.query.device_id:a.device_id=""),n&&(a.location={latitude:n.latitude?n.latitude:"",longitude:n.longitude?n.longitude:""})}a.location=JSON.stringify(a.location),r.metadata=a}this.isFirstMessage=!1;let l={type_msg:"web_message",content:this.message.trim(),content_type:"text",from:this.dataRoom.room.open_for,to:this.dataRoom.room.room_id,to_customer:this.dataRoom.room.open_for,extra_data:{send_type:"web_message",from:this.dataRoom.room.open_for,project:this.dataChatManage.project,group_id:this.dataChatBox.group_id,group_name:this.dataChatBox.group_name,bot_id:this.dataChatBox.bot_id},livechat_mid:a,group_id:this.dataChatBox.group_id,group_name:this.dataChatBox.group_name,bot_id:this.dataChatBox.bot_id,room_id:this.dataRoom.room.open_for,room_id_unique:this.dataRoom.room.open_for,created_at:new Date,unique_message:a};this.message="",this.$store.dispatch("room/pushMessageToRoom",l),this.$store.commit("room/updateRoomTotalMessage",this.roomTotalMessage+1),this.checkIsFormPR()&&this.closeSuggestionsOutside(),this.forceScrollbarVisible(),this.$nextTick((()=>{var e=this.$refs.chatContent;e&&!this.isUserScrolledUp&&(this.isMobileDevice?setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight)}),300)}),100):this.isUserScrolledUp||(e.scrollTop=e.scrollHeight))})),this.resetInputChat(),this.dataBuildBox.is_formGPT||this.checkIsFormPR()?(this.checkSending=!0,this.$store.commit("message/updateReplyStatus",!0),await this.$store.dispatch("message/sendMessageStream",r).then((e=>{this.checkSending=!1})).catch((e=>{this.checkSending=!1}))):await this.$store.dispatch("message/sendMessage",r).then((e=>{})).catch((e=>{})),this.isSentMessage=!1,this.locationFromApp=null}catch(i){this.locationFromApp=null,this.isSentMessage=!1,console.log(i),this.checkSending=!1}}}},generateLiveChatId(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=s.length;for(let a=0;a<e;a++)t+=s.charAt(Math.floor(Math.random()*o));return t+"_"+(new Date).getTime()},handleShowBoxRegister(){this.$store.commit("chatBox/updateIsShowFormRegister",!this.isShowFormRegister)},async checkSupportOnline(){try{let e=[];e.push(this.dataBuildBox.group_id);let t={project:this.dataBuildBox.project,groups:e};(await bs(t)).status&&document.getElementById("status-support")&&document.getElementById("status-support").classList.add("cwbb__header-icon-status-active")}catch(e){console.log(e)}},async handleScrollLoadMore({target:{scrollTop:e,clientHeight:t,scrollHeight:s}}){this.showScrollButton=e<s-t-100;let o=e<s-t-30;if(this.isUserScrolledUp!==o&&(this.isUserScrolledUp=o,this.$store.commit("chatBox/updateIsUserScrolledUp",o)),e<=80&&this.roomMessage.length<this.roomTotalMessage){let e=this.roomMessage[this.roomMessage.length-1].id?this.roomMessage[this.roomMessage.length-1].id:this.roomMessage[this.roomMessage.length-1]._id;if(!this.roomMessage.length)return;this.isScroll||(this.isScroll=!0,await this.$store.dispatch("room/getMessageOfRoom"),this.isScroll=!1,this.$nextTick((()=>{this.$store.commit("room/updateLastMessageId",e)})))}},async handleDrop(e){let t=e.dataTransfer.files;t&&t.length>0&&this.handleFiles(t,"drop")},async handlePaste(e){let t=e.clipboardData.files;t&&t.length>0&&this.handleFiles(t,"paste")},validateFile(e,t="media"){let s=!0,o="";for(let a=0;a<e.length;a++){if(o=e[a].name.substr(e[a].name.lastIndexOf(".")+1).toLowerCase(),"media"==t&&!["gif","png","jpg","jpeg"].includes(o)){s=!1;break}if("file"==t&&!["mp4","mov","xlsx","xls","pptx","pdf","docx","doc","txt"].includes(o)){s=!1;break}}return s},async handleInputFile(e){this.handleFiles(e,"input")},handleFiles(e,t="input"){const s=["gif","png","jpg","jpeg","mp4","mov","xlsx","xls","pptx","pdf","docx","doc","txt"];let o=null;o="input"==t?e.target.files:e;let a=[],i=null,r=null;for(let l=0;l<o.length;l++){let e=o[l];if(r=e.name.split(".").pop().toLowerCase(),!s.includes(r)){console.warn(`File "${e.name}" không được hỗ trợ - bỏ qua`);continue}let t=["gif","png","jpg","jpeg"].includes(n=r)?"form_image":["mp4","mov"].includes(n)?"form_video":["xlsx","xls","pptx","pdf","docx","doc","txt"].includes(n)?"form_file":null;t?(this.typeFile&&null!==i||(i=t,this.typeFile=i),t===this.typeFile?a.push(e):console.warn(`File "${e.name}" không cùng loại với file đầu tiên hợp lệ - bỏ qua`)):console.warn(`Không xác định được loại của file "${e.name}" - bỏ qua`)}var n;if(0===a.length)return alert("Không có file hợp lệ nào được chọn."),"input"==t?e.target.value=null:this.$refs.uploadFile.value=null;if(this.checkFormGPT())this.validateFile(o,t)&&this.$store.dispatch("message/uploadFile",{file:o[0],type:1}).then((async e=>{let t={content:"",media_file:{file_name:a[0].name,hosted_url:e.link,file_ext:r},type:i,livechat_mid:this.generateLiveChatId(10)};await this.$store.dispatch("message/sendMessage",t).then((e=>{this.message="",this.$store.dispatch("room/pushMessageToRoom",e),this.$store.commit("room/updateRoomTotalMessage",this.roomTotalMessage+1),this.scrollBottomBoxChat(),this.$refs.uploadFile.value=null}))}));else{this.loadingUploadFile=!0;for(let e=0;e<a.length;e++)this.$store.dispatch("message/uploadFile",{file:a[e],type:1}).then((async t=>{this.listFileUpload.push({file:a[e],url:t.link,file_ext:r,form_type:i}),this.loadingUploadFile=!1}))}return"input"==t?e.target.value=null:this.$refs.uploadFile.value=null},handleSetInputText(e){this.message=e,this.send(),this.showSuggestions=!1,this.checkIsFormPR()&&(this.closeSuggestionsOutside(),this.hideQuestionContainer()),this.forceScrollbarVisible(),this.$nextTick((()=>{this.$refs.textarea&&this.$refs.textarea.focus()}))},handleSuggestionClick(e){this.message=e,this.$nextTick((()=>{this.sendMessageText()}))},handleFaqClick(e){this.message=e,this.$nextTick((()=>{this.sendMessageText()}))},handleFaqWheel(e){e.preventDefault();const t=this.$refs.faqScrollWrapper;if(t){const s=e.deltaY||e.deltaX;t.scrollBy({left:s,behavior:"smooth"}),this.$nextTick((()=>{this.checkScrollPosition()}))}},checkScrollPosition(){const e=this.$refs.faqScrollWrapper;if(!e)return;e.scrollLeft+e.clientWidth>=e.scrollWidth-100&&this.listQuestionSuggest.length<this.totalQuestions&&!this.isLoadingMoreQuestions&&this.loadMoreQuestions()},startDrag(e){this.$refs.faqScrollWrapper&&(this.isDragging=!1,this.isMouseDown=!0,this.dragStartX=e.clientX,this.dragScrollLeft=this.$refs.faqScrollWrapper.scrollLeft,this.clickStartTime=(new Date).getTime())},onDrag(e){if(!this.isMouseDown||!this.$refs.faqScrollWrapper)return;if(Math.abs(this.dragStartX-e.clientX)>5){this.isDragging=!0,this.$refs.faqScrollWrapper.style.cursor="grabbing",this.$refs.faqScrollWrapper.style.userSelect="none";const t=this.dragStartX-e.clientX;this.$refs.faqScrollWrapper.scrollLeft=this.dragScrollLeft+t}},endDrag(e){if(!this.$refs.faqScrollWrapper)return;(new Date).getTime(),this.clickStartTime;!this.isDragging&&this.isMouseDown,this.isDragging=!1,this.isMouseDown=!1,this.$refs.faqScrollWrapper.style.cursor="grab",this.$refs.faqScrollWrapper.style.removeProperty("user-select")},startDragTouch(e){this.$refs.faqScrollWrapper&&e.touches[0]&&(this.isDragging=!1,this.isMouseDown=!0,this.dragStartX=e.touches[0].clientX,this.dragScrollLeft=this.$refs.faqScrollWrapper.scrollLeft,this.clickStartTime=(new Date).getTime())},onDragTouch(e){if(!this.isMouseDown||!this.$refs.faqScrollWrapper||!e.touches[0])return;if(Math.abs(this.dragStartX-e.touches[0].clientX)>5){this.isDragging=!0;const t=this.dragStartX-e.touches[0].clientX;this.$refs.faqScrollWrapper.scrollLeft=this.dragScrollLeft+t,e.preventDefault()}},endDragTouch(e){(new Date).getTime(),this.clickStartTime;!this.isDragging&&this.isMouseDown,this.isDragging=!1,this.isMouseDown=!1},deleteFileUpload(e){this.listFileUpload.splice(e,1),this.$refs.uploadFile.value=null},scrollBottomBoxChat(){this.$store.commit("chatBox/updateIsScrollBottom"),this.$nextTick((()=>{const e=this.$refs.chatContent;e&&(this.isMobileDevice?(this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),this.showScrollButton=!1}),300)}),100)):(this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),this.showScrollButton=!1))}))},handleClickShowMenu(){this.isShowMenu=!this.isShowMenu},hanleTyping(){this.checkProjectA80()||(clearTimeout(this.timerDebounce),this.timerDebounce=setTimeout((()=>{let e=this.generateLiveChatId(10),t={type:"form_typing",content:this.message.trim(),is_private:!1,media_file:{},livechat_mid:e};this.$store.dispatch("message/sendMessage",t)}),1e3))},async handleClickPayload(e){this.$store.dispatch("message/clickSendPayload",e),this.handleClickShowMenu()},setColorCustom(){let e=document.getElementsByClassName("custom-text-color1");if(e.length>0)for(var t=0;t<e.length;t++)e[t].style.color=this.listColorCustom.textColor1;let s=document.getElementsByClassName("custom-text-color2");if(s.length>0)for(t=0;t<s.length;t++)s[t].style.color=this.listColorCustom.textColor2;let o=document.getElementsByClassName("custom-text-color3");if(o.length>0)for(t=0;t<o.length;t++)o[t].style.color=this.listColorCustom.textColor3;let a=document.getElementsByClassName("custom-icon-color");if(a.length>0)for(t=0;t<a.length;t++)a[t].style.background=this.listColorCustom.iconColor;let i=document.getElementsByClassName("custom-button-color");if(i.length>0)for(t=0;t<i.length;t++)i[t].style.background=this.listColorCustom.buttonColor;let r=document.getElementsByClassName("custom-background-color1");if(r.length>0)for(t=0;t<r.length;t++)r[t].style.background=this.listColorCustom.backgroundColor1;let n=document.getElementsByClassName("custom-background-color2");if(n.length>0)for(t=0;t<n.length;t++)n[t].style.background=this.listColorCustom.backgroundColor2},handleNewLineInputChat(){this.message=`${this.message}\n`},resetInputChat(){this.$nextTick((()=>{var e=this.$refs.chatContent;this.$refs.textarea,e&&(this.isMobileDevice?setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight)}),100):this.isUserScrolledUp||(e.scrollTop=e.scrollHeight))}))},checkAdmicro(){return 1==this.isAdmicro||1==this.isDemo},checkIsFullSize(){return!!this.$route.query.full_size&&(this.configBoxRegister.placeholder_enter_chatgpt="Hãy hỏi tôi bất cứ điều gì",!0)},checkIsFormPR(){return!!this.$route.query.is_formPR},checkPRSun(){return!(!["9ac8eb9d-67b4-4270-b0c2-98ad6ca2d897"].includes(this.$route.query.project)||71882!=this.$route.query.bot_id)},checkProjectA80(){return("a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&71823==this.$route.query.bot_id||"3fb1efe1-03b8-47e3-94d4-d2d817462e3a"==this.$route.query.project)&&(this.configCustom.title_header="Trợ lý A80",this.configCustom.placeholder_input="Nhập câu hỏi",this.configCustom.type_box=2,!0)},checkProjectCustom(){return"a39b5f0a-6a91-47de-946b-34e706422482"==this.$route.query.project&&72051==this.$route.query.bot_id&&(this.configCustom.title_header=this.dataChatBox.title,this.configCustom.type_box=3,this.configCustom.placeholder_input="Nhập câu hỏi của bạn",this.configCustom.image_send_button="https://chatbizfly.mediacdn.vn/2025/8/13/livechat-v2/img/1755056962254108319image.png",!0)},generateLiveChatId(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=s.length;for(let a=0;a<e;a++)t+=s.charAt(Math.floor(Math.random()*o));return t+"_"+(new Date).getTime()},handleSendMessage(e){this.message=e.message,this.isFirstMessage=e.isFirstMessage,this.sendMessageText()},checkFirstInRoom(){let e="storage_user_chat_identity_"+dataChatBox.unique_id+"_"+this.dataBuildBox.username,t=localStorage.getItem(e);return!(1!=this.dataChatBox.is_require_identification||!t)||1===this.dataChatBox.is_require_identification&&this.dataRoom.user&&!this.dataRoom.user.hasOwnProperty("updated_from_boxchat_client")},isMobile(){let e=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return e&&(this.isMobileDevice=!0),e},checkFormGPT(){return!!this.$route.query.is_formGPT||(!!["914aae4c-7187-456f-9858-f002e2b84c9a"].includes(this.$route.query.project)||(!(!["7137837f-4ba5-4adb-bff1-62d4d4fce213"].includes(this.$route.query.project)||71840!=this.$route.query.bot_id)||(!!["3fb1efe1-03b8-47e3-94d4-d2d817462e3a"].includes(this.$route.query.project)||!!this.checkProjectCustom())))},handleClickOpenBoxChat(){(1!=this.dataConfig.is_require_identification||checkIdentity||this.checkIdentifyByDataBuildBox)&&this.$store.dispatch("room/getRoomInfo").then((e=>{this.isRoomAble=!0})).catch((e=>{console.log(e)}))},scrollToBottom(){this.scrollBottomBoxChat()},handleSuggestionScroll(){if(this.isLoadingMoreQuestions||this.listQuestionSuggest.length>=this.totalQuestions)return;const e=this.$refs.suggestionList;if(!e)return;e.scrollTop+e.clientHeight>=e.scrollHeight-30&&this.loadMoreQuestions()},loadMoreQuestions(){this.isLoadingMoreQuestions=!0,this.questionPage+=1,this.$store.dispatch("room/getQuestionSuggest",{page:this.questionPage}).then((e=>{e.questions&&e.questions.length>0&&(this.listQuestionSuggest=[...this.listQuestionSuggest,...e.questions],e.total&&(this.totalQuestions=e.total)),this.isLoadingMoreQuestions=!1})).catch((e=>{console.log(e),this.isLoadingMoreQuestions=!1}))}},mounted(){this.$store.commit("chatBox/updateDataBuildBox",{id:this.$route.query.id,bot_id:this.$route.query.bot_id,group_id:this.$route.query.group_id,project:this.$route.query.project,email:this.$route.query.email,username:"9"+this.$route.query.username.toLowerCase(),name:this.$route.query.name,source_id:this.$route.query.source_id,qr_code:this.$route.query.qr_code,is_header:!this.$route.query.is_header||0!=this.$route.query.is_header,is_formGPT:this.checkFormGPT(),is_identify:!this.$route.query.is_identify||0!=this.$route.query.is_identify,full_size:!this.$route.query.full_size||0!=this.$route.query.full_size,open:1,is_formPR:this.checkIsFormPR()}),this.isAdmicro=this.$route.query.is_admicro,this.isDemo=this.$route.query.is_demo,this.avatarAdmicro=this.$route.query.avatar_admicro,this.getAuth(),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1),(this.checkProjectA80()||this.checkProjectCustom())&&this.$store.dispatch("room/getQuestionSuggest",{page:this.questionPage}).then((e=>{e.questions&&(this.listQuestionSuggest=e.questions,e.total&&(this.totalQuestions=e.total))})).catch((e=>{console.log(e)}));let e=this;if(window.addEventListener("message",(function(t){if(null!=t.data.type&&"send_message_from_web"==t.data.type){console.log("send_message_from_web",t.data);let s=null;if(!t.data.data)return;s=JSON.parse(t.data.data),s.text&&(e.message=s.text,e.sendMessageText())}if(null!=t.data.type&&"list_question"==t.data.type){let s=null;if(!t.data.data)return;s=JSON.parse(t.data.data),s.questions&&(e.listQuestionSuggest=s.questions,e.showSuggestions=!0)}}),!1),this.$route.query.name&&this.$route.query.phone){let e={bot_id:this.$route.query.bot_id,project:this.$route.query.project,type:"web_message",name:this.$route.query.name,phone:this.$route.query.phone,cookies:"",username:"9"+this.$route.query.username.toLowerCase()};e.email=this.$route.query.email||"",e.notes=this.$route.query.notes||"",e.gender=["male","female"].includes(this.$route.query.gender)?this.$route.query.gender:"",fs(e)}setTimeout((()=>{this.checkSendSocket||this.socket&&(this.socket.send(JSON.stringify({event_name:"store_user_info",project:this.dataBuildBox.project,username:this.dataBuildBox.username,type:"user_web"})),this.checkSendSocket=!0)}),2e3),this.checkIsFormPR()&&this.listQuestionSuggest.length>0&&this.measureQuestionContainerHeight()},async created(){this.isMobile();const e=await FingerprintJS.load(),t=await e.get();this.fingerPrint=t.visitorId,window.sendMessageFromApp=e=>{this.sendMessageFromApp(e)},window.sendLocationFromApp=e=>{e&&(console.log("data",JSON.stringify(e)),this.locationFromApp=e)},this.$store.watch((e=>this.$store.getters["socket/action"]),(e=>{if("store_user_info_chat_web"!==e&&this.checkSendSocket||(this.socket.send(JSON.stringify({event_name:"store_user_info",project:this.dataBuildBox.project,username:this.dataBuildBox.username,type:"user_web"})),this.checkSendSocket=!0),"user_online"!==e&&this.checkSendSocket||this.checkSendSocket||(this.socket.send(JSON.stringify({event_name:"store_user_info",project:this.dataBuildBox.project,username:this.dataBuildBox.username,type:"user_web"})),this.checkSendSocket=!0),"newMessageWeb"===e){let e=this.actionData;if(e.room_id==this.dataRoom.room.room_id_unique&&"private"!=e.type&&e.from!==this.dataRoom.room.open_for){parent.postMessage({type:"event_tracking_received_message",data:{}},"*");let t=[].concat(this.roomMessage);if(t.length>0&&"typing"==t[0].type&&t.shift(),t.find((t=>t._unique_msg_id_channel_id===e._unique_msg_id_channel_id)))return void console.log("duplicate");console.log("not duplicate"),t.unshift(e),this.$store.commit("room/updateRoomMessage",t),this.$store.commit("room/updateRoomTotalMessage",this.roomTotalMessage+1),this.$nextTick((()=>{this.scrollBottomBoxChat()})),this.replying=!1}this.$store.commit("socket/updateAction","")}else"support_online"===e&&document.getElementById("status-support").classList.add("cwbb__header-icon-status-active")}))},updated(){this.$nextTick((()=>{}))},watch:{listQuestionSuggest:{handler:function(e){this.checkIsFormPR()&&e&&e.length>0&&this.measureQuestionContainerHeight()},deep:!0},message:function(e){""!=this.message&&""!=this.message.split(" ")[0]&&this.message.length>2?(this.typing=!0,this.onCloseSuggest(),this.listSuggest=this.listSuggestDemo.filter((e=>-1!=e.toLowerCase().indexOf(this.message.toLowerCase())))):(this.onCloseSuggest(),this.typing=!1),""==this.message&&this.hanleTyping()},listFileUpload:{handler(e){0===e.length&&(this.typeFile=null)},deep:!0},reply_status:function(e){this.replying=e},dataRoom:function(){this.checkSupportOnline(),this.$store.dispatch("socket/connect"),null!=this.dataRoom.user.updated_from_boxchat_client&&1==this.dataRoom.user.updated_from_boxchat_client&&(this.checkIdentityIcon=!0),this.isApp()&&Mobile.onBotReady()},statusReady:function(e){e&&(parent.postMessage({type:"chatbot_ready"},"*"),this.$refs.textarea.focus())},isScrollBottom:function(e){this.$nextTick((()=>{var e=this.$refs.chatContent;e&&(this.isMobileDevice?(this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),this.showScrollButton=!1}),300)}),100)):(e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout((()=>{this.isUserScrolledUp||(e.scrollTop=e.scrollHeight),this.showScrollButton=!1}),100)))}))},replying:function(e){this.$nextTick((()=>{setTimeout((()=>{this.ensureScrollbarConsistency(),this.forceScrollbarVisible()}),100)})),this.replying&&(this.checkIsFullSize()||this.checkProjectA80()?setTimeout((()=>{this.replying=!1}),1e4):setTimeout((()=>{this.replying=!1}),2e4))},checkFirstChatButton:function(e){e&&this.$nextTick((()=>{this.setColorCustom()}))},dataChatManage:function(){""!=this.colorCustomBizfly&&this.colorCustomBizfly?this.$store.commit("color/updateColorCustom",this.colorCustomBizfly):this.$store.commit("color/updateColorMain",this.dataChatManage.color),this.$route.query.qr_code&&this.$store.commit("color/updateColorMain",this.dataChatManage.color),this.setColorCustom()},dataChatBox:function(){try{if("en"!=this.languageBoxBizfly&&"en"!=this.dataChatManage.locale||(this.configBoxRegister={submit:"Submit",title:"Please enter information",placeholder_name:"Name",placeholder_phone:"Phone number (optional)",placeholder_email:"Email (optional)",placeholder_code_booking:"PNR",placeholder_enter:"Enter content...",placeholder_notes:"Enter note content...",message_error:{error_text:"Update failed",success_text:"You have successfully identified",alert_text:"Please enter again",empty:{name:"Please enter name",phone:"Please enter phone",email:"Please enter email",message:"Please enter message"},invalid:{phone:"Invalid phone number format",email:"Invalid email format"}}}),["7e9ef4d2-35c1-4d4f-b248-87c50893bccb"].includes(this.dataBuildBox.project)&&(this.configBoxRegister=n(n({},this.configBoxRegister),{submit:"Submit / Gửi",title:"Please enter information / Vui lòng nhập thông tin",placeholder_name:"Name / Tên",placeholder_phone:"Phone / Số điện thoại ",placeholder_email:"Email",placeholder_code_booking:"Booking Reference / Mã đặt chỗ",placeholder_enter:"Write a message / Nhập nội dung",placeholder_notes:"Enter note content... / Nhập nội dung ghi chú..."})),this.checkIsFullSize()&&(this.configBoxRegister.placeholder_enter_chatgpt="Hãy hỏi tôi bất cứ điều gì"),this.checkPRSun()&&(this.configBoxRegister.placeholder_enter_chatgpt="Đặt câu hỏi ngay..."),this.dataChatBox.config_text&&""!=this.dataChatBox.config_text){this.configBoxRegister.submit="Gửi";let e=JSON.parse(this.dataChatBox.config_text);null!=e.title&&null!=e.placeholder_name&&null!=e.placeholder_phone&&null!=e.placeholder_email&&null!=e.placeholder_enter&&null!=e.message_error&&(this.configBoxRegister=e)}}catch(e){console.log(e)}}}};v("data-v-a9dd8676");const fo={class:"chat-web-box-bizfly font-family-be-vietnam"},bo={key:0,class:"a80-header"},Co={class:"a80-header-content"},vo={class:"a80-header-avatar"},yo=["src"],xo={class:"a80-header-text"},_o={class:"a80-header-title"},ko={class:"a80-header-status"},Bo={key:0,width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{"margin-right":"6px"}},wo=[f("circle",{cx:"4",cy:"4",r:"4",fill:"#00BE33"},null,-1)],Mo=f("span",null,"Trực tuyến",-1),Ao=[f("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[f("path",{d:"M13.3054 11.9984L19.2773 6.03125C19.6382 5.67031 19.6382 5.08672 19.2773 4.72813C18.9164 4.36719 18.3328 4.36719 17.9742 4.72813L12 10.693L6.02573 4.72578C5.66479 4.36484 5.0812 4.36484 4.72261 4.72578C4.36167 5.08672 4.36167 5.67031 4.72261 6.02891L10.6945 11.9961L4.72261 17.9656C4.36167 18.3266 4.36167 18.9102 4.72261 19.2688C4.90308 19.4492 5.13979 19.5383 5.37417 19.5383C5.61089 19.5383 5.84526 19.4492 6.02573 19.2688L12 13.3016L17.9742 19.2711C18.1546 19.4516 18.389 19.5406 18.6257 19.5406C18.8625 19.5406 19.0968 19.4516 19.2773 19.2711C19.6382 18.9102 19.6382 18.3266 19.2773 17.968L13.3054 11.9984Z",fill:"black"})],-1)],So={key:1,class:"cwbb__header custom-background-color1"},To=f("div",{class:"cwbb__header-icon-status",id:"status-support"},null,-1),Ro=["title"],Fo={class:"cwbb__header-icons"},Io=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA9dJREFUeAHlW8uR4jAQdQhksBuCkXTgtg4AavbKiT1x3akiAG8GbAazGVA1CRACIXCCK1Uk4OV5JCwJ2UggyR+oYmwJW+73utXdbmmSJPBnMpl8J4T8YoytKaUbSumOELKnlBbyl/ftcA0hJKeU/sS9gcULMzxjLANgE1AZtOU5SPnAmGGk9TRqlmUjxtgfT6AV65CIguUsOmUZAjil9CQJWgfAV/8eZLdOBGPsPTJwncDSIjwZsf0wYJ5Suo2ocR243t5Hs4YOaF0HL9onQsi7vRofuJJS+rdDWhfAlSN8wwPQ7t9CKf3XdfCSfB/3ETlcwRhDLFaY7kF75wCx/tKeaV5X0nOWgPnUA03roJU2MtJ69Tb8wr29MlhfyXCODjzOx8zsQhN9csoTLvn2zdtaX7Uvyb1tMPjqJ7y6SjeF1kzU8e9OBW76Q9S+IPqUpumoUrd2NgSvf896UWzRYH81X0D7zVYw5LmvW4XRCgbq+YXWlSOqVso0QL1NZ2nobaXGiKLj0AHr+AghVYqMUrV+wdDb12nAvb8yRx4Bn2VZsVqtiul0+vRYpueHGH88Hn9LsABheqBr3/F4LPA5HA7eSZjNZoU8vqtsDdcvEr4K87TWzudzSYBvEmTwYuwGQE44Sj/Al6ucbjQJMJ/PC98k6OBBQJ7nT8sqyb/BFPDmAH2SEAE8iNxhCnh9+fFBQiTwRRkJJHPwZlrPkBALvMCNKeANuDzWIyTEBg95gxGAwV1IaAN8cAJsSWgLfEmAbyeIQfVvkyW0CV44QW9hUAcut00kLJfLa4aHGI+P5zh/owxZpjIM+kqEtIGND9ZJ+IJc/Y0MHjJukAdg85JR4BD9dSS0AB55QA4CopfBdRLaAA/lXhZ935I0TbHbI5oFiGeBhM/PzwJ+QPTFPgJ7WRqLEQlig7N4XrV8HtsPWAgX3CoIIdXS+SsWRcfj8Q+lMvxK06BMgBT0SeKtMtQF87aQYaHjRzQYtbzpMfi8BzHQ/tX76yz4qg9aaCAKWJMcxmUxQcTQraBR+4IEbCIwMTeQvtu5L4DLx47tA/YyXYyeXwYtn/P0eDCbpAgh2Bni9t8nA5sKv2UFW58PIUVu9Po2TPR5q6yS79uArbvG5+pRxGhSve3VAXPp75MleNO8TlAfMsVyxVcX3GebR4fOhUiEusu7zGPe3pUgxFQkFhHn871kaOsc511Bm65HQbVNIqJq3UQA+rg15DGJAHD4o8Z9v3UCh+rnRAS1CJDcOeAmQlFvQyjykT9w0OubGp7pwV3sg2WkafrGQ6jtv8+v0zRdlNvYAoP6D5KkPT5AyFQ3AAAAAElFTkSuQmCC",alt:"Cuộn xuống"},null,-1)],Do={key:0},Lo={key:0},Po={key:1},Uo=f("span",{class:"typing-indicator"},[f("span"),f("span"),f("span")],-1),jo={class:"form-input"},Eo={class:"cwbb__chat-input-text"},qo={key:0,style:{display:"flex",gap:"20px"}},Ho=["src"],Vo=["onClick"],zo={key:1,style:{display:"flex",gap:"20px"}},Qo=["title"],No=["href"],$o={class:"file-name"},Zo=A('<div data-v-a9dd8676><svg width="22" height="27" viewBox="0 0 22 27" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a9dd8676><path d="M0.2 1.5C0.2 0.78203 0.78203 0.2 1.5 0.2H15.4798C15.824 0.2 16.1542 0.336514 16.3979 0.579603L21.4181 5.58717C21.6626 5.83106 21.8 6.16222 21.8 6.50757V25.5C21.8 26.218 21.218 26.8 20.5 26.8H1.5C0.78203 26.8 0.2 26.218 0.2 25.5V1.5Z" fill="white" stroke="#D1D1D6" stroke-width="0.4" data-v-a9dd8676></path><mask id="path-2-inside-1" fill="white" data-v-a9dd8676><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" data-v-a9dd8676></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" fill="#EFEFEF" data-v-a9dd8676></path><path d="M22 6.49986V6.89986H22.402L22.4 6.49785L22 6.49986ZM15.5 0L15.5054 -0.399964L15.1 -0.40542V0H15.5ZM16.5391 0.437867L16.2566 0.721066L16.5391 0.437867ZM21.5593 5.44544L21.2768 5.72864L21.5593 5.44544ZM22 6.09986H17V6.89986H22V6.09986ZM17 6.09986C16.3925 6.09986 15.9 5.60738 15.9 4.99986H15.1C15.1 6.0492 15.9507 6.89986 17 6.89986V6.09986ZM15.9 4.99986V0H15.1V4.99986H15.9ZM15.4946 0.399964C15.7805 0.403812 16.0539 0.518869 16.2566 0.721066L16.8216 0.154668C16.4715 -0.194585 15.9992 -0.393317 15.5054 -0.399964L15.4946 0.399964ZM16.2566 0.721066L21.2768 5.72864L21.8418 5.16224L16.8216 0.154668L16.2566 0.721066ZM21.2768 5.72864C21.4824 5.9337 21.5985 6.21167 21.6 6.50188L22.4 6.49785C22.3974 5.99657 22.1969 5.51644 21.8418 5.16224L21.2768 5.72864Z" fill="#D1D1D6" mask="url(#path-2-inside-1)" data-v-a9dd8676></path><path d="M8.59961 9.1V9.9H15.8996V9.1H8.59961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 18.1V18.9H13.3996V18.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 12.1V12.9H15.8996V12.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 15.1V15.9H15.8996V15.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path></svg></div>',1),Go={class:"name"},Oo=["onClick"],Yo=["placeholder"],Xo=[A('<g clip-path="url(#clip0_4_285)" data-v-a9dd8676><path d="M18 36.5C27.9411 36.5 36 28.4411 36 18.5C36 8.55887 27.9411 0.5 18 0.5C8.05887 0.5 0 8.55887 0 18.5C0 28.4411 8.05887 36.5 18 36.5Z" fill="#D8D8D8" data-v-a9dd8676></path><path d="M24.7248 9.50768L8.41933 15.2234C8.20542 15.2978 8.01395 15.4254 7.86291 15.5942C7.71187 15.763 7.60621 15.9674 7.55587 16.1882C7.50554 16.409 7.51217 16.639 7.57514 16.8566C7.63812 17.0741 7.75538 17.2721 7.91589 17.4319L15.3606 20.577L18.5057 28.0217C18.6654 28.1822 18.8634 28.2994 19.081 28.3624C19.2985 28.4254 19.5285 28.432 19.7494 28.3817C19.9702 28.3313 20.1746 28.2257 20.3434 28.0746C20.5121 27.9236 20.6397 27.7321 20.7142 27.5182L26.4299 11.2128C26.514 10.9749 26.5291 10.7182 26.4734 10.4721C26.4177 10.2261 26.2935 10.0008 26.1151 9.82244C25.9367 9.64406 25.7115 9.51983 25.4655 9.46413C25.2194 9.40842 24.9626 9.42352 24.7248 9.50768Z" fill="white" data-v-a9dd8676></path></g><defs data-v-a9dd8676><clipPath id="clip0_4_285" data-v-a9dd8676><rect width="36" height="36" fill="white" transform="translate(0 0.5)" data-v-a9dd8676></rect></clipPath></defs>',2)],Jo=["width","height"],Wo=[A('<g clip-path="url(#clip0_4_333)" data-v-a9dd8676><path d="M18 36.5C27.9411 36.5 36 28.4411 36 18.5C36 8.55887 27.9411 0.5 18 0.5C8.05887 0.5 0 8.55887 0 18.5C0 28.4411 8.05887 36.5 18 36.5Z" fill="#511D9A" data-v-a9dd8676></path><path d="M24.7248 9.50768L8.41933 15.2234C8.20542 15.2978 8.01395 15.4254 7.86291 15.5942C7.71187 15.763 7.60621 15.9674 7.55587 16.1882C7.50554 16.409 7.51217 16.639 7.57514 16.8566C7.63812 17.0741 7.75538 17.2721 7.91589 17.4319L15.3606 20.577L18.5057 28.0217C18.6654 28.1822 18.8634 28.2994 19.081 28.3624C19.2985 28.4254 19.5285 28.432 19.7494 28.3817C19.9702 28.3313 20.1746 28.2257 20.3434 28.0746C20.5121 27.9236 20.6397 27.7321 20.7142 27.5182L26.4299 11.2128C26.514 10.9749 26.5291 10.7182 26.4734 10.4721C26.4177 10.2261 26.2935 10.0008 26.1151 9.82244C25.9367 9.64406 25.7115 9.51983 25.4655 9.46413C25.2194 9.40842 24.9626 9.42352 24.7248 9.50768Z" fill="white" data-v-a9dd8676></path></g><defs data-v-a9dd8676><clipPath id="clip0_4_333" data-v-a9dd8676><rect width="36" height="36" fill="white" transform="translate(0 0.5)" data-v-a9dd8676></rect></clipPath></defs>',2)],Ko={key:0,class:"form-gpt form-start-chat"},ea=["title"],ta=f("div",{class:"cbmb__bclbi_icon"},[f("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[f("path",{fill:"rgb(24, 144, 255)",d:"M23.7362 11.6252L6.29816 3.18753C6.1286 3.10532 5.92609 3.13278 5.78455 3.2573C5.64301 3.38181 5.58972 3.57883 5.64923 3.75772L7.58155 9.55466L4.42773 11.6573C4.29718 11.7442 4.21899 11.8905 4.21899 12.0473C4.21899 12.204 4.29718 12.3503 4.42773 12.4373L7.58155 14.5397L5.64923 20.3368C5.58972 20.5155 5.64301 20.7128 5.78455 20.8373C5.92664 20.9621 6.12897 20.9889 6.29816 20.907L23.7362 12.4693C24.0838 12.3009 24.0922 11.7975 23.7362 11.6252ZM5.53278 12.0473L7.88898 10.4766L8.41248 12.0473L7.88898 13.618L5.53278 12.0473ZM9.24451 12.516H12.7036C12.9625 12.516 13.1725 12.3062 13.1725 12.0473C13.1725 11.7884 12.9625 11.5785 12.7036 11.5785H9.24451L6.89014 4.51541L21.4871 11.5785H16.9225C16.6636 11.5785 16.4537 11.7884 16.4537 12.0473C16.4537 12.3062 16.6636 12.516 16.9225 12.516H21.4871L6.89014 19.5791L9.24451 12.516Z"})])],-1),sa={key:1},oa={key:0,class:"a80-suggestion-container"},aa={class:"cwbb__faq-scroll-container"},ia=["onClick"],ra={key:0,class:"cwbb__faq-loading-indicator"},na=[f("div",{class:"cwbb__faq-loading-dot"},null,-1),f("div",{class:"cwbb__faq-loading-dot"},null,-1),f("div",{class:"cwbb__faq-loading-dot"},null,-1)],la={class:"a80-input-container"},ca=["disabled"],ha=[f("img",{src:mo,alt:"Send"},null,-1)],da={key:2},ua={key:0,class:"custom-suggestion-container"},ga=f("span",{style:{color:"#111111","font-weight":"600","font-size":"14px"}},"Câu hỏi gợi ý",-1),ma=[f("path",{d:"M1.41 0.590088L6 5.17009L10.59 0.590088L12 2.00009L6 8.00009L0 2.00009L1.41 0.590088Z",fill:"#999999"},null,-1)],pa=["onClick"],fa={key:0,class:"a80-suggestion-loading"},ba=[f("div",{class:"loading-dots"},[f("span"),f("span"),f("span")],-1)],Ca={class:"custom-input-container"},va=["placeholder"],ya=["disabled"],xa=["src"],_a={key:1,src:mo,alt:"Send"},ka={key:3},Ba={key:0,class:"pr-suggestion"},wa=f("span",{style:{color:"#111111","font-weight":"600","font-size":"14px"}},"Hỏi nhanh",-1),Ma=[f("path",{d:"M1.41 0.590088L6 5.17009L10.59 0.590088L12 2.00009L6 8.00009L0 2.00009L1.41 0.590088Z",fill:"#999999"},null,-1)],Aa=["onClick"],Sa=f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAI0klEQVR4AcRYa2xcRxX+vlmHJuJH7VDaCBDZlNCGpI9NSyXgB10XNaCoJQ6QUCTANioRVUttp6+0CXjT0hQSFNtpICgCeQMCUaLKjloRAlLstjzE04aqTYBQbyUkIqWNt+JPVXvv4Tuz620S765jBO25M2fmPOacb2fmzr13A94Eyl3207avXX5k8uEVh3NzpX9TAAayC0Qz2dSVS480owG94QBzKw6nhScL0Ag0L1pYWocG9IYDBJIsNX0ESOhi6EADCg1s/xdTsNCuwAbNIERCmenL1F/mmgDblvSlb37bN9s0/n9afHkNpuWFcBnJGP7C6VeRQR2qCbA0VRrRRh5qe/vurjrj5q3etvyJLJKkl9AVkdHM4BIY0Nd35dM1J6QmQI1Mw0cb695hHen9mVvfNdi76R2DNQNDtGX5UPa+S4f6ti0/NBmIEYDtQgSPTYIiaEYZQsjQMLTnyl9OfuvqXw99+6rftg9mxmLugAp9rPmR9NrF3xhTndBAzb92C9G94eKBiY2X7O2ruMWmIz2YDtOpEUXvZYpDm979/e5oqLC70o+13XPp45NmiVYC3QZeCNAgmuE0lmUEYYxdCHOzYraRyE9havJ7mT/2VQEauM4MV8spTci3XJsNcPksAHit1IsEFyqQF6QMZx8VIdUOHSGwYFQoQkw1OqsbSKoRA4RbrfsFpYLITZA5yl1VgItwwYHEbECKvMxypvBinMa8JTjrKFDErKoKfLUA8Prbl/1wKSpUSqZ6CAxTg5UJXiXLGSKPa1LJqFmkejLEWHSrqhdN66hqp/C4qGjFnuKR4paeJ07f2ylv+RrJMHzw1J2dPzl1x4GyF9Dxzv0ZGHTYeiJATqBfJVT3Yn/hM4WdL3xy/asltmiGOmkYNmISIspZBUruDaUCSciuPgWK3RfwLS2bxq+74dbx9x8I7jC7cpQkWEIBs4haPprU8ggmpgSSzKoAJcXSX1hf3PH39fmHTnx8/YN/u2lxiuhxA6nYQg5CJf7Q4eTfUy13PPuh1tv/8oGBzvHVRVSoJsBDL21utalXWh5/uas6cxV/aE19E5MKrhyERQt1K2a704PNUarDphctymtcTK6WjHsUEPD+nkJr1J87tCZAdxou5orenlnj8pJaXtcSfkFctTyTWKTZRV3KjQuEcbjqQG1CsxfvfPbDT1V153TqAjzHL4oGttMQIQVihiwE+ITAENpmlPXaADxF6BI29zFiFA1I/g2ss01Z4Ytav8WhJISyRSWVy7JzLfPChQuGQU6CiD+KpZBHAwoNbGeZOpbsS2v/ZegHKwDFN82iGt+WdHCxvyC8tR0NqEfLHMz+rAAKh4nNx+svr4eZE+AtSx7NfnbJvlzCMATNlP9skoCqRFCAfYmhHnXXmIUuPd4Gty0/6C8FqElMdDdzFMaBmvYzlDUBfuqivuzGiwdyn75kzwQtjAhIr8E0ez5TKEOBkUSkuNyxF5luoqSjhAUjW99zaKL3vU8O5lboRSGayuze59eM3/Nca+vdx64/f4A3XbQre/PiXX16g5lQ6pHE+FUgKJkHFTBHQ02RRKsgkijJCw1uch7k6AUAA9NSdSBpOvrg5YcnHl7x88Edlx1pwzworG3emVnb8vVJS5IRBewmEEGRmihtLyix98uiJAAkZQnKrT6oSz9JXakJ18bqoF2pCsiHHrc9pFJDu1Ydndy1ciSH86BQYmlIo/UBE5RUxYNXBhKg7y+1MkgQWJAggNi4LwVOAqQkxeRDqmXUyINyBhkbtbLrRzRronv3vu9XSzEHef5maKNTA0lxr1DrA3WMKFgEB9kByFoR4SR0ZT3iiAjHKEtk6qhANhkqfmoUg67Aa00ln1U0ogBLtvsIOWl56JCgiICY600R4R2ZENPJ4jKASgO4DwBtEenoVUwyYwMgtlGiHm+GiD+/ucETBBUKh4sP9JdKpWXa992KoPOJ0aR+uQUqXekjfEKXSW3qQEYS0kAza2IqVIX35U9QEiURDCgK3EAqacre9Vy2U4Y5izYe8LPi/YUnT989MPzS5tXJlC1jKenUC2l8BLEagvFgpmaLAElVEIggTB0guAwnGklJ5qxAcjuB7Jbnb2y579hHevxw7lv1dPeeK54Z2Zf5TdpH1KvhXMNwsadw8OWe/GOnvtxqDMsSoNPAUUL5KC5EOIOkIsSiigB1wTCql99cYiHb+9e1y75y/KPbHzi+pvpC0LdiJE1gtwHZqVKpCw1oFsAzfX988rbCj07elv/Bvza1WmKtCloxz/SoHKrOZ0Aacjv+se6GHSfWbX/oxNoqqMrA2CQBWSM0gpZiaPhobAgwRquw/MkvjipkkVRk6Zz7XUVIKwaj50QpmTqEOYiBZVAE5dry6BXP1H0snjdABfKS94ge1rTbySi5HuoKLwq7ChvHo6IO27lyRJ8MzIY4oDy+KbWgDBizaV4AmwyaHQ9KkAR8aaHWqxphHp6dAvB/FB5Z+YvczlVH/TN0TD4aKa5CjVXt2J/53envZv4wOHjt2FmPwnkB/M4/O7XMKBIohxVIgVIfEawlpVmfCPoPsGMBUhM09tKQJWh08i1BiGhiKmyhXoj1o4cOXDs+MevDXR7nVQKYj45UBk8GSlS1essblpKUFyMQlr3hCmfeciaOOhDRWH0EBsnzKpbwUCWOzj0PD2eaFau5vFt1xOjtR0dVojvat6nc8Trx9a4M9O+gfn1Ftc582c0b4MKm6XFFKlLMtLDeeg5LUjUBum3r8TX5LcdubJ1OoHPV9LLqWigCPIKBPGQM2S+MXdPS+afVPZ///VX6MbKpzBtgf6GzGEj9awBQF0QGvLir8IlqUKlqlvuPtxb0otqPePBTwxRBRZ38prFrao6fN0CIDMkBxQWdSU7R6s6ezLNKCmHUh9ItRPFL49fpdHBhdg2zVXNr9hY+pwTohNkojLmdL2yoLtvco4HppnAANOHTvwpmDX/cfwXQQej/l3xf4ZbW3YUN212eT+0Z/2CBhjyIVzhNLTnq0n8AAAD//wIPVBYAAAAGSURBVAMAgP8B2+2506UAAAAASUVORK5CYII=",alt:"Question icon",class:"pr-question-icon"},null,-1),Ta={class:"pr-container"},Ra={class:"pr-input-container"},Fa=["disabled"],Ia=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAC/UlEQVR4AeyZXY4SQRDHq5tEiU8eYRY08ZG9AXsC8cUwsw+yJ1BPIJ7AvQH4Mo2+uJ4APIG+G9g5Ak+aaHbKKggEWOivmR7cZCtTQKbprvpt/6vpnpVwx+0e4NgTaJyB5Onn1nlTjZOmwqSRfj9vfnp17KQ342sBus9UJPJ8jABtYBOihZAP42b6pRupiG8d27UA8o94joCPd5MUIDqyBtdJQw2ODaIFAJMJ6EkJ4+4T1Td9NVS7FiDP8asxsIBIIryj2bg+Rn1oAUZZnAmACdgYgeCiPtS4SllpAThvRLADgKURcLvK+jAC5Dl8XKbm+FpRfRgBnGS0y0iyCl0fRgDOyVVG3GfLCSRUfVgBeMtoiwIgRH1YARSSEeyxEuvDCoBTQBRX/F6ak6zKqA9rgAf5Q7/VyERMIEXqwxpgmL2YC9sfNVPSe9ppbK/fD2sAjlm6jHjQXXesDyeAYDK6DWG9v3ICCC2jXQ5adyNTfTgALIevREbLUOvXVX3EjdGHTjTYOp84AyxkhNAHHwcYQgETAt/UZf315hDOACyjdBa/9/JpfEHBC0FIgqAx1pczwLrnf/LBGYA1SKcvPoG5e1MNiLtH7n0hwtYMOgM8qtU7tDr0vRygYPJ4qWbJW9gwZwBaESp/LoQAE5C1093kgcwJgJ8T0WDLZ0TUOfRFcsnwBttqGp+lP1/+2BfPCUD+hYqSF/Oclmk1i09UlnwDjTkBVCEfRLz8dfP7ZERLtSbvdZM1QGj5kDQnK51fZRfzdYaGD9YAoeRjo3MdgzVA+fKx13lhgLLl46rzwgBlycdX54UBBIqtHaBuwH1tRXW+b8zVPWMNLOQjsLXq4PZejs51MY0A/E8O3QCH2srU+aEYfN8IQKtPj79o6wjgtZ6Dp2kBXOQTUuc6Ni2AnXzC69wbQNeR2w7qnBsrcu0MLA7wIG7tS6rWue5voQXgAzxIeQYoFntxTty0P9cFC9GmBeCAfJBIZ93TdBoLPliY9ufcp0o3AlSZjE+sOw/wDwAA//+zA76TAAAABklEQVQDAMmjv3BVQeqQAAAAAElFTkSuQmCC",alt:"Send"},null,-1)],Da={class:"form-input"},La={class:"cwbb__chat-input-text"},Pa={key:0,style:{display:"flex",gap:"20px"}},Ua=["src"],ja=["onClick"],Ea={key:1,style:{display:"flex",gap:"20px"}},qa=["title"],Ha=["href"],Va={class:"file-name"},za=A('<div data-v-a9dd8676><svg width="22" height="27" viewBox="0 0 22 27" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a9dd8676><path d="M0.2 1.5C0.2 0.78203 0.78203 0.2 1.5 0.2H15.4798C15.824 0.2 16.1542 0.336514 16.3979 0.579603L21.4181 5.58717C21.6626 5.83106 21.8 6.16222 21.8 6.50757V25.5C21.8 26.218 21.218 26.8 20.5 26.8H1.5C0.78203 26.8 0.2 26.218 0.2 25.5V1.5Z" fill="white" stroke="#D1D1D6" stroke-width="0.4" data-v-a9dd8676></path><mask id="path-2-inside-1" fill="white" data-v-a9dd8676><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" data-v-a9dd8676></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M22 6.49986H17C16.1716 6.49986 15.5 5.82829 15.5 4.99986V0C15.8899 0.00524716 16.2627 0.162142 16.5391 0.437867L21.5593 5.44544C21.8397 5.72507 21.998 6.10412 22 6.49986Z" fill="#EFEFEF" data-v-a9dd8676></path><path d="M22 6.49986V6.89986H22.402L22.4 6.49785L22 6.49986ZM15.5 0L15.5054 -0.399964L15.1 -0.40542V0H15.5ZM16.5391 0.437867L16.2566 0.721066L16.5391 0.437867ZM21.5593 5.44544L21.2768 5.72864L21.5593 5.44544ZM22 6.09986H17V6.89986H22V6.09986ZM17 6.09986C16.3925 6.09986 15.9 5.60738 15.9 4.99986H15.1C15.1 6.0492 15.9507 6.89986 17 6.89986V6.09986ZM15.9 4.99986V0H15.1V4.99986H15.9ZM15.4946 0.399964C15.7805 0.403812 16.0539 0.518869 16.2566 0.721066L16.8216 0.154668C16.4715 -0.194585 15.9992 -0.393317 15.5054 -0.399964L15.4946 0.399964ZM16.2566 0.721066L21.2768 5.72864L21.8418 5.16224L16.8216 0.154668L16.2566 0.721066ZM21.2768 5.72864C21.4824 5.9337 21.5985 6.21167 21.6 6.50188L22.4 6.49785C22.3974 5.99657 22.1969 5.51644 21.8418 5.16224L21.2768 5.72864Z" fill="#D1D1D6" mask="url(#path-2-inside-1)" data-v-a9dd8676></path><path d="M8.59961 9.1V9.9H15.8996V9.1H8.59961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 18.1V18.9H13.3996V18.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 12.1V12.9H15.8996V12.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path><path d="M6.09961 15.1V15.9H15.8996V15.1H6.09961Z" fill="#007AFF" data-v-a9dd8676></path></svg></div>',1),Qa={class:"name"},Na=["onClick"],$a=["placeholder"],Za=[f("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANCAYAAACgu+4kAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1QkZDRkNBMUI4MkVFOTExQjBGRkRBRkJCQkI2MzM0NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNTBDMjk2OTM4QjcxMUU5QUUxQkU2MUY3REFGRkFGOCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNTBDMjk2ODM4QjcxMUU5QUUxQkU2MUY3REFGRkFGOCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2RDk1QTgzQUI0MzhFOTExQjE5OUU4QTQ0QzkyMjYxMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QkZDRkNBMUI4MkVFOTExQjBGRkRBRkJCQkI2MzM0NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pl3b5d4AAABUSURBVHjaYty8eXMrAwNDCRCzMZAGfgFxDyPQgJ9kaIaBL0wgU6CmkQp+A/EkkAsYKAFMDBQCkAGgQASFw38SMUhP6zAIRMb///9TZsDQT4kAAQYAA2U0y9mT1K0AAAAASUVORK5CYII=",alt:""},null,-1)],Ga={key:0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAu5JREFUWAntWO1xozAQpYQrISWkg0sHcQeXDlJC8s9j0B3XgUvQIBXgnzeTWNoSXAIlcPPAgACtWCf8uotnGGSxevvYFfuhLPv6/c8WKCw9KEvPuaFj7CoMlaWmb5yN8AwysbWYKyy9lPrPHbeenQewMk4XxjfrF5UcEMitr/eNMu4oJlpqulPGXyTAncznCQJHVf6S8sZgBAXTTy1X58bp3Ljj/DoYKl9XXAyZ+Tr8L4w/FcbXoS7oGYjEBrDeZEHlKUUghnHL3B76Kk+hzr1+f2AxsGkD4Xr/kQ3MoscfdB/SaMnc0nNcMsuymXtPrODGD5Sl4YOE+1n4kGBSkEX42AOxXqkg4uPBnncSOnAhZPeW2L0l1TtxMWdBVbnf/T7tQgMfaBchq3LRmLkZQViuJzfeb4uDsa90M4LKnncjsS7LcJaG+0PF4zp6nG+NUC6Fl01T09Iy2E/5LMscNL8XC/0+sXhe+cucHP6v6R3WtBvaUJnKEAiuY3bw34fFzEDp8w5WwRourkr0MvBf09tbAO4oLJ1w5frtfk1Dqd/uIduVVHztuIYjfp4b9zR+kb5WFf3gFrcFb1CxJPMsB3Lr/C9DjwHBrqC1nlBo5IaecBWVe22tPC3bmtTL3MojKf+zcmHVI6i6fVNU7iUJKnnY7q+2TE/3GsCCq+cxcWHZzoJ1Xp35EirLMrFeccAM3rYj6nTYJmCM6hgNl6TgFesVp5yA4BZDsV6x4BasAgyxXrFgAL7FUKxXLLgFqwBDrFcsGIBvMRTrnQmme9QtmF0xwqCerAcRFoJYViM+bcgjCnXtxccG3hIf0OcFJppq8ZlJVH16sg3Qi8ad73FaNATYwIqNQrJH5RI54UKATVm5zxCxtbklBPfRcsY3Sff27wpQYQq75uBla9BjTTNE+qQM7QBXcfd4wx1lfXt+N6tGQsuO488ThNckKXEg2A/aw522jFqebPV9RgoY3hj7lyVGdzi63tf0fL7u/6QF/gLguFKTepCjIwAAAABJRU5ErkJggg==",alt:"",style:{width:"20px",height:"20px"}},Oa={key:1,xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"25",height:"25",viewBox:"2 5 40 45",fill:"#df0c0c"},Ya=[f("path",{d:"M 25 7 C 20.196 7 17.076172 9.9375 17.076172 9.9375 C 17.076172 9.9375 11 10.533891 11 21.087891 L 11 26.058594 C 11 26.058594 10.175781 26.767266 10.175781 28.447266 C 10.175781 30.697266 11.908625 32.185172 13.140625 32.826172 C 14.546625 39.015172 21.294 43 25 43 C 28.706 43 35.453375 39.015172 36.859375 32.826172 C 38.091375 32.185172 39.824219 30.972656 39.824219 28.722656 C 39.824219 27.042656 39 26.058594 39 26.058594 L 39 21.087891 C 39 12.147891 33.53 7 25 7 z M 25 8 C 33.14 8 37.999047 12.892891 37.998047 21.087891 L 37.998047 25.998047 L 37.087891 25.998047 L 35.597656 22.869141 C 22.173656 23.126141 17.814453 15.886719 17.814453 15.886719 C 15.094886 17.457469 13.681535 22.246314 12.8125 25.998047 L 12.019531 25.998047 L 12 21.087891 C 12 11.059891 17.511719 10.892578 17.511719 10.892578 C 17.511719 10.892578 20.677 8 25 8 z M 17.634766 17.246094 C 21.384766 21.643094 27.063797 23.811187 34.966797 23.867188 L 36.457031 26.998047 L 38.404297 26.998047 C 38.612204 27.384469 38.822266 27.960095 38.822266 28.722656 C 38.822266 31.146656 35.986328 32.152344 35.986328 32.152344 C 34.723328 38.508344 28.085 42 25 42 C 21.915 42 15.185672 38.289344 14.013672 32.152344 C 14.013672 32.152344 11.175781 30.967266 11.175781 28.447266 C 11.175781 27.754607 11.350002 27.299149 11.539062 26.998047 L 13.613281 26.998047 C 14.761281 21.919047 16.153766 18.555094 17.634766 17.246094 z M 20 28 C 19.448 28 19 28.448 19 29 C 19 29.552 19.448 30 20 30 C 20.552 30 21 29.552 21 29 C 21 28.448 20.552 28 20 28 z M 30 28 C 29.448 28 29 28.448 29 29 C 29 29.552 29.448 30 30 30 C 30.552 30 31 29.552 31 29 C 31 28.448 30.552 28 30 28 z M 22.5 36 C 22.224 36 22 36.224 22 36.5 C 22 36.776 22.224 37 22.5 37 L 27.5 37 C 27.776 37 28 36.776 28 36.5 C 28 36.224 27.776 36 27.5 36 L 22.5 36 z",style:{"font-size":"8px"}},null,-1)],Xa={key:2,xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"25",height:"25",viewBox:"2 5 40 45",fill:"green"},Ja=[f("path",{d:"M 25 7 C 20.196 7 17.076172 9.9375 17.076172 9.9375 C 17.076172 9.9375 11 10.533891 11 21.087891 L 11 26.058594 C 11 26.058594 10.175781 26.767266 10.175781 28.447266 C 10.175781 30.697266 11.908625 32.185172 13.140625 32.826172 C 14.546625 39.015172 21.294 43 25 43 C 28.706 43 35.453375 39.015172 36.859375 32.826172 C 38.091375 32.185172 39.824219 30.972656 39.824219 28.722656 C 39.824219 27.042656 39 26.058594 39 26.058594 L 39 21.087891 C 39 12.147891 33.53 7 25 7 z M 25 8 C 33.14 8 37.999047 12.892891 37.998047 21.087891 L 37.998047 25.998047 L 37.087891 25.998047 L 35.597656 22.869141 C 22.173656 23.126141 17.814453 15.886719 17.814453 15.886719 C 15.094886 17.457469 13.681535 22.246314 12.8125 25.998047 L 12.019531 25.998047 L 12 21.087891 C 12 11.059891 17.511719 10.892578 17.511719 10.892578 C 17.511719 10.892578 20.677 8 25 8 z M 17.634766 17.246094 C 21.384766 21.643094 27.063797 23.811187 34.966797 23.867188 L 36.457031 26.998047 L 38.404297 26.998047 C 38.612204 27.384469 38.822266 27.960095 38.822266 28.722656 C 38.822266 31.146656 35.986328 32.152344 35.986328 32.152344 C 34.723328 38.508344 28.085 42 25 42 C 21.915 42 15.185672 38.289344 14.013672 32.152344 C 14.013672 32.152344 11.175781 30.967266 11.175781 28.447266 C 11.175781 27.754607 11.350002 27.299149 11.539062 26.998047 L 13.613281 26.998047 C 14.761281 21.919047 16.153766 18.555094 17.634766 17.246094 z M 20 28 C 19.448 28 19 28.448 19 29 C 19 29.552 19.448 30 20 30 C 20.552 30 21 29.552 21 29 C 21 28.448 20.552 28 20 28 z M 30 28 C 29.448 28 29 28.448 29 29 C 29 29.552 29.448 30 30 30 C 30.552 30 31 29.552 31 29 C 31 28.448 30.552 28 30 28 z M 22.5 36 C 22.224 36 22 36.224 22 36.5 C 22 36.776 22.224 37 22.5 37 L 27.5 37 C 27.776 37 28 36.776 28 36.5 C 28 36.224 27.776 36 27.5 36 L 22.5 36 z",style:{"font-size":"8px"}},null,-1)],Wa={key:0,class:"cwbb__chat-input-submit",style:{"margin-right":"0"}},Ka=[f("svg",{width:"30",height:"30",viewBox:"0 0 34 34",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[f("path",{d:"M24.1893 0.797559C23.4249 0.0663564 22.3128 -0.185972 21.2829 0.140325L1.90617 6.36622C1.90065 6.368 1.89513 6.36982 1.88965 6.3717C0.741482 6.76268 -0.000195461 7.769 3.86397e-08 8.93543C0.000195539 10.0978 0.737182 11.1009 1.87861 11.4944L9.92011 14.4395L13.086 22.2081C13.4991 23.2972 14.5458 23.9997 15.7574 23.9997H15.7596C16.9774 23.9989 18.0278 23.2887 18.4357 22.1905C18.4381 22.184 18.4404 22.1777 18.4426 22.1712L24.8819 3.56679C25.2162 2.58715 24.9509 1.52604 24.1893 0.797559ZM16.5911 21.5693C16.395 22.084 15.9046 22.1245 15.7583 22.1246C15.6106 22.1246 15.1162 22.0838 14.9216 21.5623C14.9185 21.5538 14.9151 21.5453 14.9117 21.5369L11.5836 13.3703C11.4833 13.1242 11.2793 12.93 11.0218 12.8358L2.56608 9.73901C2.5588 9.73634 2.55147 9.73376 2.54414 9.73123C1.99767 9.54542 1.9551 9.07489 1.9551 8.93511C1.9551 8.79593 1.99708 8.32878 2.53686 8.14114L21.5152 2.04322L13.337 9.88264C12.9551 10.2487 12.9549 10.8423 13.3366 11.2085C13.5275 11.3917 13.7778 11.4833 14.028 11.4833C14.2781 11.4833 14.5282 11.3919 14.719 11.2089L22.8866 3.37972L16.5911 21.5693Z",fill:"#FFFFFF"})],-1)],ei={key:4,style:{position:"relative"}},ti=[f("div",{class:"powder-by"},[f("span",{class:"text"},"Một sản phẩm của"),f("img",{src:"/assets/logo-bizfly-vccorp.dcf38dc7.svg",alt:""})],-1)];y();var si=c(po,[["render",function(e,t,s,o,a,i){const r=d("ArrowsAltOutlined"),n=d("ShrinkOutlined"),l=d("ExportOutlined"),c=d("CloseOutlined"),h=d("ChatBoxRegister"),m=d("ChatBoxContent"),v=d("close-circle-outlined"),y=d("ChatBoxMenu"),A=F("click-outside");return g(),p("div",fo,[(i.checkProjectA80()||i.checkProjectCustom())&&e.dataBuildBox.is_header?(g(),p("div",bo,[f("div",Co,[f("div",vo,[f("img",{src:e.dataChatManage.avatar,alt:"Trợ lý A80"},null,8,yo)]),f("div",xo,[f("div",_o,x(a.configCustom.title_header),1),f("div",ko,[i.checkProjectCustom()?(g(),p("svg",Bo,wo)):B("",!0),Mo])])]),f("div",{class:"a80-header-close",onClick:t[0]||(t[0]=e=>i.handleClickCloseBoxChat())},Ao)])):B("",!0),i.checkAdmicro()||i.checkIsFullSize()||!e.dataBuildBox.is_header||i.checkProjectA80()||i.checkProjectCustom()?B("",!0):(g(),p("div",So,[To,f("div",{class:"cwbb__header-name-bot custom-text-color1",title:e.dataChatBox.title},x(e.$filters.limitStringLimit(e.dataChatBox.title,40)),9,Ro),f("div",Fo,[e.$route.query.minimize?B("",!0):(g(),p("div",{key:0,class:"cwbb__header-icon-expand",onClick:t[1]||(t[1]=e=>i.openFullSizeChat())},[a.statusFullScreen?(g(),u(n,{key:1,style:{fontSize:"22px",color:"white"},title:"Thu nhỏ màn hình"})):(g(),u(r,{key:0,style:{fontSize:"22px",color:"white"},title:"Mở toàn màn hình"}))])),e.$route.query.minimize||i.checkDisableExpand?B("",!0):(g(),p("div",{key:1,class:"cwbb__header-icon-expand",onClick:t[2]||(t[2]=e=>i.handleExpand()),title:"Mở hội thoại trong cửa sổ mới"},[w(l,{style:{fontSize:"22px",color:"white"}})])),e.$route.query.minimize?B("",!0):(g(),p("div",{key:2,class:"cwbb__header-icon-close",onClick:t[3]||(t[3]=e=>i.handleClickCloseBoxChat())},[w(c,{style:{fontSize:"22px",color:"white"}})]))])])),e.statusSocket||i.checkFirstInRoom?B("",!0):(g(),p("div",{key:2,class:"cwbb__header-label-disconnect",style:C(i.checkAdmicro()||!e.data.dataBuildBox.is_header?"top: 10px !important;":"top: 58px !important;")},"Đang kết nối...",4)),w(h,{onSendMessage:i.handleSendMessage,configBoxRegisterText:a.configBoxRegister},null,8,["onSendMessage","configBoxRegisterText"]),f("div",{class:b(i.checkIsFullSize()?a.isMobileDevice?"cwbb__chat-content-full-size-mobile":"cwbb__chat-content-full-size":"cwbb__chat-content"),style:C({height:i.checkIsFullSize()&&a.isMobileDevice?"calc(100vh - 100px)":"calc(100vh - "+i.getHeightDefaultChatContent+")",padding:a.isMobileDevice?"10px 4px 0 16px":"",width:a.isMobileDevice?"calc(100vw - 20px)":""}),ref:"chatContent",onScroll:t[5]||(t[5]=(...e)=>i.handleScrollLoadMore&&i.handleScrollLoadMore(...e))},[w(m,{onSetInputText:i.handleSetInputText,onSuggestionClick:i.handleSuggestionClick},null,8,["onSetInputText","onSuggestionClick"]),a.showScrollButton&&i.checkIsFullSize()?(g(),p("div",{key:0,class:"cwbb__scroll-button",onClick:t[4]||(t[4]=(...e)=>i.scrollToBottom&&i.scrollToBottom(...e))},Io)):B("",!0)],38),f("div",{class:b("cwbb__chat-gpt-fixed"+(i.checkIsFullSize()?" input-text-textarea-full-size":"")),style:C([i.checkIsFullSize()?a.isMobileDevice?"width: calc(100%);":"width: calc(100% - 80px); padding: 0 40px":"",{position:"relative"}])},[a.checkFirstChatButton?(g(),p("div",{key:0,class:"cwbb__first-chat-overlay",onClick:t[7]||(t[7]=j((()=>{}),["stop"]))},[f("div",{class:"cwbb__first-chat-button custom-background-color1",onClick:t[6]||(t[6]=(...e)=>i.handleStartFirstChat&&i.handleStartFirstChat(...e))}," Bắt đầu ")])):B("",!0),i.checkShowTyping?(g(),p("div",{key:1,class:"cwbb__chat-replying",style:C(i.checkPRSun()?"padding: 5px 16px":i.checkProjectA80()||i.checkProjectCustom()?"background-color: transparent;":i.checkIsFormPR()?"padding: 0":"")},[i.checkIsFormPR()?B("",!0):(g(),p("span",Do,[I(x(e.dataChatBox.title)+" ",1),i.checkEnglishProject?(g(),p("span",Lo," is typing ")):(g(),p("span",Po," đang trả lời "))])),Uo],4)):B("",!0),i.checkIsFullSize()?(g(),p("div",{key:2,class:b(["form-full-size",a.isMobileDevice?"form-full-size-mobile":""])},[f("div",jo,[f("div",Eo,[a.listFileUpload.length?(g(),p(_,{key:0},["form_image"==a.typeFile?(g(),p("div",qo,[(g(!0),p(_,null,k(a.listFileUpload,((e,t)=>(g(),p("div",{key:e,class:"image-upload"},[f("img",{src:e.url},null,8,Ho),f("span",{class:"icon-close",title:"Xóa ảnh",onClick:e=>i.deleteFileUpload(t)},[w(v)],8,Vo)])))),128))])):(g(),p("div",zo,[(g(!0),p(_,null,k(a.listFileUpload,((e,t)=>(g(),p("div",{key:e,class:"file-upload"},[f("span",{title:e.file.name},[f("a",{href:e.url,target:"_blank"},[f("div",$o,[Zo,f("div",Go,x(e.file.name),1)])],8,No)],8,Qo),f("span",{class:"icon-close",title:"Xóa file",onClick:e=>i.deleteFileUpload(t)},[w(v)],8,Oo)])))),128))]))],64)):B("",!0),D(f("textarea",{ref:"textarea",class:"cwbb__chat-input-text_textarea","onUpdate:modelValue":t[8]||(t[8]=e=>a.message=e),placeholder:a.configBoxRegister.placeholder_enter_chatgpt,onKeypress:t[9]||(t[9]=e=>i.hanleTyping()),onDrop:t[10]||(t[10]=e=>i.handleDrop(e)),onDragover:t[11]||(t[11]=j((()=>{}),["prevent"])),onPaste:t[12]||(t[12]=e=>i.handlePaste(e)),onKeyup:t[13]||(t[13]=E(j((e=>i.send(e)),["exact"]),["enter"])),onKeydown:[t[14]||(t[14]=E(j((()=>{}),["exact","prevent"]),["enter"])),t[15]||(t[15]=E(j(((...e)=>i.handleNewLineInputChat&&i.handleNewLineInputChat(...e)),["shift","exact"]),["enter"]))]},"\n                        ",40,Yo),[[L,a.message]])]),a.checkSending||a.loadingUploadFile?(g(),p("div",{key:0,class:"cwbb__chat-input-submit",style:C(a.isMobileDevice?"margin-top: 0px;":"")},[(g(),p("svg",{width:"36",height:"37",viewBox:"0 0 36 37",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:C(a.isMobileDevice?"transform: translate(3px, 3px);":"")},Xo,4))],4)):(g(),p("div",{key:1,class:"cwbb__chat-input-submit",style:C(a.isMobileDevice?"margin-top: 0px;":""),onClick:t[16]||(t[16]=e=>i.send())},[(g(),p("svg",{width:a.isMobileDevice?"24":"36",height:a.isMobileDevice?"24":"37",style:C(a.isMobileDevice?"transform: translate(3px, 3px);":""),viewBox:"0 0 36 37",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Wo,12,Jo))],4))])],2)):(g(),p(_,{key:3},[i.checkSpecialProject&&!a.loadingApi?(g(),p("div",Ko,[f("div",{class:b("cwmb__box-content-list-bot-item custom-background-color2 cwmb__box-content-list-bot-item-"+e.dataChatBox.title),onClick:t[17]||(t[17]=e=>i.handleClickOpenBoxChat())},[f("div",{class:"cbmb__bclbi_text custom-text-color3",title:e.dataChatBox.title}," Nhấn để chat với BizflyCloud ",8,ea),ta],2)])):i.checkProjectA80()?(g(),p("div",sa,[a.listQuestionSuggest.length?(g(),p("div",oa,[f("div",aa,[f("div",{class:"cwbb__faq-scroll-wrapper",ref:"faqScrollWrapper",onWheel:t[18]||(t[18]=j(((...e)=>i.handleFaqWheel&&i.handleFaqWheel(...e)),["prevent"])),onScroll:t[19]||(t[19]=(...e)=>i.checkScrollPosition&&i.checkScrollPosition(...e)),onMousedown:t[20]||(t[20]=(...e)=>i.startDrag&&i.startDrag(...e)),onMousemove:t[21]||(t[21]=(...e)=>i.onDrag&&i.onDrag(...e)),onMouseup:t[22]||(t[22]=(...e)=>i.endDrag&&i.endDrag(...e)),onMouseleave:t[23]||(t[23]=(...e)=>i.endDrag&&i.endDrag(...e)),onTouchstart:t[24]||(t[24]=(...e)=>i.startDragTouch&&i.startDragTouch(...e)),onTouchmove:t[25]||(t[25]=(...e)=>i.onDragTouch&&i.onDragTouch(...e)),onTouchend:t[26]||(t[26]=(...e)=>i.endDragTouch&&i.endDragTouch(...e))},[(g(!0),p(_,null,k(a.listQuestionSuggest,(e=>(g(),p("div",{class:"cwbb__faq-item",key:e.id,onClick:t=>!a.isDragging&&i.handleFaqClick(e.question)},x(e.question),9,ia)))),128)),a.isLoadingMoreQuestions?(g(),p("div",ra,na)):B("",!0)],544)])])):B("",!0),f("div",la,[D(f("input",{type:"text",class:"a80-input-field",ref:"textarea","onUpdate:modelValue":t[27]||(t[27]=e=>a.message=e),placeholder:"Nhập câu hỏi",onKeyup:t[28]||(t[28]=E(j((e=>i.send(e)),["exact"]),["enter"])),onKeypress:t[29]||(t[29]=e=>i.hanleTyping())},null,544),[[L,a.message]]),f("button",{class:"a80-send-button",onClick:t[30]||(t[30]=e=>i.send()),disabled:a.checkSending||a.loadingUploadFile},ha,8,ca)])])):i.checkProjectCustom()?(g(),p("div",da,[a.listQuestionSuggest.length?D((g(),p("div",ua,[f("div",{class:"a80-suggestion-header",onClick:t[31]||(t[31]=(...e)=>i.toggleSuggestions&&i.toggleSuggestions(...e))},[ga,(g(),p("svg",{class:b({"a80-rotate":!a.showSuggestions}),width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ma,2))]),w(q,{name:"fade"},{default:M((()=>[D(f("div",{class:"a80-suggestion-list",ref:"suggestionList",onScroll:t[32]||(t[32]=(...e)=>i.handleSuggestionScroll&&i.handleSuggestionScroll(...e))},[(g(!0),p(_,null,k(a.listQuestionSuggest,(e=>(g(),p("div",{class:"a80-suggestion-item",onClick:t=>i.handleSetInputText(e.question),key:e.id},x(e.question),9,pa)))),128)),a.isLoadingMoreQuestions?(g(),p("div",fa,ba)):B("",!0)],544),[[P,a.showSuggestions]])])),_:1})],512)),[[A,i.closeSuggestionsOutside]]):B("",!0),f("div",Ca,[D(f("input",{type:"text",class:"custom-input-field",ref:"textarea","onUpdate:modelValue":t[33]||(t[33]=e=>a.message=e),placeholder:a.configCustom.placeholder_input,onKeyup:t[34]||(t[34]=E(j((e=>i.send(e)),["exact"]),["enter"])),onKeypress:t[35]||(t[35]=e=>i.hanleTyping())},null,40,va),[[L,a.message]]),f("button",{class:"custom-send-button",onClick:t[36]||(t[36]=e=>i.send()),disabled:a.checkSending||a.loadingUploadFile},[a.configCustom.image_send_button?(g(),p("img",{key:0,src:a.configCustom.image_send_button,alt:"Send"},null,8,xa)):(g(),p("img",_a))],8,ya)])])):i.checkIsFormPR()?(g(),p("div",ka,[a.listQuestionSuggest.length?D((g(),p("div",Ba,[f("div",{class:"pr-suggestion-header",onClick:t[37]||(t[37]=(...e)=>i.toggleSuggestions&&i.toggleSuggestions(...e))},[wa,(g(),p("svg",{class:b({"a80-rotate":!a.showSuggestions}),width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ma,2))]),w(q,{name:"fade"},{default:M((()=>[D(f("div",{class:"pr-suggestion-list",ref:"suggestionList",onScroll:t[38]||(t[38]=(...e)=>i.handleSuggestionScroll&&i.handleSuggestionScroll(...e))},[(g(!0),p(_,null,k(a.listQuestionSuggest,(e=>(g(),p("div",{class:"pr-suggestion-item",onClick:t=>i.handleSetInputText(e),key:e},[Sa,I(" "+x(e),1)],8,Aa)))),128))],544),[[P,a.showSuggestions]])])),_:1})],512)),[[A,i.closeSuggestionsOutside]]):B("",!0),f("div",Ta,[f("div",Ra,[D(f("input",{type:"text",class:"pr-input-field",ref:"textarea","onUpdate:modelValue":t[39]||(t[39]=e=>a.message=e),placeholder:"Đặt câu hỏi ngay",onKeyup:t[40]||(t[40]=E(j((e=>i.send(e)),["exact"]),["enter"])),onKeypress:t[41]||(t[41]=e=>i.hanleTyping())},null,544),[[L,a.message]]),f("button",{class:"pr-send-button",onClick:t[42]||(t[42]=e=>i.send()),disabled:a.checkSending||a.loadingUploadFile},Ia,8,Fa)])])])):(g(),p("div",{key:4,class:"form-gpt",style:C(i.checkPRSun()?"box-shadow: none;border-radius: 12px;border: 1px solid #E9ECFB;margin: 0 16px 18px 16px":"")},[f("div",Da,[f("div",La,[a.listFileUpload.length?(g(),p(_,{key:0},["form_image"==a.typeFile?(g(),p("div",Pa,[(g(!0),p(_,null,k(a.listFileUpload,((e,t)=>(g(),p("div",{key:e,class:"image-upload"},[f("img",{src:e.url},null,8,Ua),f("span",{class:"icon-close",title:"Xóa ảnh",onClick:e=>i.deleteFileUpload(t)},[w(v)],8,ja)])))),128))])):(g(),p("div",Ea,[(g(!0),p(_,null,k(a.listFileUpload,((e,t)=>(g(),p("div",{key:e,class:"file-upload"},[f("span",{title:e.file.name},[f("a",{href:e.url,target:"_blank"},[f("div",Va,[za,f("div",Qa,x(e.file.name),1)])],8,Ha)],8,qa),f("span",{class:"icon-close",title:"Xóa file",onClick:e=>i.deleteFileUpload(t)},[w(v)],8,Na)])))),128))]))],64)):B("",!0),D(f("textarea",{ref:"textarea",class:"cwbb__chat-input-text_textarea","onUpdate:modelValue":t[43]||(t[43]=e=>a.message=e),placeholder:a.configBoxRegister.placeholder_enter_chatgpt,onKeypress:t[44]||(t[44]=e=>i.hanleTyping()),onDrop:t[45]||(t[45]=e=>i.handleDrop(e)),onDragover:t[46]||(t[46]=j((()=>{}),["prevent"])),onPaste:t[47]||(t[47]=e=>i.handlePaste(e)),onKeyup:t[48]||(t[48]=E(j((e=>i.send(e)),["exact"]),["enter"])),onKeydown:[t[49]||(t[49]=E(j((()=>{}),["exact","prevent"]),["enter"])),t[50]||(t[50]=E(j(((...e)=>i.handleNewLineInputChat&&i.handleNewLineInputChat(...e)),["shift","exact"]),["enter"]))],style:C(i.checkPRSun()?"height: 36px;padding: 0;font-size: 14px;color: #333333":"")},"\n                            ",44,$a),[[L,a.message]])])]),i.checkIsFullSize()?B("",!0):(g(),p("div",{key:0,class:"send-action",style:C(i.checkPRSun()?"height: 25px;":"")},[f("div",{class:"list-action-input",style:C(i.checkPRSun()?"padding: 0":"")},[null!=e.listMenu&&null!=e.listMenu.persistent_menu?(g(),p("div",{key:0,class:"cwbb__chat-input-action-icon",onClick:t[51]||(t[51]=e=>i.handleClickShowMenu())},Za)):B("",!0),i.checkAdmicro()||i.checkIsFullSize()?B("",!0):(g(),p("div",{key:1,class:b(["cwbb__chat-input-action-icon",{"disabled-btn":a.checkSending||a.listFileUpload.length}]),title:"Đính kèm một ảnh hoặc file",style:C(i.checkPRSun()?"border: none; justify-content: flex-start":"")},[i.checkPRSun()?(g(),p("img",{key:0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAsVJREFUWAntmN1x2zAMgDNCRsgIGcEbNBskGyQb2G8+k8ypG3gEHan2WY+9S0xiBI+gEdxCMlUIIhXqp07uat/pSFMU8AEiQFA3N9ff1QPpHshyuBUGnqSBTBjY44V9VcCz+An36ZIWnikLWMkCSmncafAqHCgNjwurj4tDjyltvw9ChaHLLP91F5e8wJ0sf7tXxh2DcNqBMDbHSxoX9KzS7vjPIKWxLwGwSmq73uRwy+3HMWHsk2AGLQ6Z5XAXWWvlNuGV4ZKQxmYd47QDbtCk/7v88KCMqzrCjTsJfXgeK5BD7ox9GSujnR8LBKHdUeRvvdThI7o1poAyFLlSOyDGVq3CMZ1oIGibhdaa1HZDlHZSzk7bDdUt8/cVnbvN31f0/of9WCDgqw49PATnQbgnZWfJQBaSGxxrFnMv6UYDIQBX4e6BVxfClVShqneaRg+mJHpvsH8GbANiKBBCcHRtniHb100VywLW3rtibDRvm5SypsqocOx/BIdzMP95CGypjFmAVFConwKHeZPuNtxLqgDcabx3O68/pDN5bAocgvAgofBY9SQDDE2cDGfsnsqt8+Vf752kgW/0/qT+UnConHoPk/4kIPrQknA9WX+KDKprdL8n0LiKRzcPiHrNsdeKirms2d7jAjHxLgWHslKqoKhHeQ5bGo4bGgWJ3aAL+evBFYcHkkR7OWzqmgsZGnPQ4DgmTg/IF/KnwyE5Le15pdGcfdst6qQSonUxz3m3MsDOLlAXEuda7lPgEJLWanh09OC+RchQFKakJS9jVsvruJQz7MXg0DJetOIhB8diVl8UzkO8koq3KZfccVtA53CD0IHPH73dxstctK292D0e1sUlfhHAIFIGQp8+LgPnLa0jNgDpcyRrLwvnIbF91XbNv61QOGHsftbGT5XN6WPli4cdBMJW/YDH0CF+jo7rs/+VB34Dr/2xVpEMTRMAAAAASUVORK5CYII=",alt:"",onClick:t[52]||(t[52]=e=>{this.$refs.uploadFile.click()}),style:{width:"20px",height:"20px"}})):(g(),p("img",{key:1,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAARCAYAAADUryzEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1QkZDRkNBMUI4MkVFOTExQjBGRkRBRkJCQkI2MzM0NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxOEVEMDQ5OTNFNTQxMUU5OTZDM0Q2MzhFMDY0MTRENiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxOEVEMDQ5ODNFNTQxMUU5OTZDM0Q2MzhFMDY0MTRENiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGNUM2MzQ1MzdGMzlFOTExODA0OEVGOEI1NDI2QjQzMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QkZDRkNBMUI4MkVFOTExQjBGRkRBRkJCQkI2MzM0NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj1Zb3oAAAD2SURBVHjanJPhDYIwEIVLw3/dQNwAJhBHcAJhAnUDnUA2wBEwDIBOoE6gbtARvEtek0ttEbnkBUr7vfbuStS2rRoQe9KGNCUZUkPa8Xs8AK5JBaAHaYZxSsrigXBJOonvbHTkOT0C5qiQSqJHwDa4HkqPhLd43nUPzDvkHrhA/mze6AC8wKLUA9eAS5mCCxdYVPXB1iDH5MGBy18wB9+DNVpyIXX/wPYECVdTFCwEX7HBl4ESd1yJwrlwbXvvGpwBvWByg1yYT7l0DSL6G9n1ifEKqUxIbxhK2PhOYIRzh04oFLcXljXgRXO00tbBoKBZCOb4CDAAoKFQpexW19wAAAAASUVORK5CYII=",alt:"",onClick:t[53]||(t[53]=e=>{this.$refs.uploadFile.click()})}))],6)),f("input",{style:{display:"none"},type:"file",ref:"uploadFile",onChange:t[54]||(t[54]=e=>i.handleInputFile(e))},null,544),i.checkAdmicro()||!e.dataBuildBox.is_identify||i.checkIsFullSize()?B("",!0):(g(),p("div",{key:2,class:b(["cwbb__chat-input-action-icon tranform-icon",{"disabled-btn":a.checkSending}]),onClick:t[55]||(t[55]=e=>i.handleShowBoxRegister()),title:"Định danh khách hàng",style:C(i.checkPRSun()?"border: none;justify-content: flex-start":"")},[i.checkPRSun()?(g(),p("img",Ga)):a.checkIdentityIcon?(g(),p("svg",Xa,Ja)):(g(),p("svg",Oa,Ya))],6))],4),i.checkPRSun()?(g(),p("div",Wa,[i.checkPRSun()?(g(),p("img",{key:0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAVNJREFUWAnNltFNwzAQhjsCIzACG9BHIDbqBozQEegbAnzJCBmBRwQ54xEYoSNkhCJLXAmlti/2JSWSdcrFvv+z/OeSxeK/XTdP7xcnZVKAO13b7W3t7k4C4gH2o0a3atz5rCB78QGIBtvOBnIMgHIabDM5CImF4uT+CAkf5icDORRK3XsQ9dwtxYyaEgw9FzNqSICbLwbhCiXm9Qq6TdaxJAr/NKlBnwityTJqqFhJfhSINtjGRgmIkmjtRQDfx+Y7apY//CIJAAX2PgigAdvYKAIw6HT9cRkUl9vh4JMOuKtM95kUJqqiHf59NXtlcE21WVEIoPfnvNy8nLFEh5NKASqwTZYwQWQDGHRXD6/lv2+jATjOpt1xIhegAtxeP76tODVHzWEA5BuMQxIBmFaY4I4BVICtiMFIJBZ/AUgbLCZMzzzAqNZJC6ViURORgpizzhcql+2jZzBo3QAAAABJRU5ErkJggg==",alt:"",onClick:t[56]||(t[56]=e=>{i.send()}),style:{width:"20px",height:"20px"}})):B("",!0)])):(g(),p("div",{key:1,class:b(["cwbb__chat-input-submit custom-button-color",{"disabled-btn":a.checkSending||a.loadingUploadFile}]),onClick:t[57]||(t[57]=e=>i.send())},Ka,2))],4))],4))],64)),i.checkIsFullSize()&&!a.isMobileDevice?(g(),p("div",ei,ti)):B("",!0)],6),w(y,{isShowMenu:a.isShowMenu,onClickPayload:i.handleClickPayload},null,8,["isShowMenu","onClickPayload"])])}],["__scopeId","data-v-a9dd8676"]]);const oi=["#096DD9","#531DAB","#D48806","#FADB14","#D4380D","#D46B08","#333333","#C41D7F","#CF1322","#7CB305","#389E0D","#08979C","#1D39C4","#F5F5F5"],ai={"#096DD9":{textColor1:"#fff",textColor2:"#fff",textColor3:"#1890FF",iconColor:"#40A9FF",buttonColor:"#096DD9",backgroundColor1:"#096DD9",backgroundColor2:"#E6F7FF"},"#531DAB":{textColor1:"#fff",textColor2:"#fff",textColor3:"#391085",iconColor:"#B37FEB",buttonColor:"#531DAB",backgroundColor1:"#531DAB",backgroundColor2:"#F9F0FF"},"#D48806":{textColor1:"#fff",textColor2:"#fff",textColor3:"#AD6800",iconColor:"#FFD666",buttonColor:"#D48806",backgroundColor1:"#D48806",backgroundColor2:"#FFFBE6"},"#FADB14":{textColor1:"#000000",textColor2:"#fff",textColor3:"#333333",iconColor:"#D4B106",buttonColor:"#FADB14",backgroundColor1:"#FADB14",backgroundColor2:"#FEFFE6"},"#D4380D":{textColor1:"#fff",textColor2:"#fff",textColor3:"#AD2102",iconColor:"#FF9C6E",buttonColor:"#D4380D",backgroundColor1:"#D4380D",backgroundColor2:"#FFF2E8"},"#D46B08":{textColor1:"#fff",textColor2:"#fff",textColor3:"#AD4E00",iconColor:"#FFC069",buttonColor:"#D46B08",backgroundColor1:"#D46B08",backgroundColor2:"#FFF7E6"},"#333333":{textColor1:"#fff",textColor2:"#fff",textColor3:"#000000",iconColor:"#C5C5C5",buttonColor:"#333333",backgroundColor1:"#333333",backgroundColor2:"#F5F5F5"},"#C41D7F":{textColor1:"#fff",textColor2:"#fff",textColor3:"#9E1068",iconColor:"#FF85C0",buttonColor:"#C41D7F",backgroundColor1:"#C41D7F",backgroundColor2:"#FFF0F6"},"#CF1322":{textColor1:"#fff",textColor2:"#fff",textColor3:"#A8071A",iconColor:"#FF7875",buttonColor:"#CF1322",backgroundColor1:"#CF1322",backgroundColor2:"#FFF1F0"},"#7CB305":{textColor1:"#fff",textColor2:"#fff",textColor3:"#5B8C00",iconColor:"#BAE637",buttonColor:"#7CB305",backgroundColor1:"#7CB305",backgroundColor2:"#FCFFE6"},"#389E0D":{textColor1:"#fff",textColor2:"#fff",textColor3:"#237804",iconColor:"#73D13D",buttonColor:"#389E0D",backgroundColor1:"#389E0D",backgroundColor2:"#F6FFED"},"#08979C":{textColor1:"#fff",textColor2:"#fff",textColor3:"#006D75",iconColor:"#13C2C2",buttonColor:"#08979C",backgroundColor1:"#08979C",backgroundColor2:"#E6FFFB"},"#1D39C4":{textColor1:"#fff",textColor2:"#fff",textColor3:"#10239E",iconColor:"#597EF7",buttonColor:"#1D39C4",backgroundColor1:"#1D39C4",backgroundColor2:"#F0F5FF"},"#F5F5F5":{textColor1:"#000000",textColor2:"#fff",textColor3:"#000000",iconColor:"#CCCCCC",buttonColor:"#333333",backgroundColor1:"#F5F5F5",backgroundColor2:"#F5F5F5"}};const ii=H({modules:{socket:{namespaced:!0,state:{myBizflyKey:"",socket:null,selectedServerIdx:null,listServer:[],reconnectCount:0,action:"",actionData:null,heartbeatInterval:null,roomInfo:"",statusSocket:!1},getters:{myBizflyKey:e=>e.myBizflyKey,socket:e=>e.socket,action:e=>e.action,actionData:e=>e.actionData,roomInfo:e=>e.roomInfo,statusSocket:e=>e.statusSocket},mutations:{updateAction(e,t){e.action=t,e.actionData=[]}},actions:{connect:function({state:e,dispatch:t}){if(e.listServer=["wss://websocket.bizfly.vn/ws","wss://websocket.bizfly.vn/ws"],null===e.selectedServerIdx&&(e.selectedServerIdx=Math.floor(Math.random()*e.listServer.length)),e.socket&&(0==e.socket.readyState||1==e.socket.readyState)&&e.socket.url==e.listServer[e.selectedServerIdx])return!1;e.socket=new WebSocket(e.listServer[e.selectedServerIdx]),e.socket.onopen=function(t){e.action="store_user_info_chat_web",e.statusSocket=!0},e.socket.onerror=function(e){},e.socket.onclose=function(s){e.statusSocket=!1,t("reconnect")},e.socket.onmessage=function(t){try{let s=JSON.parse(t.data);e.action="",setTimeout((()=>{e.action=s.event_name,e.actionData=s.data}))}catch(s){}},e.heartbeatInterval=setInterval((()=>{t("heartbeat")}),5e3)},reconnect:async function({state:e,dispatch:t}){clearInterval(e.heartbeatInterval),await new Promise((e=>setTimeout(e,5e3))),e.reconnectCount+=1,e.selectedServerIdx<e.listServer.length-1?e.selectedServerIdx+=1:e.selectedServerIdx=0,t("connect")},heartbeat:function({state:e,dispatch:t}){e.socket&&(1===e.socket.readyState?e.socket.send("ping"):2!==e.socket.readyState&&3!==e.socket.readyState||t("reconnect"))},send:function({state:e},t={}){t.data.page_active=document.referrer,e.socket.send(JSON.stringify({event_name:t.event_name,data:t.data}))}}},color:{namespaced:!0,state:{listColor:{textColor1:"#fff",textColor2:"#fff",textColor3:"#FF3D00",iconColor:"#A0A0A0",buttonColor:"#FF3D00",backgroundColor1:"#FF3D00",backgroundColor2:"#FF3D00"}},getters:{listColorCustom:e=>e.listColor},mutations:{updateColorMain(e,t){""!=t&&function(e,t){for(var s=t.length,o=0;o<s;o++)if(t[o]==e)return!0;return!1}(t,oi)?e.listColor=ai[t]:e.listColor={textColor1:"#fff",textColor2:"#fff",textColor3:"#fff",iconColor:t,buttonColor:t,backgroundColor1:t,backgroundColor2:t}},updateColorCustom(e,t){let s={textColor1:"#fff",textColor2:"#fff",textColor3:"#1890FF",iconColor:"#40A9FF",buttonColor:"#096DD9",backgroundColor1:"#096DD9",backgroundColor2:"#E6F7FF"};try{let e=JSON.parse(t);e.textColor&&e.textColorManager&&e.textColorTitle&&e.iconColor&&e.buttonColor&&e.backgroundColorMessage&&e.backgroundColorHeader&&(s={textColor1:e.textColor,textColor2:e.textColorManager,textColor3:e.textColorTitle,iconColor:e.iconColor,buttonColor:e.buttonColor,backgroundColor1:e.backgroundColorMessage,backgroundColor2:e.backgroundColorHeader})}catch(o){}e.listColor=s}},actions:{}},chatBox:{namespaced:!0,state:{dataBuildBox:"",dataChatBox:"",dataChatManage:"",dataProject:"",isShowFormRegister:!1,isScrollBottom:!1,listMenu:"",isUserScrolledUp:!1},getters:{dataBuildBox:e=>e.dataBuildBox,dataChatBox:e=>e.dataChatBox,dataChatManage:e=>e.dataChatManage,dataProject:e=>e.dataProject,isShowFormRegister:e=>e.isShowFormRegister,isScrollBottom:e=>e.isScrollBottom,listMenu:e=>e.listMenu,isUserScrolledUp:e=>e.isUserScrolledUp},mutations:{updateDataBuildBox(e,t){e.dataBuildBox=t},updateDataChatBox(e,t){e.dataChatBox=t},updateDataChatManage(e,t){e.dataChatManage=t},updateDataProject(e,t){e.dataProject=t},updateIsShowFormRegister(e,t){e.isShowFormRegister=t},updateIsScrollBottom(e){e.isScrollBottom=e.isScrollBottom+Math.random()},updateListMenu(e,t){e.listMenu=t},updateIsUserScrolledUp(e,t){e.isUserScrolledUp=t}},actions:{}},room:{namespaced:!0,state:{dataRoom:"",roomMessage:[],size:20,roomTotalMessage:0,lastMessageId:"",auth:"",statusReady:!1},getters:{dataRoom:e=>e.dataRoom,roomMessage:e=>e.roomMessage,roomTotalMessage:e=>e.roomTotalMessage,lastMessageId:e=>e.lastMessageId,auth:e=>e.auth,statusReady:e=>e.statusReady},mutations:{updateDataRoom(e,t){e.dataRoom=t},updateLastMessageId(e,t){e.lastMessageId=t},updateRoomTotalMessage(e,t){e.roomTotalMessage=t},updateRoomMessage(e,t){e.roomMessage=t},updateStatusReady(e,t){e.statusReady=t},updateRoomMessageById(e,t){e.roomMessage.find((e=>e.id==t.id))?e.roomMessage=e.roomMessage.map((e=>e.id==t.id?l(n({},e),{content:t.content}):e)):e.roomMessage.unshift(t)},updateUserInfo(e,t){let s=e.dataRoom.user;e.dataRoom=l(n({},e.dataRoom),{user:s})}},actions:{getRoomInfo:async function({state:e,rootGetters:t},s){return new Promise((async(o,a)=>{try{let a=t["chatBox/dataBuildBox"].username,i=s&&s.name?s.name:t["chatBox/dataBuildBox"].name?t["chatBox/dataBuildBox"].name:"",r=""+t["chatBox/dataChatManage"].id,n={page_active:document.referrer,user:{username:a,name:i},ref:t["chatBox/dataChatBox"].unique_id,embed_id:r,type_room:"web_message",bot:{bot_id:t["chatBox/dataBuildBox"].bot_id,project:t["chatBox/dataBuildBox"].project},group:{group_id:t["chatBox/dataBuildBox"].group_id},project:t["chatBox/dataBuildBox"].project,auth:e.auth};if(t["chatBox/dataBuildBox"].qr_code){let e="qr_code#"+t["chatBox/dataBuildBox"].source_id;n.source=e,n.page_active=e}let l=await us(n);e.dataRoom=l.data,o(l)}catch(i){console.log("getRoomInfo:  ",i),a(i)}}))},getAuth:async function({state:e,rootGetters:t},s){return new Promise((async(s,o)=>{try{let o={username:t["chatBox/dataBuildBox"].username,project:t["chatBox/dataBuildBox"].project},a=await vs(o);e.auth=a.data.access_key,s(a)}catch(a){console.log("getAuth:  ",a),o(a)}}))},getMessageOfRoom:async function({state:e,getters:t,rootGetters:s,commit:o}){return new Promise((async(a,i)=>{try{let i={room_id:e.dataRoom.room.room_id_unique,page:1,size:e.size,project:s["chatBox/dataBuildBox"].project,auth:e.auth,username:s["chatBox/dataBuildBox"].username};t.roomMessage.length&&(i.created_at_last=t.roomMessage[t.roomMessage.length-1].created_at_unix+""),"undefined"==i.created_at_last&&(i.created_at_last="");let r=await Cs(i);r.data.data&&(e.roomMessage.length?t.roomMessage.forEach((t=>{r.data.data.find((e=>e._unique_msg_id_channel_id===t._unique_msg_id_channel_id))||e.roomMessage.push(t)})):e.roomMessage=t.roomMessage.concat(r.data.data)),e.roomTotalMessage=r.data.total_record,o("chatBox/updateIsScrollBottom",{},{root:!0}),e.statusReady=!0,a(r)}catch(r){console.log("getMessageOfRoom:  ",r),i(r)}}))},pushMessageToRoom:function({state:e},t){e.roomMessage.unshift(t)},checkRoomInfo:async function({state:e,rootGetters:t},s){return new Promise((async(e,s)=>{try{let s=t["chatBox/dataBuildBox"].username,o=t["chatBox/dataBuildBox"].name?t["chatBox/dataBuildBox"].name:"",a=""+t["chatBox/dataChatManage"].id,i={page_active:document.referrer,user:{username:s,name:o},ref:t["chatBox/dataChatBox"].unique_id,embed_id:a,type_room:"web_message",bot:{bot_id:t["chatBox/dataBuildBox"].bot_id,project:t["chatBox/dataBuildBox"].project},group:{group_id:t["chatBox/dataBuildBox"].group_id}};e(await gs(i))}catch(o){console.log("checkRoomInfo:  ",o),s(o)}}))},getQuestionSuggest:async function({state:e,rootGetters:t},s){return new Promise((async(e,o)=>{try{let o={project:t["chatBox/dataBuildBox"].project,bot_id:t["chatBox/dataBuildBox"].bot_id,page:s.page||1,size:10};e(await _s(o))}catch(a){console.log("checkRoomInfo:  ",a),o(a)}}))}}},message:{namespaced:!0,state:{reply_status:!1,count_resend:0},getters:{reply_status:e=>e.reply_status,count_resend:e=>e.count_resend},mutations:{updateReplyStatus(e,t){e.reply_status=t}},actions:{sendMessage:async function({rootGetters:e,dispatch:t,state:s},o){return new Promise((async(a,i)=>{try{o.page_active=document.referrer;let i={room_id:e["room/dataRoom"].room.room_id_unique,project:e["chatBox/dataBuildBox"].project,payload:o.payload?o.payload:"",message:o,is_private:!1,from:e["chatBox/dataBuildBox"].username,username:e["chatBox/dataBuildBox"].username,livechat_mid:o.livechat_mid,is_first_message:o.is_first_message,auth:e["room/auth"]};if(o.metadata&&(i.metadata=o.metadata,delete i.message.metadata),e["chatBox/dataBuildBox"].qr_code){let t="qr_code#"+e["chatBox/dataBuildBox"].source_id;i.page_active=t}parent.postMessage({type:"event_tracking_sent_message",data:{}},"*");let r=await ms(i);r.status?(a(r.data),s.count_resend=0):r.error&&10006==r.error.error_code&&"form_text"===o.type&&s.count_resend<2&&(s.count_resend+=1,t("room/getAuth",{},{root:!0}).then((e=>{e.status&&t("sendMessage",o).then((e=>{a(e)}))})))}catch(r){console.log("sendMessage:  ",r),i(r)}}))},sendMessageStream:async function({state:e,getters:t,rootGetters:s,commit:o,dispatch:a},i){return new Promise((async(t,o)=>{try{i.page_active=document.referrer;let r={room_id:s["room/dataRoom"].room.room_id_unique,project:s["chatBox/dataBuildBox"].project,payload:i.payload?i.payload:"",message:i,is_private:!1,from:s["chatBox/dataBuildBox"].username,username:s["chatBox/dataBuildBox"].username,livechat_mid:i.livechat_mid,is_first_message:i.is_first_message,auth:s["room/auth"]};if(i.metadata&&(r.metadata=i.metadata,delete r.message.metadata),s["chatBox/dataBuildBox"].qr_code){let e="qr_code#"+s["chatBox/dataBuildBox"].source_id;r.page_active=e}parent.postMessage({type:"event_tracking_sent_message",data:{}},"*");const n=new Date;let l={},c=[],h=0,d=0,u=!1,g=!1;ps(r,(async r=>{if("done"==r.event&&h==d&&t(r),"send_message_success"==r.event)l={content:"",created_at:n.toJSON(),content_type:"text",extra_data:{from_bizfly:"bot",is_bot:!1},message_status:1,room_id:s["room/dataRoom"].room.room_id_unique,room_id_unique:s["room/dataRoom"].room.room_id_unique,livechat_mid:i.livechat_mid};else if("reply_message"==r.event){if(!h&&!r.data.data.content)return;if(!h&&r.data.data.content){e.reply_status=!1,h=1,d=1,l.content+=r.data.data.content,l.id=r.data.data._unique_msg_id_channel_id,l._unique_msg_id_channel_id=r.data.data._unique_msg_id_channel_id;let t=Z.exports.cloneDeep(s["room/roomMessage"]);t.unshift(l),ii.commit("room/updateRoomMessage",t),ii.commit("chatBox/updateIsScrollBottom")}else if(r.data.data.content){u=!0,h+=1,c.push(r.data.data.content),async function(e=60){if(e=s["chatBox/dataBuildBox"].is_formPR?30:60,!g){for(g=!0;c.length>0;){const o=c.shift();d+=1,l.content+=o,ii.commit("room/updateRoomMessageById",l),d<100?s["chatBox/isUserScrolledUp"]||ii.commit("chatBox/updateIsScrollBottom"):e=30,u||h!=d||t(r),await new Promise((t=>setTimeout(t,e)))}g=!1}}()}}else if("end_reply_message"==r.event)e.count_resend=0,u=!1;else if("error"==r.event){if(r.data&&r.data.error&&10006==r.data.error_code&&"form_text"===i.type&&e.count_resend<2){e.count_resend+=1;try{(await a("room/getAuth",{},{root:!0})).status&&a("sendMessageStream",i)}catch(m){console.log("getAuth error:",m)}}if(r.data&&r.data.error&&502==r.data.error_code){let e=Z.exports.cloneDeep(s["room/roomMessage"]);const t=e.findIndex((e=>e.livechat_mid===i.livechat_mid));-1!==t&&(e[t].error=!0,ii.commit("room/updateRoomMessage",e))}o(r)}}))}catch(r){console.log("sendMessageStream:  ",r),o(r)}}))},clickSendPayload({state:e,getters:t,rootGetters:s,commit:o,dispatch:a},i){try{let e=function(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=s.length;for(let a=0;a<e;a++)t+=s.charAt(Math.floor(Math.random()*o));return t+"_"+(new Date).getTime()}(10),t={type:"form_text",content:i.title,is_private:!1,media_file:{},payload:i.payload,livechat_mid:e};a("room/pushMessageToRoom",{type_msg:"web_message",content:i.title,content_type:"text",from:s["room/dataRoom"].room.open_for,to:s["room/dataRoom"].room.room_id,to_customer:s["room/dataRoom"].room.open_for,extra_data:{send_type:"web_message",from:s["room/dataRoom"].room.open_for,project:s["chatBox/dataChatManage"].project,group_id:s["chatBox/dataBuildBox"].group_id,group_name:s["chatBox/dataBuildBox"].group_name,bot_id:s["chatBox/dataBuildBox"].bot_id},livechat_mid:e,group_id:s["chatBox/dataBuildBox"].group_id,group_name:s["chatBox/dataBuildBox"].group_name,bot_id:s["chatBox/dataBuildBox"].bot_id,room_id:s["room/dataRoom"].room.open_for,room_id_unique:s["room/dataRoom"].room.open_for,created_at:new Date,unique_message:e,payload:i.payload},{root:!0}),o("room/updateRoomTotalMessage",s["room/roomTotalMessage"]+1,{root:!0}),o("chatBox/updateIsScrollBottom",{},{root:!0}),a("sendMessage",t).then((e=>{}))}catch(r){console.log(r)}},uploadFile:async function({state:e},t){return new Promise((async(e,s)=>{if(t.file)try{let s=new FormData;s.append("type",t.type?t.type:1),s.append("prefix","/chatbox-v3/img"),s.append("file",t.file),e(await ys(s))}catch(o){console.log("uploadFile:  ",o),s(o)}else s({message:"Thiếu file"})}))}}}}}),ri=V(ae);ri.use(oe);const ni=z({history:Q(),routes:[{path:"/chat_web_box",name:"ChatBox",component:si,meta:{}},{path:"/:pathMatch(.*)*",redirect:"/chat_web_box"}]});ri.use(ni),ri.use(ii),ni.isReady().then((()=>{ri.mount("#chatWebBox")})),ri.config.globalProperties.$filters=h;
